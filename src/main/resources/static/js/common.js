var Micsun={};Micsun.ua=navigator.userAgent.toLowerCase();if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a,c){c||(c=0);var d=this.length;for(0>c&&(c=d+c);c<d;c++)if(this[c]===a)return c;return-1};if(!Array.prototype.lastIndexOf)Array.prototype.lastIndexOf=function(a,c){var c=isNaN(c)?this.length:(0>c?this.length+c:c)+1,d=this.slice(0,c).reverse().indexOf(a);return 0>d?d:c-d-1};
Micsun={currentApplication:"default",loaded:!1,version:"1.1.0.0",av:navigator.appVersion,win:window,doc:document,isIE:-1<Micsun.ua.indexOf("msie"),isIE6:-1<Micsun.ua.indexOf("msie 6"),isIE7:-1<Micsun.ua.indexOf("msie 7"),isIE8:-1<Micsun.ua.indexOf("msie 8"),isIE9:-1<Micsun.ua.indexOf("msie 9"),isIE10:-1<Micsun.ua.indexOf("msie 10"),isFF:-1<Micsun.ua.indexOf("firefox"),isFF1:-1<Micsun.ua.indexOf("firefox/1"),isFF2:-1<Micsun.ua.indexOf("firefox/2"),isFF3:-1<Micsun.ua.indexOf("firefox/3"),isNetscape:-1<
Micsun.ua.indexOf("netscape"),isOpera:-1<Micsun.ua.indexOf("opera"),isWebkit:/webkit|khtml/.test(Micsun.ua),isSafari:-1<Micsun.ua.indexOf("safari")||/webkit|khtml/.test(Micsun.ua),isChrome:-1<Micsun.ua.indexOf("chrome")||/webkit|khtml/.test(Micsun.ua),isKonqueror:-1!=Micsun.ua.indexOf("konqueror"),isGecko:-1<Micsun.ua.indexOf("Gecko")&&-1==Micsun.ua.indexOf("KHTML"),isSecure:0===window.location.href.toLowerCase().indexOf("https"),isWindows:-1!=Micsun.ua.indexOf("windows")||-1!=Micsun.ua.indexOf("win32"),
isMac:-1!=Micsun.ua.indexOf("macintosh")||-1!=Micsun.ua.indexOf("mac os x"),isLinux:-1!=Micsun.ua.indexOf("linux"),isIPAD:-1!=Micsun.ua.indexOf("iPad"),isIPhone:-1!=Micsun.ua.indexOf("iPone"),isIPod:-1!=Micsun.ua.indexOf("iPod"),isAndroid:-1!=Micsun.ua.indexOf("Android")||-1<Micsun.ua.indexOf("Adr"),isOperaMini:-1!=Micsun.ua.indexOf("Opera Mini"),isMobile:-1!=Micsun.ua.indexOf("IEMobile"),isBlackBerry:-1!=Micsun.ua.indexOf("BlackBerry"),isWeixin:-1!=Micsun.ua.indexOf("micromessenger")};
Micsun.isStrict="CSS1Compat"==Micsun.doc.compatMode||Micsun.isSafari;Micsun.isBoxModel=Micsun.isIE&&!Micsun.isIE8&&!Micsun.isIE9&&!Micsun.isIE10&&!Micsun.isStrict;Micsun.isNotStrictIE=Micsun.isBoxModel;Micsun.extend=function(a,c){for(var d in c)a[d]=c[d];return a};
Micsun.extend(Micsun,{empty:function(){},$:function(a){return"string"==typeof a?document.getElementById(a):a},$$:function(a,c){return(a||document).getElementsByTagName(c)},keys:function(a){var c=[],d;for(d in a)c.push(d);return c},values:function(a){var c=[],d;for(d in a)c.push(a[d]);return c},clone:function(a){return Micsun.extend({},a)},hasType:function(a){var c=arguments.length;if(1<c){for(var d=1;d<c;d++)if(Micsun.hasType(a)==arguments[d])return!0;return!1}return Micsun.type(a)},type:function(a){var c=
typeof a;if(null===a)return"object";if("undefined"==c)return"undefined";if("object"==c)if(a.nodeType&&a.nodeName)switch(a.nodeType){case 1:return"element";case 3:return/\S/.test(a.nodeValue)?"textnode":"whitespace"}else{if("splice"in a&&"join"in a)return"array";if("number"==typeof a.length)return a.callee?"arguments":"collection"}else if("function"==c&&"number"==typeof a.length&&void 0!==a[0])return"collection";return a.constructor===(new Date).constructor?"date":a.constructor===RegExp().constructor?
"regex":("object"===typeof HTMLElement?a instanceof HTMLElement:a&&"object"===typeof a&&1===a.nodeType&&"string"===typeof a.nodeName)||a.htmlElement?"element":"undefined"!==typeof jQuery&&a instanceof jQuery?"jquery":c},isUndefined:function(a){return"undefined"==typeof a},isEmpty:function(a){return Micsun.isUndefined(a)?!0:null==a||""===a},isNotEmpty:function(a){return!Micsun.isEmpty(a)},toInt:function(a,c){return Micsun.isEmpty(a)?Micsun.isEmpty(c)?0:parseInt(c):parseInt(Object)},toFloat:function(a,
c){return Micsun.isEmpty(a)?Micsun.isEmpty(c)?0:parseFloat(c):parseFloat(Object)},each:function(a,c,d,e){var f=[];if(Micsun.hasType(a,"array","arguments","collection")||a&&!Micsun.hasType(a,"string")&&Micsun.hasType(a.length,"number"))for(var h=0,j=a.length;h<j;h++)f.push(c.call(d||a,a[h],h,a,e));else for(h in a)f.push(c.call(d||a,a[h],h,a,e));return f},array:function(a,c,d){var e=[];if(a)if(c=Micsun.toInt(c,0),d=Micsun.toInt(d,a.length),Micsun.hasType(a,"arguments","collection")||Micsun.hasType(a,
"array")&&(0<c||d<a.length))for(;c<d;c++)e.push(a[c]);else if(Micsun.hasType(a,"array"))e=e.concat(a);else for(var f in a)a.hasOwnProperty(f)&&e.push(a[f]);return e},toJSON:function(a,c){return Micsun.JSON.encode(a,c)},toQueryString:function(a){if(!a||Micsun.hasType(a,"number","string"))return a;var c=[],d;for(d in a){var e=a[d];void 0!==e&&(e=[].concat(e));for(var f=0;f<e.length;f++){var h=e[f];Micsun.hasType(h,"object")&&(h=Micsun.toJSON(h));c.push(encodeURIComponent(d)+"="+encodeURIComponent(h))}}return c.join("&")},
merge:function(){for(var a={},c=0;c<arguments.length;c++)for(var d in arguments[c]){var e=arguments[c][d],f=a[d];a[d]=f&&Micsun.hasType(e,"object")&&Micsun.hasType(f,"object")?Micsun.merge(f,e):e}return a},bind:function(a,c,d){d=[].concat(d);return function(){return a.apply(c||a,Micsun.array(Micsun.merge(arguments,d)))}},bindAsEventListener:function(a,c,d){return function(e){e=e||window.event;return a.apply(c||a,[Micsun.event(e)].concat(d))}},explode:function(a,c,d){var e={"0":""};if(2>arguments.length||
"undefined"==typeof arguments[0]||"undefined"==typeof arguments[1])return null;if(""===a||!1===a||null===a)return!1;if("function"==typeof a||"object"==typeof a||"function"==typeof c||"object"==typeof c)return e;!0===a&&(a="1");if(d){var f=c.toString().split(a.toString()),e=f.splice(0,d-1),f=f.join(a.toString());e.push(f);return e}return c.toString().split(a.toString())},interp:function(a,c,d){isNaN(a)&&(a=0);isNaN(c)&&(c=0);return Math.floor(a+d*(c-a))},StrHexToBytes:function(a){var c=0,d=a.length;
if(0!=d%2)return null;for(var d=d/2,e=[],f=0;f<d;f++){var h=a.substr(c,2),h=parseInt(h,16);e.push(h);c+=2}return e},Bytes2HexStr:function(a){for(var c="",d=0;d<a.length;d++){var e=parseInt(a[d]),e=e.toString(16);1==e.length&&(e="0"+e);c+=e}return c},getParamNames:function(a){if("function"!==typeof a)return[];a=a.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,"");a=a.slice(a.indexOf("(")+1,a.indexOf(")")).match(/([^\s,]+)/g);return null===a?[]:a}});Micsun.event=function(a){return a||window.event};
Micsun.Event={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_SHIFT:16,KEY_CTRL:17,KEY_PAUSE:19,KEY_CAPSLOCK:20,KEY_ESC:27,KEY_SPACE:33,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_END:35,KEY_HOME:36,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_INSERT:45,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,KEY_WIN:91,KEY_WIN_R:92,KEY_MENU:93,KEY_F1:112,KEY_F2:113,KEY_F3:114,KEY_F4:115,KEY_F5:116,KEY_F6:117,KEY_F7:118,KEY_F8:119,KEY_F9:120,KEY_F10:121,KEY_F11:122,KEY_F12:123,KEY_NUMLOCK:144,
KEY_SCROLLLOCK:145,stop:function(a){try{a.preventDefault()}catch(c){}try{a.preventDefault()}catch(d){}a.stopped=!0}};var M$=Micsun.$,M$$=Micsun.$$,$=Micsun.$;Micsun.Class=function(){function a(){this.initialize&&this.initialize.apply(this,arguments)}var c=Micsun.array(arguments);Micsun.extend(a,Micsun.Methods);a.applyMethods(c);if(!a.prototype.initialize)a.prototype.initialize=Micsun.empty;return a.prototype.constructor=a};
Micsun.Methods={applyMethods:function(a){for(var c=0;c<a.length;c++){var d=a[c],e=Micsun.keys(d);Micsun.keys({toString:!0}).length||e.push("toString","valueOf");for(var c=0,f=e.length;c<f;c++){var h=e[c];this.prototype[h]=d[h]}}return this}};
Micsun.extend(String.prototype,{truncate:function(a,c){a=a||30;c=Micsun.isUndefined(c)?"...":c;return this.length>a?this.slice(0,a-c.length)+c:""+this},strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"")},include:function(a){return-1<this.indexOf(a)},startsWith:function(a){return 0===this.indexOf(a)},endsWith:function(a){var c=this.length-a.length;return 0<=c&&this.lastIndexOf(a)===c},camelize:function(){var a=this.split("-"),
c=a.length;if(1==c)return a[0];for(var d="-"==this.charAt(0)?a[0].charAt(0).toUpperCase()+a[0].substring(1):a[0],e=1;e<c;e++)d+=a[e].charAt(0).toUpperCase()+a[e].substring(1);return d}});
Micsun.HashMap=Micsun.Class({initialize:function(){this.entry={};this._size=0},put:function(a,c){this.containsKey(a)||this._size++;this.entry[a]=c},get:function(a){return this.containsKey(a)?this.entry[a]:null},remove:function(a){this.containsKey(a)&&delete this.entry[a]&&this._size--},containsKey:function(a){return a in this.entry},containsValue:function(a){for(var c in this.entry)if(this.entry[c]==a)return!0;return!1},values:function(){var a=[],c;for(c in this.entry)a.push(this.entry[c]);return a},
keys:function(){var a=[],c;for(c in this.entry)a.push(c);return a},size:function(){return this._size},clear:function(){this._size=0;this.entry={}}});var HashMap=Micsun.HashMap;
Micsun.Queue=Micsun.Class({initialize:function(a,c){this.queue=[];this.maxSize=a||-1;this.autoFlow=c||!1},enter:function(a){if(-1!=this.maxSize&&this.queue.length>=this.maxSize)if(this.autoFlow)this.queue.pop(),this.queue.unshift(a);else return"exceed the max size of queue!";else this.queue.unshift(a)},remove:function(){return this.queue.pop()},get:function(a){return a<this.stack.length&&0<=a?this.stack[a]:null},size:function(){return this.queue.length},clear:function(){this.queue=[]},isEmpty:function(){return 0>=
this.queue.length}});var Queue=Micsun.Queue;
Micsun.Stack=Micsun.Class({initialize:function(a,c){this.stack=[];this.maxSize=a||-1;this.autoFlow=c||!1},isEmpty:function(){return 0>=this.stack.length},push:function(a){if(-1!=this.maxSize&&this.stack.length>=this.maxSize)if(this.autoFlow)this.stack.shift(),this.stack.push(a);else return"exceed the max size of stack!";else this.stack.push(a)},pop:function(){return this.stack.pop()},get:function(a){return a<this.stack.length&&0<=a?this.stack[a]:null},clear:function(){this.stack=[]},size:function(){return this.stack.length}});
var Stack=Micsun.Stack;
Micsun.File=Micsun.Class({initialize:function(a,c,d){this.url=a;this.call=c;this.timeout=d||1;this.req=null},read:function(){this.req=new XMLHttpRequest;if(!this.req)return onError();var a=1E3*this.timeout,c=function(a){return function(){a.onError()}}(c);this.timer=setTimeout(c,a);this.req.open("GET",this.url,!0);var c;this.req.onreadystatechange=function(a){return function(){a.onChange()}}(this);this.req.onError=c;this.req.send(null)},onChange:function(){if(this.timer)this.timer=clearTimeout(this.timer);
4==this.req.readyState&&this.handler(this.req.responseText,0)},onError:function(){this.handler(null,!0)},handler:function(a,c){this.call&&this.call(a,c)}});
Micsun.COOKIE={path:"/",expires:new Date((new Date).getTime()+864E5),domain:null,secure:!1,getCookiePrefix:function(){var a="micsun-";"undefined"!=typeof Micsun.currentApplication&&null!=Micsun.currentApplication&&(a=Micsun.currentApplication+"-"+a);return a},set:function(a,c,d){if("undefined"==typeof c||null===c)this.clear(a);else{if("undefined"!=typeof d&&null!=d)this.expires=new Date((new Date).getTime()+864E5*d);d=this.getCookiePrefix();document.cookie=d+a+"="+escape(c)+(null==this.expires?"":
"; expires="+this.expires.toGMTString())+(null==this.path?"":"; path="+this.path)+(null==this.domain?"":"; domain="+this.domain)+(!0==this.secure?"; secure":"")}},get:function(a){var c=this.getCookiePrefix(),a=document.cookie.match(RegExp("(^| )"+c+a+"=([^;]*)(;|$)"));return null!=a?unescape(a[2]):null},clear:function(a){var c=this.getCookiePrefix();document.cookie=c+a+"=null; expires=Thu, 01-Jan-70 00:00:01 GMT"+(null==this.path?"":"; path="+this.path)+(null==this.domain?"":"; domain="+this.domain)+
(!0==this.secure?"; secure":"")}};var mycookie=Micsun.COOKIE;
Micsun.UTILS={addBookMark:function(a,c){if(window.sidebar)window.sidebar.addPanel(a,c,"");else if(document.all)window.external.AddFavorite(c,a);else if(window.opera&&window.print)return!0},setHomePage:function(a){if(document.all)document.body.style.behavior="url(#default#homepage)",document.body.setHomePage(a);else if(window.sidebar&&window.netscape)try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(c){alert("\u8be5\u64cd\u4f5c\u5df2\u88ab\u6d4f\u89c8\u5668\u62d2\u7edd\uff0c\u5982\u679c\u60f3\u542f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5728\u5730\u5740\u680f\u5185\u8f93\u5165 about:config,\u7136\u540e\u5c06 signed.applets.codebase_principal_support \u503c\u8be5\u4e3atrue")}},getClipboardData:function(){if(window.clipboardData)return window.clipboardData.getData("text");
if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var a=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!a)return;var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c)return;c.addDataFlavor("text/unicode");a.getData(c,a.kGlobalClipboard);var a={},d={};c.getTransferData("text/unicode",a,d)}catch(e){return alert("\u60a8\u7684firefox\u5b89\u5168\u9650\u5236\u9650\u5236\u60a8\u8fdb\u884c\u526a\u8d34\u677f\u64cd\u4f5c\uff0c\u8bf7\u6253\u5f00'about:config'\u5c06signed.applets.codebase_principal_support'\u8bbe\u7f6e\u4e3atrue'\u4e4b\u540e\u91cd\u8bd5\uff0c\u76f8\u5bf9\u8def\u5f84\u4e3afirefox\u6839\u76ee\u5f55/greprefs/all.js"),
null}a&&(a=Components.interfaces.nsISupportsWString?a.value.QueryInterface(Components.interfaces.nsISupportsWString):Components.interfaces.nsISupportsString?a.value.QueryInterface(Components.interfaces.nsISupportsString):null);if(a)return a.data.substring(0,d.value/2)}return null},tackObj:function(a){var c="",d,e;for(e in a)a.hasOwnProperty(e)&&(c=(d=a[e])&&"object"==typeof d?c+"  "+e+":{ "+arguments.callee(d).join(", ")+"}":c+"  "+[e+":"+d.toString()]);return c},getProperty:function(){},addClass:function(a,
c){if(a){if(!a.className)a.className="";if(-1==a.className.search(RegExp("(^| )"+c+"( |$)","g")))a.className=a.className+" "+c}},removeClass:function(a,c){if(a&&a.className)a.className=a.className.replace(RegExp("(^| )"+c+"( |$)","g")," ")},showObject:function(a){if(a=M$(a))a.style.display="block"},hideObject:function(a){if(a=M$(a))a.style.display="none"},isShow:function(a){return"block"!=M$(a).style.display?!1:!0},switchShowOrHidden:function(a){"block"!=M$(a).style.display?this.showObject(a):this.hideObject(a)},
getDateTime:function(){var a=new Date,c=a.getYear(),d=a.getDate();return c+"-"+"Jan,Tue,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(",")[a.getMonth()]+d+" "+"Sun,Mon,Tue,Wen,Thu,Fri,Sat,Sun".split(",")[a.getDay()]},changeRowClass:function(a,c,d,e){if(a=M$(a)){var a=a.getElementsByTagName("ul"),f=null;if(0<=a.length){f=a[0];for(a=f.getElementsByTagName("li");c<a.length;c++)(c+1)%2?this.addClass(a[c],d):this.addClass(a[c],e)}}},changeTableClass:function(a,c,d,e){if(a=M$(a))if(a=a.rows,null!=a)for(;c<
a.length;c++)(c+1)%2?this.addClass(a[c],d):this.addClass(a[c],e)},setTheme:function(a){mycookie.set("site_skin",a);document.location.reload(!0)},setLocale:function(a){mycookie.set("site_locale",a);document.location.reload(!0)},gotoUrl:function(a){window.location=a},submitPortlet:function(a){var c=document.forms[a+"_form"];null==c&&(c=document.forms[a]);c.onsubmit()&&c.submit()},submitPortletByAjax:function(a,c,d){this.submitFormByAjax(a+"_form",c,d)},submitFormByAjax:function(a,c,d){var a=document.forms[a],
e=a.elements,f,h,j="";for(h=0;h<e.length;++h)if(f=e[h],Micsun.isUndefined(f.type))j+=encodeURIComponent(f.name)+"="+encodeURIComponent(f.value)+"&";else if("text"==f.type||"textarea"==f.type||"hidden"==f.type)j+=encodeURIComponent(f.name)+"="+encodeURIComponent(f.value)+"&";else if("select-one"==f.type||"select-multiple"==f.type){var k=f.options,l,m;for(l=0;l<k.length;++l)m=k[l],m.selected&&(j+=encodeURIComponent(f.name)+"="+encodeURIComponent(m.value)+"&")}else"checkbox"==f.type||"radio"==f.type?
f.checked&&(j+=encodeURIComponent(f.name)+"="+encodeURIComponent(f.value)+"&"):"file"==f.type&&""!=f.value&&(j+=encodeURIComponent(f.name)+"="+encodeURIComponent(f.value)+"&");j=j+"isByAjax=true"+("&"+Micsun.toQueryString(d));new Ajax.Request(a.action,{method:a.method,parameters:j,asynchronous:!0,onComplete:c})},submitDivByAjax:function(a,c,d,e){a=this.getSubmitURIByEl(M$(a));a=a+"isByAjax=true"+("&"+Micsun.toQueryString(e));new Ajax.Request(c,{method:"post",parameters:a,asynchronous:!1,onComplete:d})},
getSubmitURIByEl:function(a){for(var c="",a=a.children,d=0,d=0;d<a.length;++d){var e=a[d];if(!Micsun.isUndefined(e.type)&&""!=e.type)if("text"==e.type||"textarea"==e.type||"hidden"==e.type)c+=encodeURIComponent(e.name)+"="+encodeURIComponent(e.value)+"&";else if("select-one"==e.type||"select-multiple"==e.type){var f=e.options,h,j;for(h=0;h<f.length;++h)j=f[h],j.selected&&(c+=encodeURIComponent(e.name)+"="+encodeURIComponent(j.value)+"&")}else"checkbox"==e.type||"radio"==e.type?e.checked&&(c+=encodeURIComponent(e.name)+
"="+encodeURIComponent(e.value)+"&"):"file"==e.type&&""!=e.value&&(c+=encodeURIComponent(e.name)+"="+encodeURIComponent(e.value)+"&");else c+=this.getSubmitURIByEl(e)}return c},retrieveDataFromDiv:function(a){var c={};this._retrieveDataFromElement(M$(a),c);return c},_retrieveDataFromElement:function(a,c){for(var d=a.children,e=0,e=0;e<d.length;++e){var f=d[e];if(!Micsun.isUndefined(f.type)&&""!=f.type)if("text"==f.type||"textarea"==f.type||"hidden"==f.type)c[f.name]=f.value;else if("select-one"==
f.type||"select-multiple"==f.type){var h=f.options,j,k;for(j=0;j<h.length;++j)if(k=h[j],k.selected)c[f.name]=k.value}else if("checkbox"==f.type||"radio"==f.type){if(f.checked)c[f.name]=f.value}else{if("file"==f.type&&""!=f.value)c[f.name]=f.value}else this._retrieveDataFromElement(f,c)}},putDataToDiv:function(a,c,d){a=M$(a);null!=c&&this._putDataFromElement(a,c,d)},cleanDataToDiv:function(a,c){this._putDataFromElement(dataDiv,{},c)},_putDataFromElement:function(a,c,d){for(var a=a.children,e=0,e=0;e<
a.length;++e){var f=a[e];if(!Micsun.isEmpty(f.name)&&!Micsun.isEmpty(d)){for(var h=!1,j=0;j<d.length;j++)if(f.name==d[j]){h=!0;break}if(h)continue}if(!Micsun.isUndefined(f.type)&&""!=f.type)if("text"==f.type||"textarea"==f.type||"hidden"==f.type)f.value=Micsun.isEmpty(c[f.name])?"":c[f.name];else if("select-one"==f.type||"select-multiple"==f.type)f.value=Micsun.isEmpty(c[f.name])?"":c[f.name];else if("checkbox"==f.type||"radio"==f.type)f.value=Micsun.isEmpty(c[f.name])?"":c[f.name];else{if("file"==
f.type)f.value=Micsun.isEmpty(c[f.name])?"":c[f.name]}else this._putDataFromElement(f,c,d)}},fileBrowser:function(a,c,d,e){_app_pop_win.open("iframe",e+"/mainsite/common/file_chooser.jsp?field_name="+a+("&include_root_path="+d)+("&select_type="+c),"\u6587\u4ef6\u7ba1\u7406","width=640px,height=400px,resize=0,scrolling=0,center=1,move=1,frame_scrolling=0");_app_pop_win.show()},fileBrowserEx:function(a,c,d,e){_chooserWinEx.open("iframe",e+"/mainsite/common/file_chooser.jsp?field_name="+a+("&include_root_path="+
d)+("&select_type="+c),"\u6587\u4ef6\u7ba1\u7406","width=640px,height=400px,resize=0,move=1,scrolling=0,frame_scrolling=0","recal");_chooserWinEx.center()},imageViewer:function(a,c){_app_pop_win.open("iframe",c+"/mainsite/common/view_image.jsp?imageId="+a,"\u6587\u4ef6\u7ba1\u7406","width=800px,height=500px,resize=0,scrolling=0,center=1,move=1,frame_scrolling=0");_app_pop_win.show()},showThumbnail:function(a,c,d,e,f){M$(a);a=(new Date).getMilliseconds();return f+"/send_message?msg_handler=PortalFileManagerMsgHdr&opt_type=convert_image"+
("&image_path="+f+c)+("&image_width="+d)+("&image_height="+e)+("&d="+a)},setMetaContent:function(a,c){for(var d=document.getElementsByTagName("meta"),e=0;e<d.length;e++)d[e].getAttribute("name")&&d[e].getAttribute("name")==a&&d[e].setAttribute("content",c)},changeOpac:function(a,c){Micsun.UTILS.changeObjOpac(M$(a),c)},changeObjOpac:function(a,c){var d=a.style;d.opacity=c/100;d.MozOpacity=c/100;d.KhtmlOpacity=c/100;d.filter=100>c?"alpha(opacity="+c+")":"none"},moveTo:function(a,c,d){c=new Micsun.DOM.Point(c,
d);Micsun.UTILS.moveToPoint(a,c)},moveToPoint:function(a,c){var d=M$(a).style;d.left=c.x;d.top=c.y},paramUriToMap:function(){}};var myutil=Micsun.UTILS;
Micsun.UTILS.DateTools={defaultOptions:{ignoreTimezone:!0,monthNames:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),monthNamesShort:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),dayNames:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),dayNamesShort:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",")},DAY_MS:864E5,HOUR_MS:36E5,MINUTE_MS:6E4,SECOND_MS:1E3,dateFormatters:{s:function(a){return a.getSeconds()},ss:function(a){return Micsun.UTILS.DateTools.zeroPad(a.getSeconds())},
m:function(a){return a.getMinutes()},mm:function(a){return Micsun.UTILS.DateTools.zeroPad(a.getMinutes())},h:function(a){return a.getHours()%12||12},hh:function(a){return Micsun.UTILS.DateTools.zeroPad(a.getHours()%12||12)},H:function(a){return a.getHours()},HH:function(a){return Micsun.UTILS.DateTools.zeroPad(a.getHours())},d:function(a){return a.getDate()},dd:function(a){return Micsun.UTILS.DateTools.zeroPad(a.getDate())},ddd:function(a,c){return c.dayNamesShort[a.getDay()]},dddd:function(a,c){return c.dayNames[a.getDay()]},
M:function(a){return a.getMonth()+1},MM:function(a){return Micsun.UTILS.DateTools.zeroPad(a.getMonth()+1)},MMM:function(a,c){return c.monthNamesShort[a.getMonth()]},MMMM:function(a,c){return c.monthNames[a.getMonth()]},yy:function(a){return(a.getFullYear()+"").substring(2)},yyyy:function(a){return a.getFullYear()},t:function(a){return 12>a.getHours()?"a":"p"},tt:function(a){return 12>a.getHours()?"am":"pm"},T:function(a){return 12>a.getHours()?"A":"P"},TT:function(a){return 12>a.getHours()?"AM":"PM"},
u:function(a){return Micsun.UTILS.DateTools.formatDate(a,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(a){a=a.getDate();return 10<a&&20>a?"th":["st","nd","rd"][a%10-1]||"th"}},zeroPad:function(a){return(10>a?"0":"")+a},addYears:function(a,c,d){a.setFullYear(a.getFullYear()+c);d||this.clearTime(a);return a},addMonths:function(a,c,d){if(+a){var c=a.getMonth()+c,e=this.cloneDate(a);e.setDate(1);e.setMonth(c);a.setMonth(c);for(d||this.clearTime(a);a.getMonth()!=e.getMonth();)a.setDate(a.getDate()+(a<e?1:-1))}return a},
addDays:function(a,c,d){if(+a){var c=a.getDate()+c,e=this.cloneDate(a);e.setHours(9);e.setDate(c);a.setDate(c);d||this.clearTime(a);this.fixDate(a,e)}return a},fixDate:function(a,c){if(+a)for(;a.getDate()!=c.getDate();)a.setTime(+a+(a<c?1:-1)*this.HOUR_MS)},addMinutes:function(a,c){a.setMinutes(a.getMinutes()+c);return a},clearTime:function(a){a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return a},cloneDate:function(a,c){return c?this.clearTime(new Date(+a)):new Date(+a)},zeroDate:function(){var a=
0,c;do c=new Date(1970,a++,1);while(c.getHours());return c},skipWeekend:function(a,c,d){for(c=c||1;!a.getDay()||d&&1==a.getDay()||!d&&6==a.getDay();)this.addDays(a,c);return a},dayDiff:function(a,c){return Math.round((this.cloneDate(a,!0)-this.cloneDate(c,!0))/this.DAY_MS)},hourDiff:function(a,c){return Math.round((this.cloneDate(a,!1)-this.cloneDate(c,!1))/this.HOUR_MS)},minuteDiff:function(a,c){return Math.round((this.cloneDate(a,!1)-this.cloneDate(c,!1))/this.MINUTE_MS)},secondDiff:function(a,
c){return Math.round((this.cloneDate(a,!1)-this.cloneDate(c,!1))/this.SECOND_MS)},setYMD:function(a,c,d,e){void 0!==c&&c!=a.getFullYear()&&(a.setDate(1),a.setMonth(0),a.setFullYear(c));void 0!==d&&d!=a.getMonth()&&(a.setDate(1),a.setMonth(d));void 0!==e&&a.setDate(e)},parseDate:function(a,c){if("object"==typeof a)return a;if("number"==typeof a)return new Date(1E3*a);if("string"==typeof a){if(a.match(/^\d+(\.\d+)?$/))return new Date(1E3*parseFloat(a));void 0===c&&(c=!0);return this.parseISO8601(a,
c)||(a?new Date(a):null)}return null},parseISO8601:function(a,c){var d=a.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!d)return null;var e=new Date(d[1],0,1);if(c||!d[13]){var f=new Date(d[1],0,1,9,0);d[3]&&(e.setMonth(d[3]-1),f.setMonth(d[3]-1));d[5]&&(e.setDate(d[5]),f.setDate(d[5]));this.fixDate(e,f);d[7]&&e.setHours(d[7]);d[8]&&e.setMinutes(d[8]);d[10]&&e.setSeconds(d[10]);d[12]&&e.setMilliseconds(1E3*
Number("0."+d[12]));this.fixDate(e,f)}else e.setUTCFullYear(d[1],d[3]?d[3]-1:0,d[5]||1),e.setUTCHours(d[7]||0,d[8]||0,d[10]||0,d[12]?1E3*Number("0."+d[12]):0),d[14]&&(f=60*Number(d[16])+(d[18]?Number(d[18]):0),f*="-"==d[15]?1:-1,e=new Date(+e+6E4*f));return e},parseTime:function(a){if("number"==typeof a)return 60*a;if("object"==typeof a)return 60*a.getHours()+a.getMinutes();if(a=a.match(/(\d+)(?::(\d+))?\s*(\w+)?/)){var c=parseInt(a[1],10);a[3]&&(c%=12,"p"==a[3].toLowerCase().charAt(0)&&(c+=12));
return 60*c+(a[2]?parseInt(a[2],10):0)}},formatDate:function(a,c,d){return this.formatDates(a,null,c,d)},formatDates:function(a,c,d,e){var e=e||this.defaultOptions,f=a,h=c,j,k=d.length,l,m,o,n="";for(j=0;j<k;j++)if(l=d.charAt(j),"'"==l)for(m=j+1;m<k;m++){if("'"==d.charAt(m)){f&&(n=m==j+1?n+"'":n+d.substring(j+1,m),j=m);break}}else if("("==l)for(m=j+1;m<k;m++){if(")"==d.charAt(m)){j=this.formatDate(f,d.substring(j+1,m),e);parseInt(j.replace(/\D/,""),10)&&(n+=j);j=m;break}}else if("["==l)for(m=j+1;m<
k;m++){if("]"==d.charAt(m)){l=d.substring(j+1,m);j=this.formatDate(f,l,e);j!=this.formatDate(h,l,e)&&(n+=j);j=m;break}}else if("{"==l)f=c,h=a;else if("}"==l)f=a,h=c;else{for(m=k;m>j;m--)if(o=this.dateFormatters[d.substring(j,m)]){f&&(n+=o(f,e));j=m-1;break}m==j&&f&&(n+=l)}return n}};var mydatetools=Micsun.UTILS.DateTools;Micsun.extend(Array.prototype,{_each:function(a){for(var c=0,d=this.length;c<d;c++)a(this[c])},size:function(){return this.length}});
Micsun.Thread=Micsun.Class({initialize:function(a,c,d){this.callback=a;this.second=c;!Micsun.isEmpty(d)&&d&&this.restart()},restart:function(){if(this.timer)this.stop(),this.timer=null;var a=function(a){return function(){a.run()}}(this);this.timer=setInterval(a,1E3*this.second)},stop:function(){if(this.timer)clearInterval(this.timer),this.timer=null},run:function(){this.callback(this)}});
Micsun.JSON={encode:function(a,c){var d,e=c?"\n":"";switch(Micsun.hasType(a)){case "string":return'"'+a.replace(/[\x00-\x1f\\"]/g,Micsun.JSON.replaceChars)+'"';case "array":return d=[],Micsun.each(a,function(a){((a=Micsun.JSON.encode(a,c))||0===a)&&d.push(a)}),"["+e+(c?d.join(","+e):d)+"]"+e;case "object":if(null===a)return"null";d=[];Micsun.each(a,function(a,e){var j=Micsun.JSON.encode(a,c);j&&d.push(Micsun.JSON.encode(e,c)+":"+j)},null,null);return"{"+e+(c?d.join(","+e):d)+e+"}"+e;case "number":case "boolean":return""+
a}return null},decode:function(a,c){return!Micsun.hasType(a,"string")||!a.length||c&&!/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/.test(a.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,""))?null:eval("("+a+")")},specialChars:{"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},replaceChars:function(a){return Micsun.JSON.specialChars[a]||"\\u00"+Math.floor(a.charCodeAt()/16).toString(16)+(a.charCodeAt()%16).toString(16)}};
Micsun.DOM={addDOMReadyFunctions:function(a){if(Micsun.isUndefined(this.domReadyFunArray))this.domReadyFunArray=[];this.domReadyFunArray.push(a)},_execDOMReadyFunctions:function(){if(!Micsun.isUndefined(this.domReadyFunArray))for(var a=0,c=this.domReadyFunArray.length;a<c;a++)try{this.domReadyFunArray[a]()}catch(d){}},getClientWidth:function(a){var a=a||document,c=self.innerWidth,d=a.compatMode;if(d||Micsun.isIE)c="CSS1Compat"==d?a.documentElement.clientWidth:a.body.clientWidth;return c},getClientHeight:function(a){var a=
a||document,c=self.innerHeight,d=a.compatMode;if(d||Micsun.isIE)c="CSS1Compat"==d?a.documentElement.clientHeight:a.body.clientHeight;return c},getScrollLeft:function(a){a=a||document;return Math.max(a.documentElement.scrollLeft||a.body.scrollLeft)},getScrollTop:function(a){a=a||document;return Math.max(a.documentElement.scrollTop||a.body.scrollTop)},getScrollHeight:function(a){a=a||document;return"CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:a.body.scrollHeight},getScrollWidth:function(a){a=
a||document;return"CSS1Compat"==a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth},getIFrameDocument:function(a){return document.getElementById(a).contentDocument||document.frames[a].document},addClass:function(a,c){if(a){if(!a.className)a.className="";if(-1==a.className.search(RegExp("(^| )"+c+"( |$)","g")))a.className=a.className+" "+c}},removeClass:function(a,c){if(a&&a.className)a.className=a.className.replace(RegExp("(^| )"+c+"( |$)","g")," ")},setClass:function(a,c){if(a)a.className=
c},showObject:function(a){if(a=Micsun.$(a))a.style.display="block"},hideObject:function(a){if(a=Micsun.$(a))a.style.display="none"},isShow:function(a){return"block"!=Micsun.$(a).style.display?!1:!0},switchShowOrHidden:function(a){"block"!=Micsun.$(a).style.display?this.showObject(a):this.hideObject(a)},getStyle:function(a,c){var d=Micsun.$(a);return Micsun.DOM.getObjStyle(d,c)},getObjStyle:function(a,c){c="float"==c?"cssFloat":c.camelize();if(!Micsun.isUndefined(a)){var d=a.style[c];!d&&!Micsun.isUndefined(document.defaultView)&&
(d=(d=document.defaultView.getComputedStyle(a,null))?d[c]:null);return"auto"==d?null:d}},setStyle:function(a,c){var d=Micsun.$(a);Micsun.DOM.setObjStyle(d,c)},setObjStyle:function(a,c){if(!Micsun.isUndefined(a)){var d=a.style;if(Micsun.hasType(c,"string"))return a.style.cssText+=";"+c,a;for(var e in c)"float"==e||"cssFloat"==e?d[Micsun.isUndefined(d.styleFloat)?"cssFloat":"styleFloat"]=c[e]:d[e]=c[e];return a}},getDimensions:function(a){return this.getDimensionsByEl(Micsun.$(a))},getDimensionsByEl:function(a){if(!Micsun.isUndefined(a)){var c=
a.style.display;if("none"!=c&&null!=c)return{width:a.offsetWidth,height:a.offsetHeight};var c=a.style,d=c.visibility,e=c.position,f=c.display;c.visibility="hidden";c.position="absolute";c.display="block";var h=a.clientWidth,a=a.clientHeight;c.display=f;c.position=e;c.visibility=d;return{width:h,height:a}}},getPagePoint:function(a){if((null===a.parentNode||null===a.offsetParent||"none"==this.getStyle(a,"display"))&&a!=document.body)return null;var c=null,d,e;if(a.getBoundingClientRect)return c=a.getBoundingClientRect(),
new Micsun.DOM.Point(c.left+Micsun.DOM.getScrollLeft(),c.top+Micsun.DOM.getScrollTop());d=a.offsetLeft;e=a.offsetTop;var c=a.offsetParent,f="absolute"==Micsun.DOM.getStyle(a,"position");if(c!=a)for(;c;)d+=c.offsetLeft,e+=c.offsetTop,Micsun.isSafari&&!f&&"absolute"==Micsun.DOM.getStyle(c,"position")&&(f=!0),c=c.offsetParent;Micsun.isSafari&&f&&(d-=a.ownerDocument.body.offsetLeft,e-=a.ownerDocument.body.offsetTop);c=a.parentNode;for(a=/^body|html$/i;c&&c.tagName&&!a.test(c.tagName);)Micsun.DOM.getStyle(c,
"display").search(/^inline|table-row.*$/i)&&(d-=c.scrollLeft,e-=c.scrollTop),c=c.parentNode;return new Micsun.DOM.Point(d,e)},getRegion:function(a){if(!Micsun.isUndefined(a)){var c=this.getPagePoint(a),d=c.x,c=c.y;return new Micsun.DOM.Region(c,d+a.offsetWidth,c+a.offsetHeight,d)}},getEventX:function(a){var c=0,a=a||window.event;if(!a)return!1;if(a.pageX)return c=a.pageX;if(a.clientX)return c=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft},getEventY:function(a){var c=0,a=a||
window.event;if(!a)return!1;if(a.pageY)return c=a.pageY;if(a.clientY)return c=a.clientY+document.body.scrollTop+document.documentElement.scrollTop},zoomOjbect:function(a,c){a.style.zoom=c+"%";var d=parseFloat(c)/100;a.style.WebkitTransformOrigin="top left";a.style.WebkitTransform="scale("+d+")";a.style.MozTransformOrigin="top left";a.style.MozTransform="scale("+d+")"},getEventTarget:function(a){var c,a=a||window.event;if(a.target)c=a.target;else if(a.srcElement)c=a.srcElement;if(3==c.nodeType)c=c.parentNode;
return c},element:function(a,c){if(Micsun.hasType(a,"string")){if(Micsun.isIE&&c&&(c.name||c.type)){var d=c.name?' name="'+c.name+'"':"",e=c.type?' type="'+c.type+'"':"";delete c.name;delete c.type;a="<"+a+d+e+">"}a=document.createElement(a)}c&&(c.style&&(Micsun.extend(a.style,c.style),delete c.style),Micsun.extend(a,c));return a},loadJS:function(a,c){var d=arguments.callee;if(!("queue"in d))d.queue={};var e=d.queue;if(a in e)c&&(e[a]?e[a].push(c):c());else{e[a]=c?[c]:[];var f=document.createElement("script");
f.type="text/javascript";f.onload=f.onreadystatechange=function(){if(!f.readyState||!("loaded"!=f.readyState&&"complete"!=f.readyState)){for(f.onreadystatechange=f.onload=null;e[a].length;)e[a].shift()();e[a]=null}};f.src=a;document.getElementsByTagName("head")[0].appendChild(f)}},loadCss:function(a,c){var d=arguments.callee;if(!("queue"in d))d.queue={};var e=d.queue;if(a in e)c&&(e[a]?e[a].push(c):c());else{e[a]=c?[c]:[];var f;Micsun.isGecko?f=document.createElement("style"):(f=document.createElement("link"),
f.rel="stylesheet",f.href=a);Micsun.isGecko?f.innerHTML='@import "'+a+'";':f.onload=f.onerror=function(){f.onreadystatechange=f.onload=null;e[a]=null;alert("")};document.getElementsByTagName("head")[0].appendChild(f)}},insertHTML:function(a,c,d){if(!a)return!1;c=c.toLowerCase();if(a.insertAdjacentHTML)"replace"==c?a.innerHTML=d:a.insertAdjacentHTML(c,d);else{var e=a.ownerDocument.createRange(),f=null;switch(c){case "beforebegin":return e.setStartBefore(a),f=e.createContextualFragment(d),a.parentNode.insertBefore(f,
a),a.previousSibling;case "afterbegin":return a.firstChild?(e.setStartBefore(a.firstChild),f=e.createContextualFragment(d),a.insertBefore(f,a.firstChild)):a.innerHTML=d,a.firstChild;case "beforeend":return a.lastChild?(e.setStartAfter(a.lastChild),f=e.createContextualFragment(d),a.appendChild(f)):a.innerHTML=d,a.lastChild;case "afterend":return e.setStartAfter(a),f=e.createContextualFragment(d),a.parentNode.insertBefore(f,a.nextSibling),a.nextSibling;case "replace":return a.innerHTML=d,a.firstChild}}},
hasAttr:function(a,c){if(void 0!==a){if(void 0!==a.hasAttribute)return a.hasAttribute(c);if(void 0!==a.getAttribute)return null!==a.getAttribute(c)}return!1},removeAttr:function(a,c){void 0!==a&&a.setAttribute(c,"")}};
Micsun.DOM.Region=Micsun.Class({initialize:function(a,c,d,e){this.top=a;this.right=c;this.bottom=d;this.left=e},intersect:function(a){var c=Math.max(this.top,a.top),d=Math.min(this.right,a.right),e=Math.min(this.bottom,a.bottom),a=Math.max(this.left,a.left);return e>=c&&d>=a?new Micsun.DOM.Region(c,d,e,a):null},toString:function(){return"top:"+this.top+" ,right:"+this.right+" ,bottom:"+this.bottom+" ,left"+this.left}});
Micsun.DOM.Point=Micsun.Class({initialize:function(a,c){this.x=a;this.y=c},toString:function(){return"x:"+this.x+" ,y:"+this.y}});Micsun.DOM.Block=Micsun.Class({initialize:function(a,c){this.w=this.w=c},toString:function(){return"w:"+this.w+" ,h:"+this.h}});Micsun.DOM.Color=Micsun.Class({initialize:function(a,c,d){this.r=a;this.g=c;this.b=d},toString:function(){return"r:"+this.r+" ,g:"+this.g+" ,b:"+this.b}});
(function(){function a(){if(!document.loaded)c&&window.clearInterval(c),document.loaded=!0,Micsun.DOM.loaded=!0,Micsun.DOM._execDOMReadyFunctions()}var c;if(document.readyState&&Micsun.isWebKit)c=window.setInterval(function(){this.readyState.match(/complete|loaded/i)&&c&&window.clearInterval(c);a()},0);else if(document.readyState&&(Micsun.isIE6||Micsun.isIE7||Micsun.isIE8))document.write("<script id=__onDOMLoaded defer src=//:><\/script>"),M$("__onDOMLoaded").onreadystatechange=function(){if(this.readyState.match(/complete/i))this.onReadyEvent=
null,a()};else if(window.addEventListener)document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a);else{var d=window.onload;window.onload=function(){a();d&&d()}}})();Micsun||alert("The following script will work with micsun.base.js!");Micsun.Ajax={};Micsun.Ajax.Events={UNINITIALIZED:0,LOADING:1,LOADED:2,INTERACTIVE:3,COMPLETE:4};
Micsun.Ajax.Request=Micsun.Class({initialize:function(a,c){this.options={method:"post",asynchronous:!0,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:!0};Micsun.extend(this.options,c||{});this.options.method=this.options.method.toLowerCase();this._complete=!1;if(window.XMLHttpRequest)this.transport=new XMLHttpRequest;else if(window.ActiveXObject)try{this.transport=new ActiveXObject("Microsoft.XMLHTTP")}catch(d){try{this.transport=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){this.transport=
null}}else this.transport=null;this.sendRequest(a)},sendRequest:function(a){this.url=a;this.method=this.options.method;var c=this.options.parameters;Micsun.hasType(c,"object")&&(c=Micsun.toQueryString(c));if("get"!=this.method&&"post"!=this.method)this.method="post";if("post"==this.method){var d=this.url.indexOf("?");if(0<=d)c=a.substring(d+1)+"&"+c,this.url=this.url.substring(0,d)}else if("get"==this.method)d=this.url.indexOf("?"),this.url=0<d?this.url+("&"+c):this.url+("?"+c),c=null;try{if(this.options.onCreate)this.options.onCreate(new Micsun.Ajax.Response(this));
this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);this.options.asynchronous&&Micsun.bind(this.onStateChange,this);this.transport.onreadystatechange=Micsun.bind(this.onStateChange,this);this.setHeaders();this.body="post"==this.method?this.options.postBody||c:null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType)this.onStateChange()}catch(e){this.dispatchException(e)}},setHeaders:function(){var a={"X-Requested-With":"XMLHttpRequest",
"X-Micsun-Version":Micsun.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if("post"==this.method&&(a["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:""),this.transport.overrideMimeType&&2005>(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]))a.Connection="close";Micsun.hasType(this.options.requestHeaders,"object")&&(a=Micsun.clone(a,this.options.requestHeaders));for(var c in a)this.transport.setRequestHeader(c,
a[c])},isSuccess:function(){var a=this.getStatus();return!a||200<=a&&300>a},getStatus:function(){try{return this.transport.status||0}catch(a){return 0}},onStateChange:function(){var a=this.transport.readyState;if(a>=Micsun.Ajax.Events.UNINITIALIZED&&!(a==Micsun.Ajax.Events.COMPLETE&&this._complete)){var c=new Micsun.Ajax.Response(this);try{switch(a){case Micsun.Ajax.Events.UNINITIALIZED:(this.options.onUninitialized||Micsun.empty)(c,c.headerJSON);break;case Micsun.Ajax.Events.LOADING:(this.options.onLoading||
Micsun.empty)(c,c.headerJSON);break;case Micsun.Ajax.Events.LOADED:(this.options.onLoaded||Micsun.empty)(c,c.headerJSON);break;case Micsun.Ajax.Events.INTERACTIVE:(this.options.onInteractive||Micsun.empty)(c,c.headerJSON);break;case Micsun.Ajax.Events.COMPLETE:this._complete=!0,(this.options.onComplete||Micsun.empty)(c,c.headerJSON),(this.options["on"+(this.isSuccess()?"Success":"Failure")]||Micsun.empty)(c,c.headerJSON),this.transport.onreadystatechange=Micsun.empty}}catch(d){this.dispatchException(d)}}},
getHeader:function(a){try{return this.transport.getResponseHeader(a)||null}catch(c){return null}},dispatchException:function(a){(this.options.onException||Micsun.empty)(this,a)}});var Ajax={};Ajax.Request=Micsun.Ajax.Request;
Micsun.Ajax.Response=Micsun.Class({initialize:function(a){this.request=a;this.transport=this.request.transport;this.readyState=this.transport.readyState;if(this.readyState>Micsun.Ajax.Events.INTERACTIVE&&!Micsun.IE||this.readyState==Micsun.Ajax.Events.COMPLETE)this.status=this.getStatus(),this.statusText=this.getStatusText(),this.responseText=this.transport.responseText,this.headerJSON=this.decodeHeaderJSON();if(this.readyState==Micsun.Ajax.Events.COMPLETE)a=this.transport.responseXML,this.responseXML=
Micsun.isUndefined(a)?null:a,this.responseJSON=this.decodeJSON()},status:0,statusText:"",responseText:"",getStatus:function(){return this.request.getStatus()},getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:function(){return this.request.getHeader()},getResponseHeaders:function(){try{return this.transport.getAllResponseHeaders()}catch(a){return null}},getResponseHeader:function(a){return this.transport.getResponseHeader(a)},decodeHeaderJSON:function(){var a=
this.getHeader("X-JSON");if(!a)return null;a=decodeURIComponent(escape(a));try{return Micsun.JSON.decode(a)}catch(c){this.request.dispatchException(c)}},decodeJSON:function(){var a=this.request.options;if(!a.evalJSON||"true"!=a.evalJSON&&0<!(this.getHeader("Content-type")||"").indexOf("application/json")||Micsun.isEmpty(this.responseText))return null;try{return Micsun.JSON.decode(this.responseText)}catch(c){this.request.dispatchException(c)}}});Ajax.Response=Micsun.Ajax.Response;
var json_request_id=0;
Micsun.Ajax.JSONRequest=Micsun.Class({initialize:function(a,c){this.head=document.getElementsByTagName("head")[0]||document.body;this.options={callbackParamName:"jsonCallBack",timeout:10,invokeImmediately:!0,parameters:{},onSuccess:function(){}};Micsun.extend(this.options,c||{});this.options.url=a;this.options.invokeImmediately&&this.request()},_cleanup:function(){if(this.timeout)clearTimeout(this.timeout),this.timeout=null;if(this.transport&&Micsun.hasType(this.transport,"element"))this.transport.remove(),this.transport=
null},request:function(){var a=new Ajax.JSONResponse(this),c=this.options.callbackParamName,d="_prototypeJSONPCallback_"+json_request_id++;void 0!==this.options.parameters[c]?d=this.options.parameters[c]:this.options.parameters[c]=d;this.options.parameters[c]=d;var c=this.options.url+((this.options.url.include("?")?"&":"?")+Micsun.toQueryString(this.options.parameters)),e=function(a,c){return function(e){a._cleanup();window[d]=void 0;c.status=200;c.statusText="OK";c.setResponseContent(e);(a.options.onSuccess||
Micsun.empty)(a,c);(a.options.onComplete||Micsun.empty)(a,c)}}(this,a);window[d]=e;this.transport=new Micsun.DOM.element("script",{type:"text/javascript",src:c});(this.options.onCreate||Micsun.empty)(this,a);this.head.appendChild(this.transport);a=function(a,c){return function(){a._cleanup();window[d]=Micsun.empty;c.status=504;c.statusText="Gateway Timeout";(a.options.onFailure||Micsun.empty)(a,c);(a.options.onComplete||Micsun.empty)(a,c)}}(this,a);this.timeout=setTimeout(a,1E3*this.options.timeout)},
toString:function(){return"[object Ajax.JSONRequest]"}});Ajax.JSONRequest=Micsun.Ajax.JSONRequest;Micsun.Ajax.JSONResponse=Micsun.Class({initialize:function(a){this.request=a},request:void 0,status:0,statusText:"",responseJSON:void 0,responseText:void 0,setResponseContent:function(a){this.responseJSON=a;this.responseText=Micsun.toJSON(a)},getTransport:function(){if(this.request)return this.request.transport},toString:function(){return"[object Ajax.JSONResponse]"}});Ajax.JSONResponse=Micsun.Ajax.JSONResponse;Micsun||alert("The following script will work with micsun.base.js!");Micsun.UI={};
Micsun.UI.TreeMenu=Micsun.Class({initialize:function(a,c,d,e){this.highLigthCSS="navMenu navMenuOn";this.menuCSS="navMenu";this.menuOnCSS="navMenu navMenuOn";this.menuOverCSS="navMenu navMenuOver";this.menuWidth=e||100;this._name=a;this._container=Micsun.$(c);this.MENU_PREFIX=this._name+"_navMenu";this.MENU_PANEL_PREFIX=this._name+"_navMenuPanel";this.MENU_COOKIE=this._name+"_treemenu";this.menuBarPanel=this.menuBar=this.selectedMenuId=null;this.width=d},load:function(a){this.menuBar=document.createElement("DIV");
this.menuBar.className="navMenuBar";this.menuBar.id=this._name+"_menu_bar";this.menuBarPanel=document.createElement("DIV");this.menuBarPanel.className="navMenuBarPanel";this.menuBarPanel.style.width=this.width+"px";this.menuBarPanel.id=this._name+"_menu_bar_panel";this.menuBar.appendChild(this.menuBarPanel);for(var c="",d=null,e=0;e<a.length;e++)d=a[e],c+=this._createMenu(e,d);this.menuBarPanel.innerHTML=c;this._container?this._container.appendChild(this.menuBar):document.write(this.menuBar.innerHTML);
this.selectedMenuId=mycookie.get(this.MENU_COOKIE);this.highLightMenu(this.selectedMenuId)},_createMenu:function(a,c){var d="<div id='"+(this.MENU_PREFIX+a)+"' class='"+this.menuCSS+"' onMouseOver='"+this._name+".showMenu("+a+");' ",d=d+(" style='width:"+this.menuWidth+"px'"),d=d+(' onMouseOut="'+this._name+".hideMenu("+a+');return false;" >'),d=d+"<span>"+("<a href='"+c.url+"' target='"+c.target+"' onClick='"+this._name+".selectMenu("+a+");' onFocus='"+this._name+".menuItemfocus("+a+");'>"+c.title+
"</a>"),d=d+"</span>"+("<div id='"+this.MENU_PANEL_PREFIX+a+"' class='navMenuPanel' >");c.menuItems&&0<c.menuItems.length&&(d+=this._createMenuItem(a,c.menuItems));return d+"</div></div>"},_createMenuItem:function(a,c){for(var d='<div class="navMenuItem"><ul>',e=0;e<c.length;e++){var f=c[e];f&&f.url&&(d+="<li><a href='"+f.url+"'  onClick='"+this._name+".selectMenu("+a+");' target='"+f.target+"' >"+f.title+"</a></li>")}return d+"</ul></div><div class='navMenuBottom'><div class='navMenuBottom4'> <b></b> </div><div class='navMenuBottom3'> <b></b> </div><div class='navMenuBottom2'></div><div class='navMenuBottom1'> <b></b> </div></div>"},
selectMenu:function(a){mycookie.set(this.MENU_COOKIE,a)},highLightMenu:function(a){if(a=M$(this.MENU_PREFIX+a))a.className=this.highLigthCSS},hideMenu:function(a){var c=this.MENU_PANEL_PREFIX+a,d=M$(this.MENU_PREFIX+a),c=M$(c);d.className=this.menuCSS;if(null!=c)c.style.visibility="hidden";if(null!=this.selectedMenuId&&a==this.selectedMenuId)d.className=this.menuOnCSS},showMenu:function(a){var c=this.MENU_PANEL_PREFIX+a,a=M$(this.MENU_PREFIX+a),c=M$(c);a.className=this.menuOverCSS;if(null!=c)c.style.visibility=
"visible"},menuItemfocus:function(a){var c=this.MENU_PANEL_PREFIX+a;M$(this.MENU_PREFIX+a);var d=M$(c);this.showMenu(a);this.onblur=function(){d.focus()}}});var MicsunTreeMenu=Micsun.UI.TreeMenu;
Micsun.UI.CoolTab=Micsun.Class({initialize:function(a,c,d,e){this._currentTabItem=null;this._tabName=a;this._width=d;this.closeCallBack=e||null;if(!M$(this._tabName)&&(a=document.createElement("div"),a.id=this._tabName,a.className="tabHeader",a.style.width=""+d+"px",M$(c)?M$(c).appendChild(a):document.write(a.outerHTML),M$(this._tabName).innerHTML="<ul></ul>",!M$(this._tabName+"Body")))a=document.createElement("div"),a.id=this._tabName+"Body",a.className="tabBody",a.style.width=""+(d-4)+"px",M$(c)?
M$(c).appendChild(a):document.write(a.outerHTML);this.tabItemContainer=M$(this._tabName).getElementsByTagName("ul")[0];this.tabItemContentContainer=M$(this._tabName+"Body");this.reset()},reset:function(){for(var a=0,c=this.tabItemContainer.childNodes,d=0;d<c.length;d++)if(c[d].id&&0<=c[d].id.indexOf("TabTitle"))c[d].index=a,c[d].className="",a++;a=0;c=this.tabItemContentContainer.childNodes;for(d=0;d<c.length;d++)if(c[d].id&&0<=c[d].id.indexOf("TabContent"))c[d].index=a,c[d].style.display="none",
a++},tabSelected:function(a,c){for(var d="",e=a.childNodes,f=0;f<e.length&&c;f++)if(e[f].href&&""!=e[f].href){d=e[f].href;break}""!=d&&0<d.indexOf("http")&&c?myutil.gotoUrl(d):this.isExists(a)&&(this.reset(),this._select(a))},isExists:function(a){for(var c=this.tabItemContainer.childNodes,d=0;d<c.length;d++)if(c[d].id&&0<=c[d].id.indexOf("TabTitle")&&a==c[d])return!0;return!1},_select:function(a){for(var c=-1,d=this.tabItemContainer.childNodes,e=0;e<d.length;e++)if(d[e].id&&0<=d[e].id.indexOf("TabTitle")&&
a==d[e]){c=d[e].index;d[e].className="on";this._currentTabItem=d[e];break}a=this.tabItemContentContainer.childNodes;for(e=0;e<a.length;e++)if(a[e].id&&0<=a[e].id.indexOf("TabContent")&&a[e].index==c){a[e].style.display="";break}},tabSelectedIndex:function(a){for(var c=this.tabItemContainer.childNodes,d=0;d<c.length;d++)if(c[d].id&&0<=c[d].id.indexOf("TabTitle")&&c[d].index==a){this.tabSelected(c[d]);break}},getSelectedIndex:function(){return this._currentTabItem?this._currentTabItem.index:-1},closeCurrentTab:function(){return this._currentTabItem?
(this.removeTab(this._currentTabItem),!0):!1},setCurrentTabTitle:function(a,c,d){Micsun.isEmpty(d)&&(d="_self");if(this._currentTabItem)this._currentTabItem.innerHTML=c?"<a href='"+c+"' target='"+d+"'>"+a+"</a>":"<a target='"+d+"'>"+a+"</a>"},setDefaultTab:function(){var a=mycookie.get("selected_tab_"+this._tabName);(a=M$(a))?this.tabSelected(a):this.tabSelectedIndex(0)},rolloverTab:function(a){if(a&&this._currentTabItem!=a)a.className="hover"},rolloutTab:function(a){if(a&&this._currentTabItem!=a)a.className=
""},setCloseCallBack:function(a){this.closeCallBack=a},appendTab:function(a,c,d,e,f,h){var j=document.createElement("li");j.id=this._tabName+"TabTitle";j.onclick=function(a){return function(){a.tabSelected(this,!0)}}(this);j.onmouseover=function(a){return function(){a.rolloverTab(this)}}(this);j.onmouseout=function(a){return function(){a.rolloutTab(this)}}(this);j.ondblclick=function(a){return function(){a.removeTab(this)}}(this);j.className="on";j.title=a;j.innerHTML=d?"<a href='"+d+"' target='"+
e+"'>"+a+"</a>":"<a target='"+e+"'>"+a+"</a>";if(f)a=document.createElement("a"),a.style.cursor="pointer",h?(d=document.createElement("img"),d.src=h,d.style.width="8px",d.style.height="8px",a.appendChild(d)):a.innerHTML="&nbsp;&nbsp;<sup>X</sup>",a.onclick=function(a,c){return function(){a.removeTab(c)}}(this,j),j.appendChild(a);this.tabItemContainer.appendChild(j);h=document.createElement("div");h.id=this._tabName+"TabContent";h.style.display="block";h.innerHTML=c;this.tabItemContentContainer.appendChild(h);
this.tabSelected(j)},removeTab:function(a){for(var c=-1,d=this.tabItemContainer.childNodes,e=0;e<d.length;e++)if(d[e].id&&0<=d[e].id.indexOf("TabTitle")&&a==d[e]){c=d[e].index;this.tabItemContainer.removeChild(d[e]);break}if(-1!=c){d=this.tabItemContentContainer.childNodes;for(e=0;e<d.length;e++)if(d[e].id&&0<=d[e].id.indexOf("TabContent")&&d[e].index==c){this.tabItemContentContainer.removeChild(d[e]);break}this.closeCallBack&&this.closeCallBack(a.title);0<c&&this._currentTabItem==a?this.tabSelectedIndex(c-
1):this.tabSelected(this._currentTabItem)}}});var CoolTab=Micsun.UI.CoolTab;
Micsun.UI.BubbleTooltip=Micsun.Class({initialize:function(a,c,d){this.name=a;this.container=c;this.bubbleTooltip=null;Micsun.DOM.loaded?this.init(a,c,d):(a=function(a,c,d,j){return function(){a.init(c,d,j)}}(this,a,c,d),Micsun.DOM.addDOMReadyFunctions(a))},init:function(a,c,d){this.bubbleTooltip=document.createElement("DIV");this.bubbleTooltip.id=a+"bubble_tooltip";this.bubbleTooltip.className="bubbleTooltip";this.bubbleTop=document.createElement("DIV");this.bubbleTop.className="bubbleTop";this.bubbleTitle=
document.createElement("span");if(!Micsun.isUndefined(d)&&!0==d)this.bubbleCloseBtn=document.createElement("a"),this.bubbleCloseBtn.innerHTML="&nbsp;&nbsp;Close&nbsp;&nbsp;",this.bubbleCloseBtn.onclick=function(a){return function(){a.hideToolTip()}}(this),this.bubbleTitle.appendChild(this.bubbleCloseBtn);this.bubbleTop.appendChild(this.bubbleTitle);this.bubbleTooltip.appendChild(this.bubbleTop);this.bubbleMid=document.createElement("DIV");this.bubbleMid.className="bubbleMiddle";this.bubbleContent=
document.createElement("span");this.bubbleContent.id=a+"bubble_tooltip_content";this.bubbleMid.appendChild(this.bubbleContent);this.bubbleTooltip.appendChild(this.bubbleMid);this.bubbleBottom=document.createElement("DIV");this.bubbleBottom.className="bubbleBottom";this.bubbleTooltip.appendChild(this.bubbleBottom);c?c.appendChild(this.bubbleTooltip):document.body.appendChild(this.bubbleTooltip)},showToolTip:function(a,c,d){this.bubbleContent.innerHTML=c;this.bubbleTooltip.style.display="block";var e=
c=0;!Micsun.isUndefined(d)&&"byEvent"==d?(c=Micsun.DOM.getEventY(a),e=Micsun.DOM.getEventX(a)):(d=Micsun.DOM.getEventTarget(a),a=Micsun.DOM.getPagePoint(d),Micsun.DOM.getDimensionsByEl(d),c=a.y,e=a.x+20);this.bubbleTooltip.style.left=e-this.bubbleTooltip.offsetWidth+50+"px";this.bubbleTooltip.style.top=c-this.bubbleTooltip.offsetHeight+"px"},hideToolTip:function(){if(null!=this.bubbleTooltip)this.bubbleTooltip.style.display="none"}});var BubbleTooltip=Micsun.UI.BubbleTooltip;
Micsun.UI.TableView=Micsun.Class({initialize:function(a,c,d){this.tableId=a;this.colsDef=c;this.viewDef=d;this.onRowSelect=this.viewDef.onRowSelect;this.onColumnSelect=this.viewDef.onColumnSelect;this.onFilter=this.viewDef.onFilter;this.onPage=this.viewDef.onPage;this.OPERATIONS=[{logic:"like",logicName:"\u5305\u542b"}];Micsun.DOM.loaded?this.init():(a=function(a){return function(){a.init()}}(this),Micsun.DOM.addDOMReadyFunctions(a))},init:function(){this.container=document.getElementById(this.tableId);
if(!this.container)this.container=document.createElement("div"),this.container.id=this.tableId,this.container.style.display="none",document.body.appendChild(this.container);this.htmlTable=document.createElement("table");if(this.viewDef.width)this.htmlTable.style.width=this.viewDef.width;this.htmlTable.className=this.viewDef.tableClass?this.viewDef.tableClass:"tableView";this.header=document.createElement("thead");if(this.viewDef.enableFilter){this.filterRow=document.createElement("tr");this.filterCol=
document.createElement("th");this.filterCol.colSpan=""+this.colsDef.length+"";this.filterLabel=document.createElement("label");this.filterLabel.innerHTML="\u6761\u4ef6\uff1a";this.filterCol.appendChild(this.filterLabel);this.filterFieldSelect=document.createElement("select");for(var a=0;a<this.colsDef.length;a++){var c=this.colsDef[a];if(c&&c.enableFilter){var d=document.createElement("option");d.value=c.columnId;d.innerHTML=c.columnName;this.filterFieldSelect.appendChild(d)}}this.filterCol.appendChild(this.filterFieldSelect);
this.operationSelect=document.createElement("select");for(a=0;a<this.OPERATIONS.length;a++)c=this.OPERATIONS[a],d=document.createElement("option"),d.value=c.logic,d.innerHTML=c.logicName,this.operationSelect.appendChild(d);this.filterCol.appendChild(this.operationSelect);this.filterText=document.createElement("input");this.filterText.style.width="80px";this.filterCol.appendChild(this.filterText);this.filterBtn=document.createElement("input");this.filterBtn.type="button";this.filterBtn.value="\u8fc7\u6ee4";
this.filterBtn.onclick=function(a){return function(){a._filterClick()}}(this);this.filterCol.appendChild(this.filterBtn);this.filterRow.appendChild(this.filterCol);this.header.appendChild(this.filterRow)}d=document.createElement("tr");for(a=0;a<this.colsDef.length;a++){var c=this.colsDef[a],e=document.createElement("th");e.id=this.tableId+c.columnId;e.innerHTML=c.columnName;e.style.width=c.width;e.scope="col";if(!0==c.enableClick)e.onclick=function(a,c){return function(){a._headerClick(c)}}(this,
c);d.appendChild(e)}this.header.appendChild(d);this.htmlTable.appendChild(this.header);this.dataContainer=document.createElement("tbody");this.htmlTable.appendChild(this.dataContainer);if(this.viewDef.enablePaging)this.pageIndex=1,this.pageSize=this.viewDef.pageSize?this.viewDef.pageSize:10,this.maxButtons=this.viewDef.maxButtons?this.viewDef.maxButtons:10,this._pageCount=this.itemCount=0,this.footer=document.createElement("tfoot"),this.pageRow=document.createElement("tr"),this.pageCol=document.createElement("th"),
this.pageCol.colSpan=""+this.colsDef.length+"",this.pageCol.className="PagerView",this.pageRow.appendChild(this.pageCol),this.footer.appendChild(this.pageRow),this.htmlTable.appendChild(this.footer);this.container.appendChild(this.htmlTable)},bindData:function(a){this._reset();for(var c=0;c<a.length;c++){var d=a[c],e=document.createElement("tr");e.onclick=function(a,c){return function(){a._rowClick(c)}}(this,d);for(var f=0;f<this.colsDef.length;f++){var h=document.createElement("td"),j=d[""+this.colsDef[f].columnId];
if("undefined"!=j&&j)h.innerHTML=j;e.appendChild(h)}this.dataContainer.appendChild(e)}this.viewDef.enablePaging&&this._renderPage()},_rowClick:function(a){if(this.onRowSelect)this.onRowSelect(a)},_headerClick:function(a){if(this.onColumnSelect)this.onColumnSelect(a)},_filterClick:function(){if(this.onFilter)this.onFilter(this.filterFieldSelect.value,this.operationSelect.value,this.filterText.value)},_pageClick:function(a){this.pageIndex=a;if(this.onPage)this.onPage(a);this._renderPage()},_reset:function(){for(;0<
this.dataContainer.rows.length;)this.dataContainer.deleteRow(0)},_caculatePage:function(){this._pageCount=parseInt(Math.ceil(this.itemCount/this.pageSize));this.pageIndex=parseInt(this.pageIndex);if(this.pageIndex>this._pageCount)this.pageIndex=this._pageCount;if(1>this.pageIndex)this.pageIndex=1;this._startPage=Math.max(1,this.pageIndex-parseInt(this.maxButtons/2));this._endPage=Math.min(this._pageCount,this._startPage+this.maxButtons-1);this._startPage=Math.max(1,this._endPage-this.maxButtons+1)},
_renderPage:function(){this._caculatePage();var a="";1<this._pageCount&&(a=1!=this.pageIndex?a+'<a href="javascript://1"><span>|&lt;</span></a>'+('<a href="javascript://'+(this.pageIndex-1)+'"><span>&lt;&lt;</span></a>'):a+"<span>|&lt;</span><span>&lt;&lt;</span>");for(var c=this._startPage;c<=this._endPage;c++)a=c==this.pageIndex?a+('<span class="on">'+c+"</span>"):a+('<a href="javascript://'+c+'"><span>'+c+"</span></a>");1<this._pageCount&&(this.pageIndex!=this._pageCount?(a+='<a href="javascript://'+
(this.pageIndex+1)+'"><span>&gt;&gt;</span></a>',a+='<a href="javascript://'+this._pageCount+'"><span>&gt;|</span></a>'):a+="<span>&gt;&gt;</span><span>&gt;|</span>");a+=" \u603b\u8ba1:"+this._pageCount+" \u9875\u9762,"+this.itemCount+" \u8bb0\u5f55";this.pageCol.innerHTML=a;a=this.pageCol.getElementsByTagName("a");for(c=0;c<a.length;c++){var d=a[c];if(void 0!=d.href&&""!=d.href){var e=parseInt(d.href.replace("javascript://",""));d.onclick=function(a,c){return function(){a._pageClick(c)}}(this,e)}}}});
var TableView=Micsun.UI.TableView;
Micsun.UI.PopupWindow=Micsun.Class({initialize:function(a,c){this.popupWin=null;this.isInit=!1;this.oldPopupWin=null;this.showMySelf=!1;this.titleHeight=a;this.hasContent=!1;this.title="";this.title_height=a||30;this.autoHeight=!0;this.window_width=0;this.pop_height=this.pop_width=300;this.is_center=!1;this.basePos=c||0;this.originalDiv=null;this.replaceContainer=!1;if(Micsun.DOM.loaded)this.init();else{var d=function(a){return function(){a.init()}}(this);Micsun.DOM.addDOMReadyFunctions(d)}},init:function(){if(!this.isInit)this.isInit=
!0,this.blanket=document.createElement("div"),this.blanket.className="popupWinBlanket",this.blanket.style.height="0px",this.blanket.style.display="none",this.blanket.style.zIndex=90001,document.body?document.body.appendChild(this.blanket):alert("pupu window just supported in body"),this.popupTitle=document.createElement("div"),this.popupTitle.className="popupTitle",this.popupTitle.style.display="none",this.popupTitle.style.zIndex=90002,document.body?document.body.appendChild(this.popupTitle):alert("pupu window just supported in body"),
this.titleArea=document.createElement("div"),this.titleArea.className="popupTitleContent",this.popupTitle.appendChild(this.titleArea),this.titleClose=document.createElement("div"),this.titleClose.className="popupTitleClose",this.titleClose.innerHTML="X",this.popupTitle.appendChild(this.titleClose),this.popupWin=document.createElement("div"),this.popupTitle.style.display="none",document.body.appendChild(this.popupWin),this.oldPopupWin=this.popupWin},setContent:function(a,c,d,e,f,h,j){this.isInit||
this.init();this.replaceContainer=h;this.autoHeight=j;this.replaceContainer&&!0==this.replaceContainer?(this.originalDiv=document.getElementById(c),this.popupWin.innerHTML=this.originalDiv.innerHTML,this.originalDiv.innerHTML="",this.showMySelf=!1):(this.originalDiv=null,this.popupWin=document.getElementById(c),this.showMySelf=!0);this.hasContent=!0;this._reset(a,d,e,f)},setHtmlContent:function(a,c,d,e,f,h){this.isInit||this.init();this.autoHeight=h;this.originalDiv=null;this.showMySelf=!1;this.popupWin.innerHTML=
c;this.hasContent=!0;this._reset(a,d,e,f)},setIFrameContent:function(a,c,d,e,f,h){this.isInit||this.init();this.autoHeight=h;this.originalDiv=null;this.showMySelf=!1;this.popupWin.style.overflow="hidden";this.popupWin.innerHTML='<iframe src="'+c+'" style="border:0;margin:0; padding:0;width:'+e+"px; height: "+f+'px" name="_iframe"></iframe>';this.hasContent=!0;this._reset(a,d,e,f)},setAjaxContent:function(a,c,d,e,f,h){this.isInit||this.init();this.autoHeight=h;this.originalDiv=null;this.showMySelf=
!1;this.hasContent=!0;this.popupWin.innerHTML="<b>\u88c5\u8f7d\u4e2d...</b>";h=function(a){return function(c){a._setAjaxCotnet(c)}}(this);new Ajax.Request(c,{method:"post",asynchronous:!0,onComplete:h});this._reset(a,d,e,f)},_setAjaxCotnet:function(a){this.isInit||this.init();this.popupWin.innerHTML=a.responseText},setCenter:function(a){this.is_center=a?a:!1},show:function(a){this.isInit||this.init();this.hasContent&&(this._show(),this._positionBlanket(),this._positionWin(a))},close:function(){this.isInit||
this.init();if(this.hasContent){if(this.replaceContainer&&!0==this.replaceContainer){if(null!=this.originalDiv&&null!=this.popupWin)this.originalDiv.innerHTML=this.popupWin.innerHTML;this.popupWin.innerHTML=""}this.popupWin.style.display="none";this.popupTitle.style.display="none";this.blanket.style.display="none";if(!0==this.showMySelf)this.popupWin=this.oldPopupWin,this.showMySelf=!1}},_reset:function(a,c,d,e){this.isInit||this.init();this.title=a||this.title;this.pop_width=d||this.pop_width;this.pop_height=
e||this.pop_height;this.is_center=c;if(this.hasContent)this.popupWin.style.display="none",this.popupTitle.style.display="none",this.blanket.style.display="none"},_show:function(){this.popupWin.style.display="block";this.popupTitle.style.display="block";this.blanket.style.display="block"},_positionBlanket:function(){this.blanket.style.width=Micsun.DOM.getScrollWidth()+"px";this.blanket.style.height=Micsun.DOM.getScrollHeight()+"px"},_positionWin:function(a){var c=0,d=0;this.is_center&&!0==this.is_center?
(c=Micsun.DOM.getScrollLeft()+(Micsun.DOM.getClientWidth()-this.pop_width)/2,d=Micsun.DOM.getScrollTop()+(Micsun.DOM.getClientHeight()-this.pop_height)/2):(d=Micsun.DOM.getEventY(a),c=Micsun.DOM.getEventX(a),Micsun.DOM.getClientWidth(),Micsun.DOM.getClientHeight(),d+=10,c-=this.pop_width/3);d=this.basePos+d;0>d&&(d=20);this._showTitle(d,c,this.pop_width,this.title_height);d=this.title_height+d;this.popupWin.style.height=!this.autoHeight||!0==this.autoHeight?"auto":this.pop_height+"px";this.popupWin.style.width=
this.pop_width+"px";this.popupWin.style.position="absolute";this.popupWin.style.zIndex=90003;this.popupWin.style.left=c+"px";this.popupWin.style.top=d+"px";this.popupWin.className="popupWin"},_showTitle:function(a,c,d,e){this.popupTitle.style.height=e+"px";this.popupTitle.style.width=d+"px";this.popupTitle.style.position="absolute";this.popupTitle.style.zIndex=90002;this.popupTitle.style.left=c+"px";this.popupTitle.style.top=a+"px";this.popupTitle.className="popupWinTitle";this.titleArea.innerHTML=
this.title;this.titleClose.onclick=function(a){return function(){a.close()}}(this)}});var PopupWindow=Micsun.UI.PopupWindow;
Micsun.UI.TableChooser=Micsun.Class({initialize:function(a,c,d,e,f,h,j,k,l,m){this.containerId=a;this.colsDef=h;this.onRowSelect=j;this.viewTableDef={dataKey:"id",tableClass:"tableView",width:"480px",pageSize:5,maxButtons:5,enableFilter:!0,enablePaging:!0};if(k)this.viewTableDef.width=k+"px";if(l)this.viewTableDef.pageSize=l;if(m)this.viewTableDef.maxButtons=m;this.initFilterList=[];this.loadRequest=new LoadRequest;this.pageInfo=new PageInfo;this.si=new SortInfo;this.pageInfo.pageSize=this.viewTableDef.pageSize;
this.loadRequest.setPageInfo(this.pageInfo);this.loadRequest.setParameters(f);this.msgHandler=new MsgHandler;this.msgHandler.setWebContext(c);this.msgHandler.setMsgHandler(d);this.msgHandler.setOptType(e);this.msgHandler.setRequest(this.loadRequest);Micsun.DOM.loaded?this.init():(a=function(a){return function(){a.init()}}(this),Micsun.DOM.addDOMReadyFunctions(a))},init:function(){this.viewTableDef.onRowSelect=this.onRowSelect;this.viewTableDef.onColumnSelect=function(a){return function(c){a.onColumnSelect(c)}}(this);
this.viewTableDef.onFilter=function(a){return function(c,d,e){a.onFilter(c,d,e)}}(this);this.viewTableDef.onPage=function(a){return function(c){a.onPage(c)}}(this);this.msgHandler.setCallbackFun(function(a){return function(c){a.onLoad(c)}}(this));this.myTable=new TableView(this.containerId,this.colsDef,this.viewTableDef)},loadData:function(a){a&&this.msgHandler.sendMsg()},addFilterInfo:function(a){this.initFilterList.push(a)},resetFilter:function(){for(;0<this.initFilterList.length;)this.initFilterList.pop()},
onLoad:function(a){if(a.success)this.myTable.itemCount=a.pageInfo.totalRowNum,this.myTable.bindData(a.data)},refresh:function(a){this.loadRequest.setParameters(a);this.loadRequest.resetFilter();for(a=0;a<this.initFilterList.length;a++)this.loadRequest.addFilterInfo(this.initFilterList[a]);this.msgHandler.sendMsg()},onColumnSelect:function(a){this.si.columnId=a.columnId;this.si.sortOrder="asc"==this.si.sortOrder?"desc":"asc";this.si.fieldName=a.columnId;this.loadRequest.resetSort();this.loadRequest.addSortInfo(this.si);
this.loadData()},onFilter:function(a,c,d){var e=new FilterInfo;e.columnId=a;e.logic=c;e.fieldName=a;e.value=d;this.loadRequest.resetFilter();this.loadRequest.addFilterInfo(e);for(a=0;a<this.initFilterList.length;a++)this.loadRequest.addFilterInfo(this.initFilterList[a]);this.pageInfo.startRowNum=1;this.pageInfo.endRowNum=this.viewTableDef.pageSize+this.pageInfo.startRowNum;this.msgHandler.sendMsg()},onPage:function(a){this.pageInfo.startRowNum=this.pageInfo.pageSize*(a-1)+1;this.pageInfo.endRowNum=
this.pageInfo.startRowNum+this.viewTableDef.pageSize;this.pageInfo.pageSize=this.viewTableDef.pageSize;this.msgHandler.sendMsg()}});var TableChooser=Micsun.UI.TableChooser;
Micsun.UI.ImagePreLoader=Micsun.Class({initialize:function(a,c,d,e,f,h,j){this._name=a;this._callbackFunc=f;this._yourImages=e;this._length=c;this._height=d;this._backImage=h;this._frontImage=j;this.dots=[];this.preImages=[];this.currCount=this.coverage=0;this.loaded=[];this.leftOverWidth=0;if(document.images)this.dots[0]=new Image(1,1),this.dots[0].src=this._backImage,this.dots[1]=new Image(1,1),this.dots[1].src=this._frontImage,this.coverage=Math.floor(this._length/this._yourImages.length),this.leftOverWidth=
this._length%this.coverage},loadImages:function(){for(var a=0;a<this._yourImages.length;a++)this.preImages[a]=new Image,this.preImages[a].src=this._yourImages[a];for(a=0;a<this.preImages.length;a++)this.loaded[a]=!1;this.checkLoad()},checkLoad:function(){if(this.currCount==this.preImages.length)this._callbackFunc();else{for(var a=0;a<=this.preImages.length;a++)!1==this.loaded[a]&&this.preImages[a].complete&&(this.loaded[a]=!0,eval("document.img"+this.currCount+".src="+this._name+".dots[1].src"),this.currCount++);
this.timerID=setTimeout(this._name+".checkLoad()",10)}},preloader:function(){if(document.images){for(var a="",c=0;c<this._yourImages.length-1;c++)a+='<img src="'+this.dots[0].src+'" width="'+this.coverage+'" height="'+this._height+'" name="img'+c+'" align="absmiddle">';a+='<img src="'+this.dots[0].src+'" width="'+(this.leftOverWidth+this.coverage)+'" height="'+this._height+'" name="img'+(this._yourImages.length-1)+'" align="absmiddle">';document.write(a);this.loadImages()}}});
Micsun.UI.Pagination=Micsun.Class({initialize:function(a,c,d,e,f){this.pageIndex=1;this.pageSize=d||20;this.maxButtons=e||10;this.itemCount=c;this._pageCount=0;this.showGoPage=this.showTotalRecord=this.showTotalPage=this.showNextAndPre=this.showFirstAndLastLink=!0;this.callbackFunc=f;this.pageContainerId=a},setTotalCount:function(a){this.itemCount=a},_caculatePage:function(){this._pageCount=parseInt(Math.ceil(this.itemCount/this.pageSize));this.pageIndex=parseInt(this.pageIndex);if(this.pageIndex>
this._pageCount)this.pageIndex=this._pageCount;if(1>this.pageIndex)this.pageIndex=1;this._startPage=Math.max(1,this.pageIndex-parseInt(this.maxButtons/2));this._endPage=Math.min(this._pageCount,this._startPage+this.maxButtons-1);this._startPage=Math.max(1,this._endPage-this.maxButtons+1)},renderPage:function(){this._caculatePage();var a="";1<this._pageCount&&(1!=this.pageIndex?(!0==this.showFirstAndLastLink&&(a+='<a href="javascript://1"><span>\u9996\u9875</span></a>&nbsp;&nbsp;'),!0==this.showNextAndPre&&
(a+='<a href="javascript://'+(this.pageIndex-1)+'"><span>\u4e0a\u4e00\u9875</span></a>')):(!0==this.showFirstAndLastLink&&(a+="<span>\u9996\u9875</span>&nbsp;&nbsp;"),!0==this.showNextAndPre&&(a+="<span>\u4e0a\u4e00\u9875</span>")),a+="&nbsp;&nbsp;");for(var c=this._startPage;c<=this._endPage;c++)a=c==this.pageIndex?a+('<span class="on">'+c+"</span>"):a+('<a href="javascript://'+c+'"><span>'+c+"</span></a>"),a+="&nbsp;&nbsp;";1<this._pageCount&&(this.pageIndex!=this._pageCount?(!0==this.showNextAndPre&&
(a+='<a href="javascript://'+(this.pageIndex+1)+'"><span>\u4e0b\u4e00\u9875</span></a>',a+="&nbsp;&nbsp;"),!0==this.showFirstAndLastLink&&(a+='<a href="javascript://'+this._pageCount+'"><span>\u5c3e\u9875</span></a>')):(!0==this.showNextAndPre&&(a+="<span>\u4e0b\u4e00\u9875</span>&nbsp;&nbsp;"),!0==this.showFirstAndLastLink&&(a+="<span>\u5c3e\u9875</span>")),a+="&nbsp;&nbsp;");!0==this.showTotalPage&&(a+=" \u5171"+this._pageCount+"\u9875&nbsp;&nbsp;");!0==this.showTotalRecord&&(a+=""+this.itemCount+
"\u8bb0\u5f55 ");!0==this.showGoPage&&(a+=' \u53bb\u7b2c<input id="'+this.pageContainerId+'_pageId" style="width:30px" value="'+this.pageIndex+'">\u9875&nbsp;&nbsp;',a+='<input type=button id="'+this.pageContainerId+'_pageBtn" style="width:30px;padding-left:1px;padding-top:2px" value="\u786e\u5b9a">');M$(this.pageContainerId).innerHTML=a;a=M$(this.pageContainerId).getElementsByTagName("a");for(c=0;c<a.length;c++){var d=a[c];if(void 0!=d.href&&""!=d.href){var e=parseInt(d.href.replace("javascript://",
""));d.onclick=function(a,c){return function(){a.callbackFunc(c);a.pageIndex=c;a.renderPage();M$(f).value=c}}(this,e)}}if(!0==this.showGoPage){var f=this.pageContainerId+"_pageId";M$(this.pageContainerId+"_pageBtn").onclick=function(a,c){return function(){var d=M$(c).value;a.callbackFunc(d);a.pageIndex=d;a.renderPage()}}(this,f);M$(f).onkeydown=function(a,c){return function(d){d=Micsun.event(d);if(d.keyCode==Micsun.Event.KEY_RETURN)d=M$(c).value,a.callbackFunc(d),a.pageIndex=d,a.renderPage()}}(this,
f)}}});Micsun.UI.winMinZIndex=1E3;Micsun.UI.currentWinIndex=1E3;
Micsun.UI.Windows=Micsun.Class({initialize:function(a,c){this.themeClass=c;this.minimizeOrder=0;this.attr=null;this.zOldIndexValue=this.zIndexValue=Micsun.UI.currentWinIndex++;this.winId=a;if(Micsun.DOM.loaded)this.init();else{var d=function(a){return function(){a.init()}}(this);Micsun.DOM.addDOMReadyFunctions(d)}},init:function(){this.win=document.createElement("div");this.win.id=this.winId;this.win.className=this.themeClass+"Window";var a='<div id="'+this.winId+'_handle" class="'+this.themeClass+
'Handle">',a=a+('micsun<div  id="'+this.winId+'_controls"  class="'+this.themeClass+'Controls"><div  id="'+this.winId+'_close"  class="'+this.themeClass+'Close" >&nbsp</div><div id="'+this.winId+'_min" class="'+this.themeClass+'Min" >&nbsp</div></div>'),a=a+"</div>"+('<div id="'+this.winId+'_contentArea" class="'+this.themeClass+'ContentArea"></div>'),a=a+('<div id="'+this.winId+'_statusArea" class="'+this.themeClass+'StatusArea"><div <div id="'+this.winId+'_resizeArea"  class="'+this.themeClass+
'ResizeArea" >&nbsp;</div></div>');this.win.innerHTML=a+"</div>";this.win.style.display="none";document.body.appendChild(this.win);this.win.handle=M$(this.winId+"_handle");this.win.resizeArea=M$(this.winId+"_resizeArea");this.win.controls=M$(this.winId+"_controls");this.win.statusArea=M$(this.winId+"_statusArea");this.win.contentArea=M$(this.winId+"_contentArea");this.win.controlsMin=M$(this.winId+"_min");this.win.controlsClose=M$(this.winId+"_close");this.win.handle._parent=this.win;this.win.resizeArea._parent=
this.win;this.win.controls._parent=this.win;this.win.onClose=function(){return!0};this.win.onmousedown=function(a){return function(){a.setFocus()}}(this);this.win.handle.onmousedown=function(a){return function(d){a.beginDrag(d,this)}}(this);this.win.resizeArea.onmousedown=function(a){return function(d){a.beginDrag(d,this)}}(this);this.win.controlsMin.onclick=function(a){return function(){a.switchMin()}}(this);this.win.controlsClose.onclick=function(a){return function(){a.close()}}(this);this.win.show=
function(a){return function(){a.show()}}(this);this.win.hide=function(a){return function(){a.hide()}}(this);this.win.enableMin=function(a){return function(d){a.enableMin(d)}}(this);this.win.close=function(a){return function(){a.close()}}(this);this.win.setSize=function(a){return function(d,e){a.setSize(d,e)}}(this);this.win.moveTo=function(a){return function(d,e){a.moveTo(d,e)}}(this);this.win.enableResize=function(a){return function(d){a.enableResize(d)}}(this);this.win.enableMove=function(a){return function(d){a.enableMove(d)}}(this);
this.win.enableScrolling=function(a){return function(d){a.enableScrolling(d)}}(this);this.win.load=function(a){return function(d,e,f){a.load(d,e,f)}}(this)},open:function(a,c,d,e){if(this.win){this.attr=e;this.setFocus();this.win.setSize(this.getAttrValue("width",this.attr),this.getAttrValue("height",this.attr));var e=this.getAttrValue("center",this.attr)?"middle":this.getAttrValue("left",this.attr),f=this.getAttrValue("center",this.attr)?"middle":this.getAttrValue("top",this.attr);this.win.enableResize(this.getAttrValue("resize",
this.attr));this.win.enableMin(this.getAttrValue("min",this.attr));this.win.enableMove(this.getAttrValue("move",this.attr));this.win.enableScrolling(this.getAttrValue("scrolling",this.attr));this.win.style.visibility="visible";this.win.style.display="block";this.win.contentArea.style.display="block";this.win.moveTo(e,f);this.win.load(a,c,d);if("minimized"==this.win.state&&"Restore"==this.win.controls.firstChild.title)Micsun.UTILS.removeClass(this.win.controlsMin,this.themeClass+"Restore"),Micsun.UTILS.addClass(this.win.controlsMin,
this.themeClass+"Min"),this.win.state="fullview"}},getAttrValue:function(a,c){return RegExp(a+"=([^,]+)","i").test(c)?parseInt(RegExp.$1):0},setSize:function(a,c){this.win.style.width=Math.max(parseInt(a),150)+"px";this.win.contentArea.style.height=Math.max(parseInt(c),100)+"px"},moveTo:function(a,c){this.win.style.left="middle"==a?Micsun.DOM.getScrollLeft()+(Micsun.DOM.getClientWidth()-this.win.offsetWidth)/2+"px":"left"==a?"0px":"right"==a?Micsun.DOM.getScrollLeft()+(Micsun.DOM.getClientWidth()-
this.win.offsetWidth)+"px":Micsun.DOM.getScrollLeft()+parseInt(a)+"px";this.win.style.top="middle"==c?Micsun.DOM.getScrollTop()+(Micsun.DOM.getClientHeight()-this.win.offsetHeight)/2+"px":"top"==c?"0px":"bottom"==c?Micsun.DOM.getScrollTop()+(Micsun.DOM.getClientHeight()-this.win.offsetHeight)+"px":Micsun.DOM.getScrollTop()+parseInt(c)+"px"},center:function(){this.moveTo("middle","middle")},enableMin:function(a){this.win.controlsMin.style.display=a?"block":"none";this.win.minimeBool=a?1:0},enableResize:function(a){this.win.statusArea.style.display=
a?"block":"none";this.win.resizeBool=a?1:0},enableMove:function(a){this.win.moveBool=a?1:0},enableScrolling:function(a){this.win.contentArea.style.overflow=a?"auto":"hidden"},load:function(a,c,d){a=a.toLowerCase();if("undefined"!=typeof d)this.win.handle.firstChild.nodeValue=d;if("inline"==a)this.win.contentArea.innerHTML=c;else if("div"==a){c=document.getElementById(c);this.win.contentArea.innerHTML=c.defaultHTML||c.innerHTML;if(!c.defaultHTML)c.defaultHTML=c.innerHTML;c.innerHTML="";c.style.display=
"none"}else"iframe"==a?(this.win.contentArea.style.overflow="hidden",c='<iframe src="'+c+'" ',0>=this.getAttrValue("frame_scrolling",this.attr)&&(c+=' scrolling="no" '),c+=' style="border:0;margin:0; padding:0; width:100%; height: 100%;" name="_iframe-'+this.win.id+'"></iframe>',this.win.contentArea.innerHTML=c):"ajax"==a&&this.ajaxLoad(c,this.win);this.win.contentArea.dataType=a;this.setFocus()},beginDrag:function(a,c){this.eTarget=c;a=window.event||a;this.initMouseX=Micsun.DOM.getEventX(a);this.initMouseY=
Micsun.DOM.getEventY(a);this.initx=parseInt(this.win.offsetLeft);this.inity=parseInt(this.win.offsetTop);this.width=parseInt(this.win.offsetWidth);this.contentHeight=parseInt(this.win.contentArea.offsetHeight);if("iframe"==this.win.contentArea.dataType)this.win.style.backgroundColor="#F8F8F8",this.win.contentArea.style.visibility="hidden";document.onmousemove=function(a){return function(c){a.getDistance(c)}}(this);document.onmouseup=function(a){return function(){if("iframe"==a.win.contentArea.dataType)a.win.contentArea.style.backgroundColor=
"white",a.win.contentArea.style.visibility="visible";a.stopDrag()}}(this);return!1},stopDrag:function(){this.eTarget=null;document.onmousemove=null;document.onmouseup=null},getDistance:function(a){var c=this.eTarget;this.distancex=Micsun.DOM.getEventX(a)-this.initMouseX;this.distancey=Micsun.DOM.getEventY(a)-this.initMouseY;if(c==this.win.handle&&this.win.moveBool)this.onMove(a);else if(c==this.win.resizeArea)this.onResize(a);return!1},storeAttributes:function(){this.win.lastx=parseInt(this.win.style.left||
this.win.offsetLeft)-Micsun.DOM.getScrollLeft();this.win.lasty=parseInt(this.win.style.top||this.win.offsetTop)-Micsun.DOM.getScrollTop();this.win.lastwidth=parseInt(this.win.style.width)},onMove:function(){this.win.style.left=this.distancex+this.initx+"px";this.win.style.top=this.distancey+this.inity+"px"},onResize:function(){this.win.style.width=Math.max(this.width+this.distancex,150)+"px";this.win.contentArea.style.height=Math.max(this.contentHeight+this.distancey,100)+"px"},switchMin:function(){if("minimized"==
this.win.state)this.onRestore();else this.onMinimize();return!1},onMinimize:function(){this.storeAttributes();Micsun.UTILS.removeClass(this.win.controlsMin,this.themeClass+"Min");Micsun.UTILS.addClass(this.win.controlsMin,this.themeClass+"Restore");this.win.state="minimized";this.win.contentArea.style.display="none";this.win.statusArea.style.display="none";if("undefined"==typeof this.win.minimizeOrder)this.minimizeOrder++,this.win.minimizeOrder=this.minimizeOrder;this.win.style.left="10px";this.win.style.width=
"200px";var a=10*this.win.minimizeOrder;this.win.style.top=Micsun.DOM.getScrollTop()+Micsun.DOM.getClientHeight()-this.win.handle.offsetHeight*this.win.minimizeOrder-a+"px"},onRestore:function(){Micsun.UTILS.removeClass(this.win.controlsMin,this.themeClass+"Restore");Micsun.UTILS.addClass(this.win.controlsMin,this.themeClass+"Min");this.win.state="fullview";this.win.style.display="block";this.win.contentArea.style.display="block";if(this.win.resizeBool)this.win.statusArea.style.display="block";if(this.win.minimeBool)this.win.controlsMin.style.display=
"block";this.win.style.left=parseInt(this.win.lastx)+Micsun.DOM.getScrollLeft()+"px";this.win.style.top=parseInt(this.win.lasty)+Micsun.DOM.getScrollTop()+"px";this.win.style.width=parseInt(this.win.lastwidth)+"px"},close:function(){this.win.contentArea.innerHTML="";this.hide()},setFocus:function(){this.win.style.zIndex=this.zIndexValue;this.win.style.display="block"},setTopWindow:function(){this.win.style.zIndex=Micsun.UI.currentWinIndex},setOrgWindow:function(){this.win.style.zIndex=this.zOldIndexValue},
show:function(){this.win.lastx&&this.restore();this.setFocus();this.win.state="fullview"},hide:function(){this.win.style.display="none"},ajaxLoad:function(a){this.win.contentArea.innerHTML="<b>Loading...</b>";var c=function(a){return function(c){a.setAjaxCotnet(c)}}(this);new Ajax.Request(a,{method:"post",asynchronous:!0,onComplete:c})},setAjaxCotnet:function(a){this.win.contentArea.innerHTML=a.responseText},addEvent:function(a,c,d){d=window.addEventListener?d:"on"+d;a.addEventListener?a.addEventListener(d,
c,!1):a.attachEvent&&a.attachEvent(d,c)}});
Micsun.UI.AutoComplete=Micsun.Class({initialize:function(a,c,d,e,f,h,j,k,l,m){this.controlId=this.id=a;this.parentDivId=c||null;this.dataArray=[];this.selectedIndex=-1;this.intervalId=0;this.onChangeInterval=this.instanceId=null;this.keyName=j;this.valueName=k;this.defaultValues=m;this.addedIndex=-1E4;this.msgHandler=new MsgHandler;this.msgHandler.setWebContext(d);this.msgHandler.setMsgHandler(e);this.msgHandler.setOptType(f);this.msgHandler.setParam(h);this.params=h||{};this.options={minChars:0,
maxHeight:300,requestDelay:0,width:0,isMultiSelect:!0,isAllowAdd:!1};Micsun.extend(this.options,l);Micsun.DOM.loaded?this.init():(a=function(a){return function(){a.init()}}(this),Micsun.DOM.addDOMReadyFunctions(a))},init:function(){if(this.parentDivId)this.parentContainer=$(this.parentDivId);var a='<div id="au_con_'+this.controlId+'" class="auto_container"><div id="au_con_dis_'+this.controlId+'" class="auto_display_area"></div><div class="auto_display_area"><input name="'+this.controlId+'" id="'+
this.controlId+'" type="hidden"><input id="au_input_'+this.controlId+'" name="_input_'+this.controlId+'" type="text"><input name="_new_'+this.controlId+'" id="_new_'+this.controlId+'" type="hidden"><div></div>';if(!this.parentContainer)this.parentContainer=document.createElement("div"),this.parentContainer.id="_au_par_con_"+this.controlId,document.body.appendChild(this.parentContainer);this.parentContainer.innerHTML=a;this.textField=$("au_input_"+this.controlId);this.textField.setAttribute("autocomplete",
"off");if(!this.options.width)this.options.width=Micsun.DOM.getDimensionsByEl(this.textField).width;this.valueField=$(this.controlId);this.displayText=$("au_con_dis_"+this.controlId);this.newText=$("_new_"+this.controlId);this.popContainerId="au_con_pop"+this.controlId;a=document.createElement("div");a.id=this.popContainerId;a.style.position="absolute";a.innerHTML='<div class="auto_popup-w1"><div class="auto_popup-w2"><div class="auto_popup" id="au_item_con_'+this.controlId+'" style="display:none; width:'+
this.options.width+'px;"></div></div></div>';document.body.appendChild(a);this.itemContainer=$("au_item_con_"+this.controlId);this.adjustPos();Micsun.isOpera?this.textField.onkeypress=function(a){return function(d){a.onKeyPress(d)}}(this):this.textField.onkeydown=function(a){return function(d){a.onKeyPress(d)}}(this);this.textField.onblur=function(a){return function(d){a.onBlur(d)}}(this);this.textField.onkeyup=function(a){return function(d){a.onKeyUp(d)}}(this);this.textField.onfocus=function(a){return function(d){a.onFocus(d)}}(this);
Micsun.DOM.setStyle(this.itemContainer.id,"maxHeight:"+this.options.maxHeight+"px");this.msgHandler.setCallbackFun(function(a){return function(d){a.onLoadData(d)}}(this));this.loadDefaultValues()},highlight:function(a,c){return a.replace(c,function(a){return"<strong>"+a+"</strong>"})},adjustPos:function(){var a=Micsun.DOM.getPagePoint(this.textField);Micsun.DOM.setStyle(this.popContainerId,"top:"+(a.y+Micsun.DOM.getDimensionsByEl(this.textField).height+5)+"px; left:"+a.x+"px")},onFocus:function(){this.onBeginLoadOptions();
this.adjustPos()},onKeyPress:function(a){var a=Micsun.event(a),c;c=Micsun.isNetscape?a.which:a.keyCode;switch(c){case Micsun.Event.KEY_ESC:this.hide();break;case Micsun.Event.KEY_TAB:case Micsun.Event.KEY_RETURN:if(-1===this.selectedIndex){this.hide();this.options.isAllowAdd&&this.addNewItem(this.textField.value);return}this.selectIndex(this.selectedIndex);if(c===Micsun.Event.KEY_TAB)return;break;case Micsun.Event.KEY_UP:this.moveUp();break;case Micsun.Event.KEY_DOWN:this.moveDown();break;default:return}Micsun.Event.stop(a)},
onKeyUp:function(a){a=Micsun.event(a);switch(Micsun.isNetscape?a.which:a.keyCode){case Micsun.Event.KEY_UP:case Micsun.Event.KEY_DOWN:return}this.onBeginLoadOptions()},onBlur:function(){(1==this.dataArray.length||this.textField.value==this.dataArray[0][this.valueName])&&this.adjustScroll(0);this.closePopupTimer()},onBeginLoadOptions:function(){clearInterval(this.onChangeInterval);if(0<this.options.requestDelay){var a=function(a){return function(){a.onValueChange()}}(this);this.onChangeInterval=setInterval(a,
this.options.requestDelay)}else this.onValueChange()},onValueChange:function(){clearInterval(this.onChangeInterval);this.selectedIndex=0;if((null==this.textField.value||""==this.textField.value)&&!this.options.isMultiSelect)this.valueField.value="";null!=this.textField.value&&this.textField.value.length<this.options.minChars?this.hide():this.loadData()},loadData:function(){this.params[this.valueName]=this.textField.value;this.msgHandler.setParam(this.params);this.msgHandler.sendMsg()},onLoadData:function(a){if(a.success)if(null!=
this.params.defaultValues&&""!=this.params.defaultValues){for(var c=0;c<a.data.length;c++)this.addDisplayItem(a.data[c][this.keyName],a.data[c][this.valueName]);this.params.defaultValues=""}else this.dataArray=a.data,this.renderPopup()},closePopupTimer:function(){this.clearCloseTimer();var a=function(a){return function(){a.hide();a.clearCloseTimer()}}(this);this.intervalId=window.setInterval(a,500)},clearCloseTimer:function(){window.clearInterval(this.intervalId)},hide:function(){this.selectedIndex=
-1;this.itemContainer.style.display="none"},renderPopup:function(){if(0===this.dataArray.length)this.hide();else{this.selectedIndex=0;var a=this,c=this.itemContainer.innerHTML="";this.textField.value&&(c=RegExp("\\b"+this.textField.value.match(/[\w\u4e00-\u9fa5]+/g).join("|\\b"),"gi"));var d;Micsun.each(this.dataArray,function(e,f){d=document.createElement("div");if(this.selectedIndex===f)d.className="selected";a.itemContainer.appendChild(d);d.innerHTML=a.highlight(e[a.valueName],c);d.onclick=function(a,
c){return function(){a.selectIndex(c)}}(a,f);d.onmouseover=function(a,c){return function(){a.activate(c)}}(a,f)});this.itemContainer.style.display="block"}},activate:function(a){if(-1===this.selectedIndex)return null;var c=this.itemContainer.childNodes,d;if(c.length>this.selectedIndex)c[this.selectedIndex].className="";this.selectedIndex=a;if(c.length>this.selectedIndex)d=c[this.selectedIndex],d.className="selected";return d},selectIndex:function(a){var c=this.dataArray[a][this.valueName];if(c)this.textField.value=
c,this.hide(),this.onSelect(a)},addNewItem:function(a){var c=this.addedIndex++;this.addDisplayItem(c,a);this.newText.value=this.newText.value&&0<this.newText.value.length?this.newText.value+(","+c+":"+a):c+":"+a},getNewItems:function(){return this.newText.value},moveUp:function(){0>=this.dataArray.length||0===this.selectedIndex||this.adjustScroll(this.selectedIndex-1)},moveDown:function(){0>=this.dataArray.length||this.selectedIndex===this.dataArray.length-1||this.adjustScroll(this.selectedIndex+
1)},adjustScroll:function(a){var c=this.itemContainer,d=this.activate(a).offsetTop,e=c.scrollTop,f=e+this.options.maxHeight-25;if(d<e)c.scrollTop=d;else if(d>f)c.scrollTop=d-this.options.maxHeight+25;this.textField.value=this.dataArray[a][this.valueName];if(!this.options.isMultiSelect)this.valueField.value=this.dataArray[a][this.keyName]},removeItem:function(a,c){this.displayText.removeChild(a);var d=this.valueField.value;if(d){for(var e=d.split(","),d=0;d<e.length;d++)if(e[d]==c){e.splice(d,1);break}this.valueField.value=
e.toString()}if(d=this.newText.value){e=d.split(",");for(d=0;d<e.length;d++)if(e[d].split(":")[0]==c){e.splice(d,1);break}this.newText.value=e.toString()}},onSelect:function(a){var a=this.dataArray[a],c=a[this.keyName],d=a[this.valueName];if(this.options.onSelect)this.options.onSelect(a);if(a=this.valueField.value)for(var e=a.split(","),a=0;a<e.length;a++)if(e[a]==c)return;this.addDisplayItem(c,d)},addDisplayItem:function(a,c){this.valueField.value=this.valueField.value&&0<this.valueField.value.length&&
this.options.isMultiSelect?this.valueField.value+(","+a):a;if(this.options.isMultiSelect){var d=document.createElement("div");d.id="au_item_"+this.controlId+"_"+a;d.innerHTML=c;this.displayText.appendChild(d);var e=document.createElement("a");e.innerHTML="<span>&nbsp;<sup><font color=red>x</font></sup>&nbsp;</span>";d.appendChild(e);e.onclick=function(a,c,d){return function(){a.removeItem(c,d)}}(this,d,a);this.textField.value=""}else this.textField.value=c},loadDefaultValues:function(){if(null!=this.defaultValues&&
""!=this.defaultValues)this.params.defaultValues=this.defaultValues,this.msgHandler.setParam(this.params),this.msgHandler.sendMsg()}});
Micsun.UI.CoolTree=Micsun.Class({initialize:function(a,c,d,e){this.idSwitchIconPrex="_icon";this.idJoinPrex="_join";this.idSelectAreaPrex="_selection";this.idChildPrefix="_child";this.theme=e||"micsun";this._containerObj=Micsun.$(c);this._name=a;this.config={folderLinks:!0,useCookies:!0,useStatusText:!1,closeSameLevel:!1,useIcons:!1};this.icon={root:"rootIcon",folder:"folderIcon",folderOpen:"folderopenIcon",node:"nodeIcon",empty:"emptyIcon",line:"lineIcon",join:"joinIcon",plus:" plusIcon",minus:"minusIcon"};
this.nodeArray=d;this.aIndent=[];this.userData=[];this.root={id:-1};this.selectedIndex=null;this.completed=this.selectedFound=!1;this.webPath=".";this.initTreeRoot()},initTreeRoot:function(){this.treeObj=document.createElement("DIV");this.treeObj.className=this.theme+"Tree";this.treeObj.id=this._name+"_tree";var a;a=""+this.buildNextItem(this.root);this.treeObj.innerHTML=a;this._containerObj.appendChild(this.treeObj);this.initEvents();if(!this.selectedFound)this.selectedIndex=null;this.completed=
!0;return a},initEvents:function(){},setTreeItem:function(a,c,d,e,f,h,j,k){this.nodeArray[this.nodeArray.length]={id:a,pid:c,name:d,url:e,title:f,target:h,icon:j,iconOpen:k}},onSelect:function(a){try{this.onSelect=a}catch(c){}},openAll:function(a){for(var c=0;c<this.nodeArray.length;c++)if(this.nodeArray[c].hasChild&&this.nodeArray[c].pid!=this.root.id)this.switchOpenOrClose(a,c,this.nodeArray[c].isLastSelected),this.nodeArray[c].isOpen=a},buildNextItem:function(a){for(var c="",d=0;d<this.nodeArray.length;d++)if(this.nodeArray[d].pid==
a.id){var e=this.nodeArray[d];e.parentItem=a;e.currentIndex=d;this.initChildInfo(e);if(!this.config.folderLinks&&e.hasChild)e.url=null;if(e.id==this.selectedIndex&&!this.selectedFound)e.isSelected=!0,this.selectedIndex=d,this.selectedFound=!0;c+=this.buildTreeItem(e,d);if(e.isLastSelected)break}return c},buildTreeItem:function(a,c){var d="",d=!a.icon&&a.hasChild&&this.root.id!=a.pid?d+('<div class="'+this.theme+'TreeFolder">'+this.buildTreeICON(a,c)):d+('<div class="'+this.theme+'TreeNode">'+this.buildTreeICON(a,
c));if(this.config.useIcons){if(!a.icon)a.icon=this.root.id==a.pid?this.icon.root:a.hasChild?this.icon.folder:this.icon.node;if(!a.iconOpen)a.iconOpen=a.hasChild?this.icon.folderOpen:this.icon.node;if(this.root.id==a.pid)a.icon=this.icon.root,a.iconOpen=this.icon.root;d+='<span id="'+this.idSwitchIconPrex+this._name+c+'" class="'+(a.isOpen?a.iconOpen:a.icon)+'" alt="" >&nbsp;</span>'}if(this.onSelect||a.url)d+='<a id="'+this.idSelectAreaPrex+this._name+c+'" class="'+(a.isSelected?"nodeSel":"node")+
'" ',a.title&&(d+=' title="'+a.title+'"'),this.config.useStatusText&&(d+=" onmouseover=\"window.status='"+a.title+"';return true;\" onmouseout=\"window.status='';return true;\" "),d+=' href="javascript: '+this._name+".selectItem("+c+');"',d=d+' target="_self">'+a.name,d+="</a>";else if((!this.config.folderLinks||!a.url)&&a.hasChild&&a.pid!=this.root.id)d+='<a href="javascript: '+this._name+".expandTreeItem("+c+');" class="node">',d+=a.name,d+="</a>";d+="</div>";a.hasChild&&(d+='<div id="'+this.idChildPrefix+
this._name+c+'" class="clip" style="display:'+(this.root.id==a.pid||a.isOpen?"block":"none")+';">',d+=this.buildNextItem(a),d+="</div>");this.aIndent.pop();return d},buildTreeICON:function(a,c){for(var d="",e=0;e<this.aIndent.length;e++)d+='<span  class="'+this.icon.empty+'" alt="" >&nbsp;</span>';a.isLastSelected?this.aIndent.push(0):this.aIndent.push(1);a.hasChild?(d+='<a href="javascript: '+this._name+".expandTreeItem("+c+');"><span id="'+this.idJoinPrex+this._name+c+'" class="',d+=a.isOpen?this.icon.minus:
this.icon.plus,d+='" alt="" >&nbsp;</span></a>'):d+='<span  class="'+(this.config.useLines?a.isLastSelected?this.icon.joinBottom:this.icon.join:this.icon.empty)+'" alt="" >&nbsp;</span>';return d},initChildInfo:function(a){for(var c,d=0;d<this.nodeArray.length;d++){if(this.nodeArray[d].pid==a.id)a.hasChild=!0;if(this.nodeArray[d].pid==a.pid)c=this.nodeArray[d].id}if(c==a.id)a.isLastSelected=!0},openTo:function(a,c){var d=this.nodeArray[a];if(d.pid!=this.root.id&&d.parentItem){d.isOpen=!0;d.isSelected=
c;this.completed&&d.hasChild&&this.switchOpenOrClose(!0,d.currentIndex,d.isLastSelected);if(this.completed&&c)this.selectItem(d.currentIndex);else if(c)this.selectedIndex=d.currentIndex;this.openTo(d.parentItem.currentIndex)}},openLevel:function(a,c){for(var d=0;d<this.nodeArray.length;d++)if(this.nodeArray[d].id==a){this.openTo(d,c);break}},closeLevel:function(a){for(var c=0;c<this.nodeArray.length;c++)if(this.nodeArray[c].pid==a&&this.nodeArray[c].hasChild)this.switchOpenOrClose(!1,c,this.nodeArray[c].isLastSelected),
this.nodeArray[c].isOpen=!1,this.closeAllChildren(this.nodeArray[c].id)},closeAllChildren:function(a){for(var c=0;c<this.nodeArray.length;c++)if(this.nodeArray[c].pid==a&&this.nodeArray[c].hasChild)this.nodeArray[c].isOpen&&this.switchOpenOrClose(!1,c,this.nodeArray[c].isLastSelected),this.nodeArray[c].isOpen=!1,this.closeAllChildren(this.nodeArray[c].id)},switchOpenOrClose:function(a,c){this.config.useIcons&&(eIcon=M$(this.idSwitchIconPrex+this._name+c),Micsun.DOM.removeClass(eIcon,!a?this.nodeArray[c].iconOpen:
this.nodeArray[c].icon),Micsun.DOM.addClass(eIcon,a?this.nodeArray[c].iconOpen:this.nodeArray[c].icon));eJoin=M$(this.idJoinPrex+this._name+c);Micsun.DOM.removeClass(eJoin,!a?this.icon.minus:this.icon.plus);Micsun.DOM.addClass(eJoin,a?this.icon.minus:this.icon.plus);eDiv=M$(this.idChildPrefix+this._name+c);eDiv.style.display=a?"block":"none"},selectItem:function(a){var c=this.nodeArray[a];if(!c.hasChild||this.config.folderLinks){if(this.selectedIndex!=a){if(this.selectedIndex||0==this.selectedIndex)eOld=
M$(this.idSelectAreaPrex+this._name+this.selectedIndex),eOld.className="node";M$(this.idSelectAreaPrex+this._name+a).className="nodeSel";this.selectedIndex=a}if(this.onSelect)this.onSelect(c)}},expandTreeItem:function(a){var c=this.nodeArray[a];this.switchOpenOrClose(!c.isOpen,a,c.isLastSelected);c.isOpen=!c.isOpen;this.config.closeSameLevel&&this.closeLevel(c.id)}});var CoolTree=Micsun.UI.CoolTree,AJAX_REQUEST_OK=200,_global_var={warningColor:"red",completeColor:"#000000",notCompleteColor:"#f40202"};Micsun||alert("The following script will work with micsun.base.js!");Micsun.Controls={};
Micsun.Controls.RateVote=Micsun.Class({initialize:function(a,c,d,e,f,h,j){this.name=a;this.containerId=c;this.scoreItems=d;this.value=e||0;this.isReadonly=f||!1;this.voteOptions=[];this.voteTitleId=this.name+"_title";this.callbackFunc=h;this.defaultCss=j||"coolRate";Micsun.DOM.loaded?this.init():(a=function(a){return function(){a.init()}}(this),Micsun.DOM.addDOMReadyFunctions(a))},init:function(){for(var a='<div style="float:left;width:auto;height:auto" class="'+this.defaultCss+'">',a=a+('<input  id="'+
this.name+'" name="'+this.name+'" type="hidden" value="'+this.value+'">'),c=0;c<this.scoreItems.length;c++)this.voteOptions[c]=this.name+"_vote_"+c,a+='<a id="'+this.voteOptions[c]+'"></a>';a=a+"</div>"+('<div id="'+this.voteTitleId+'" style="float:left;" class="'+this.defaultCss+'Title" ></div>');M$(this.containerId).innerHTML=a;for(c=0;c<this.scoreItems.length;c++)M$(this.voteOptions[c]).onmouseover=function(a,c){return function(){c.onRating(a)}}(c+1,this),M$(this.voteOptions[c]).onmouseout=function(a){return function(){a.onRatingOut()}}(this),
M$(this.voteOptions[c]).onclick=function(a,c){return function(){c.onSelect(a)}}(c+1,this);this._resetRating()},setReadOnly:function(a){this.isReadonly=a||!1},getValue:function(){return this.value},setValue:function(a){this.value=a;this._resetRating()},onRating:function(a){if(!0!=this.isReadonly)for(var c=0;c<this.scoreItems.length;c++)c<a?(M$(this.voteOptions[c]).className="on",M$(this.voteTitleId).innerHTML=this.scoreItems[c]):M$(this.voteOptions[c]).className=""},onRatingOut:function(){!0!=this.isReadonly&&
this._resetRating()},_resetRating:function(){for(var a=0;a<this.scoreItems.length;a++)a<this.value?(M$(this.voteOptions[a]).className="on",M$(this.voteTitleId).innerHTML=this.scoreItems[a]):M$(this.voteOptions[a]).className=""},onSelect:function(a){if(!0!=this.isReadonly)this.value=a,M$(this.name).value=a,this._resetRating(),null!=this.callbackFunc&&this.callbackFunc(a)}});
Micsun.Controls.RateVoteGroup=Micsun.Class({initialize:function(a,c,d,e,f,h,j,k){this.name=a;this.containerId=c;this.subjectCatArray=d;this.scoreItems=e;this.defaultValues=f|0;this.isReadonly=h||!1;this.callbackFunc=j;this.defaultCss=k||"coolRate";this.votesContainers=[];this.votesIds=[];this.votes=[];this.totalScore=0;this.totalRateContainer=this.name+"_total_container";this.totalRateId=this.name+"_total";this.totalVote=null;if(this.defaultValues&&0<this.defaultValues.length){for(;i<this.defaultValues.length;i++)this.totalScore+=
this.defaultValues[i];this.totalScore=parseInt(this.totalScore/this.defaultValues.length)}Micsun.DOM.loaded?this.init():(a=function(a){return function(){a.init()}}(this),Micsun.DOM.addDOMReadyFunctions(a))},init:function(){var a="";1<this.subjectCatArray.length&&(a+='<div style="float:left;width:100%;"><div style="float:left;font-weight:bold">\u603b\u8bc4\uff1a</div><div id="'+this.totalRateContainer+'" style="float:left;"></div><div>');for(var a=a+'<div style="float:left;width:100%;">',c=0;c<this.subjectCatArray.length;c++)this.votesContainers[c]=
this.name+"_container_"+c,this.votesIds[c]=this.name+"_vote_"+c,a+='<div style="float:left;width:auto;"><div style="float:left;">'+this.subjectCatArray[c]+'\uff1a</div><div id="'+this.votesContainers[c]+'" style="float:left;"></div><div>';M$(this.containerId).innerHTML=a+"</div>";if(1<this.subjectCatArray.length)this.totalVote=new Micsun.Controls.RateVote(this.totalRateId,this.totalRateContainer,this.scoreItems,this.totalScore,!0,null,this.defaultCss);for(c=0;c<this.subjectCatArray.length;c++){var a=
this.defaultValues[c]||0,d=function(a,c,d){return function(){a.onSelect(c,d)}}(this,this.votesIds[c],c);this.votes[c]=new Micsun.Controls.RateVote(this.votesIds[c],this.votesContainers[c],this.scoreItems,a,this.isReadonly,d,this.defaultCss)}},onSelect:function(a,c){for(var d=0,e=0;e<this.subjectCatArray.length;e++)d+=this.votes[e].getValue();this.totalScore=parseInt(d/this.subjectCatArray.length);1<this.subjectCatArray.length&&this.totalVote.setValue(this.totalScore);null!=this.callbackFunc&&this.callbackFunc(a,
c)},setReadOnly:function(a){for(var c=0;c<this.subjectCatArray.length;c++)this.votes[c].setReadOnly(a)},valueToJSON:function(){for(var a="[",c=0;c<this.subjectCatArray.length;c++)0<c&&(a+=","),a+='{score:"'+this.votes[c].getValue()+'",item:"'+this.subjectCatArray[c]+'"}';return a+"]"}});
Micsun.Controls.AjaxList=Micsun.Class({initialize:function(a,c,d,e,f,h,j,k,l,m,o,n){this.listDivId=a;this.webRoot=c;this.msgHandler=d;this.optType=e;this.params=f;this.limit=h;this.pageDivId=j;this.pagination=null;this.pageLinkNum=k||3;this.currentOffset=0;this.completeCallback=l;this.totalCount=0;this.isVMRender=m||!1;this.vmSrc=o;this.vmType=n},load:function(a){var c=this.webRoot+"/send_message",d="opt_type="+this.optType,d=d+"&"+Micsun.toQueryString(this.params),d=d+"&max_page_items="+this.limit,
d=d+"&pager.offset="+a+"&msg_handler="+this.msgHandler;if(0==a&&null!=this.pagination)this.pagination.pageIndex=1;a=function(a){return function(c){a._render(c)}}(this);new Ajax.Request(c,{method:"post",parameters:d,onComplete:a})},_render:function(a){if(0<a.responseText.indexOf("data")){eval("var returnObj="+a.responseText);if(returnObj.count)this.totalCount=returnObj.count;else if(returnObj.pageInfo&&returnObj.pageInfo.count)this.totalCount=returnObj.pageInfo.count;!0==this.isVMRender?"file"==this.vmType?
new Micsun.Plugin.Velocity(M$(this.listDivId),this.vmType,this.vmSrc,returnObj):new Micsun.Plugin.Velocity(M$(this.listDivId),"string",M$(this.vmSrc).innerHTML,returnObj):M$(this.listDivId).innerHTML=returnObj.data;if(null==this.pagination)a=function(a){return function(d){a._choose(d)}}(this),this.pagination=new Micsun.UI.Pagination(this.pageDivId,this.totalCount,this.limit,this.pageLinkNum,a);this.pagination.showFirstAndLastLink=!0;this.pagination.showTotalRecord=!0;this.pagination.showTotalPage=
!0;this.pagination.setTotalCount(this.totalCount);this.pagination.renderPage();this.completeCallback&&this.completeCallback(returnObj)}},_choose:function(a){a=(a-1)*this.limit;this.load(a);this.currentOffset=a},addParam:function(a,c){this.params[a]=c},setParam:function(a,c){this.params[a]=c}});Micsun||alert("The following script will work with micsun.base.js!");Micsun.MsgHandler={};var MICSUN_JSON_NAME="__micsun_protocal_json",FILTER_COMPARE_EQUAL="=",FILTER_COMPARE_NOTEQUAL="!=",FILTER_COMPARE_LESS="<",FILTER_COMPARE_GREAT=">",FILTER_COMPARE_LESSEQUAL="<=",FILTER_COMPARE_GREATEQUAL=">=",FILTER_COMPARE_LIKE="like",FILTER_COMPARE_STARTWITH="like",FILTER_COMPARE_ENDWITH="like",FILTER_VALUE_CONTENT=0,FILTER_VALUE_FIELD=1;
Micsun.MsgHandler.FilterInfo=Micsun.Class({initialize:function(a,c,d,e,f){this.columnId=a||"";this.fieldName=c||"";this.logic=d||"";this.value=e||"";this.valueType=f||0}});var FilterInfo=Micsun.MsgHandler.FilterInfo;Micsun.MsgHandler.SortInfo=Micsun.Class({initialize:function(a,c,d){this.columnId=a||"";this.fieldName=c||"";this.sortOrder=d||"DESC"}});var SortInfo=Micsun.MsgHandler.SortInfo;
Micsun.MsgHandler.PageInfo=Micsun.Class({initialize:function(a,c,d,e,f,h){this.totalPageNum=a||0;this.pageSize=c||5;this.pageNum=d||0;this.startRowNum=e||1;this.endRowNum=f||1;this.totalRowNum=h||0},setPageInfo:function(a,c){this.pageSize=a||5;this.startRowNum=c||1}});var PageInfo=Micsun.MsgHandler.PageInfo;
Micsun.MsgHandler.LoadRequest=Micsun.Class({initialize:function(a,c,d,e,f){this.action=a||"ajax_load";this.jsonCallBack="";this.recordType="array";this.pageInfo=e||{};this.sortInfo=d||[];this.filterInfo=c||[];this.parameters=f||{}},setPageInfo:function(a){this.pageInfo=a},setJsonCallBack:function(a){this.jsonCallBack=a},setParameters:function(a){this.parameters=a},addParameter:function(a,c){this.parameters[a]=c},addFilterInfo:function(a){this.filterInfo.push(a)},resetFilter:function(){for(;0<this.filterInfo.length;)this.filterInfo.pop()},
resetSort:function(){for(;0<this.sortInfo.length;)this.sortInfo.pop()},addSortInfo:function(a){this.sortInfo.push(a)}});var LoadRequest=Micsun.MsgHandler.LoadRequest;Micsun.MsgHandler.LoadResponse=Micsun.Class({initialize:function(){this.data=[];this.exception="";this.success=!1;this.pageInfo={}},setData:function(a){this.data=a},setException:function(a){this.exception=a},setSuccess:function(a){this.success=a},setPageInfo:function(a){this.pageInfo=a}});var LoadResponse=Micsun.MsgHandler.LoadResponse;
Micsun.MsgHandler.SaveRequest=Micsun.Class({initialize:function(a,c,d,e,f){this.action="ajax_save";this.jsonCallBack="";this.recordType="array";this.insertedRecords=c||[];this.updatedRecords=d||[];this.deletedRecords=e||[];this.parameters=f||{}},setInsertedRecords:function(a){this.insertedRecords=a},setJsonCallBack:function(a){this.jsonCallBack=a},setUpdatedRecords:function(a){this.updatedRecords=a},setDeletedRecords:function(a){this.insertedRecords=a},addUpdatedRecord:function(a){this.updatedRecords.push(a)},
addDeletedRecord:function(a){this.deletedRecords.push(a)},addInsertedRecord:function(a){this.insertedRecords.push(a)},setParameters:function(a){this.parameters=a},addParameter:function(a,c){this.parameters.key=c}});var SaveRequest=Micsun.MsgHandler.SaveRequest;Micsun.MsgHandler.SaveResponse=Micsun.Class({initialize:function(){this.exception="";this.success=!1;this.object={}},setException:function(a){this.exception=a},setSuccess:function(a){this.success=a},setReturnObj:function(a){this.object=a}});
var SaveResponse=Micsun.MsgHandler.SaveResponse;Micsun.MsgHandler.GenericRequest=Micsun.Class({initialize:function(a,c){this.action=a||"";this.jsonCallBack="";this.recordType="array";this.parameters=c||{}},setAction:function(a){this.action=a},setJsonCallBack:function(a){this.jsonCallBack=a},setParameters:function(a){this.parameters=a},addParameter:function(a,c){this.parameters.key=c}});var GenericRequest=Micsun.MsgHandler.GenericRequest;
Micsun.MsgHandler.GenericResponse=Micsun.Class({initialize:function(){this.exception="";this.success=!1;this.object={}},setException:function(a){this.exception=a},setSuccess:function(a){this.success=a},setReturnObj:function(a){this.object=a}});var GenericResponse=Micsun.MsgHandler.GenericResponse,_msgHandlerId=0;
Micsun.MsgHandler.MsgHandler=Micsun.Class({initialize:function(a,c,d,e,f,h,j,k){this.webContext=a||"";this.callbackFun=h;this.param=e||{};this.msgHandler=c||"";this.optType=d||"";this.request=f||{};this.isJSON=j||1;this.isCrossDomain=k||0;this.method="post"},onMsgHandler:function(a){this.callbackFun&&!Micsun.isUndefined(a)&&(a=1==this.isJSON?Micsun.JSON.decode(a.responseText):a.responseText)&&this.callbackFun(a)},onJSONMsgHandler:function(a){this.callbackFun&&!Micsun.isUndefined(a)&&(1==this.isJSON?
this.callbackFun(a.responseJSON):this.callbackFun(a.responseText))},sendMsg:function(){var a=this.webContext+"/send_message",c="msg_handler="+this.msgHandler,c=c+("&opt_type="+this.optType),c=c+("&"+Micsun.toQueryString(this.param));if(this.isCrossDomain){var d="";this.request&&(this.isCrossDomain&&(d="_msgHandlerCallback_"+_msgHandlerId++,this.request.setJsonCallBack(d)),c+="&"+MICSUN_JSON_NAME+"="+Micsun.toJSON(this.request));e=this.method;a+="?"+c;c=function(a){return function(c,d){a.onJSONMsgHandler(d)}}(this);
new Ajax.JSONRequest(a,{parameters:{jsonCallBack:d},onComplete:c})}else{this.request&&(c+="&"+MICSUN_JSON_NAME+"="+Micsun.toJSON(this.request));var e=this.method,d=function(a){return function(c){a.onMsgHandler(c)}}(this);new Ajax.Request(a,{method:e,parameters:c,asynchronous:!0,onComplete:d})}},setWebContext:function(a){this.webContext=a},setCallbackFun:function(a){this.callbackFun=a},setOptType:function(a){this.optType=a},setMethod:function(a){this.method=a},setMsgHandler:function(a){this.msgHandler=
a},setRequest:function(a){this.request=a},setParam:function(a){this.param=a}});var MsgHandler=Micsun.MsgHandler.MsgHandler;Micsun||alert("The following script will work with micsun.base.js!");
var VALIDATE_CFG={inputhighlight:!0,multipleclassname:!0,inputclasserror:"inputError",inputclassnormal:"inputNormal",innererror:"innerError",errorsdiv:"errorsDiv",debugmode:!1,trimenabled:!0,helpdiv:"validation_helpDiv",helpenabled:!1,DECIMAL_SEP:".",THOUSAND_SEP:",",DATE_FORMAT:"yyyy-MM-dd",TIME_FORMAT:"hh:mm",alphabetic_regex:"^[A-Za-z]*$",alphanumeric_regex:"^[A-Za-z0-9]*$",alnumhyphen_regex:"^[A-Za-z0-9-_]*$",alnumhyphenat_regex:"^[A-Za-z0-9-_@]*$",alphaspace_regex:"^[A-Za-z0-9-_ \n\r\t]*$",email_regex:"^(([0-9a-zA-Z]+[-._+&])*[0-9a-zA-Z]+@([-0-9a-zA-Z]+[.])+[a-zA-Z]{2,6}){0,1}$",
RULE_SEP:"|",HEADER_MSG:"\u6570\u636e\u9a8c\u8bc1\u672a\u901a\u8fc7:",FOOTER_MSG:"\u8bf7\u91cd\u8bd5.",DEFAULT_MSG:"\u6570\u636e\u4e0d\u6b63\u786e.",REQUIRED_MSG:"\u8bf7\u8f93\u5165[{1}].",ALPHABETIC_MSG:"[{1}] \u683c\u5f0f\u9519\u8bef. \u5141\u8bb8\u7684\u5b57\u7b26: A-Za-z",ALPHANUMERIC_MSG:"[{1}] \u683c\u5f0f\u9519\u8bef. \u5141\u8bb8\u7684\u5b57\u7b26: A-Za-z0-9",ALNUMHYPHEN_MSG:"[{1}] \u683c\u5f0f\u9519\u8bef. \u5141\u8bb8\u7684\u5b57\u7b26: A-Za-z0-9-_",ALNUMHYPHENAT_MSG:"[{1}] \u683c\u5f0f\u9519\u8bef. \u5141\u8bb8\u7684\u5b57\u7b26: A-Za-z0-9-_@",
ALPHASPACE_MSG:'[{1} \u683c\u5f0f\u9519\u8bef. \u5141\u8bb8\u7684\u5b57\u7b26: A-Za-z0-9-_"\u7a7a\u683c"',MINLENGTH_MSG:"[{1}] \u9700\u81f3\u5c11 {2} \u4e2a\u5b57\u7b26.",MAXLENGTH_MSG:"[{1}] \u9700\u5c11\u4e8e {2} \u4e2a\u5b57\u7b26.",NUMRANGE_MSG:"[{1}] \u9700\u4e3a {2} \u95f4\u7684\u6570\u5b57.",DATE_MSG:"[{1}] \u65e5\u671f\u9519\u8bef, \u683c\u5f0f: {2}.",TIME_MSG:"[{1}] \u65f6\u95f4\u9519\u8bef, \u683c\u5f0f: {2}.",NUMERIC_MSG:"[{1}] \u9700\u4e3a\u6570\u5b57.",INTEGER_MSG:"[{1}] \u9700\u4e3a\u8bc1\u4e66",
DOUBLE_MSG:"[{1}] \u9700\u4e3a\u5c0f\u6570.",REGEXP_MSG:"[{1}] \u683c\u5f0f\u9519\u8bef. \u5141\u8bb8\u7684\u683c\u5f0f: {2}.",EQUAL_MSG:"[{1}] \u9700\u7b49\u4e8e {2}.",NOTEQUAL_MSG:"[{1}] \u9700\u4e0d\u540c\u4e8e {2}.",DATE_LT_MSG:"[{1}] \u9700\u65e9\u4e8e {2}.",DATE_LE_MSG:"[{1}] \u9700\u65e9\u4e8e\u6216\u7b49\u4e8e {2}.",EMAIL_MSG:"[{1}] \u9700\u4e3a\u6709\u6548\u7684E-mail\u5730\u5740.",EMPTY_MSG:"[{1}] \u9700\u4e3a\u7a7a."};Micsun||alert("The following script will work with micsun.base.js!");var UNDEF=void 0;
Micsun.UI.Rule=Micsun.Class({initialize:function(a,c,d,e,f){if(!this.checkArguments(arguments))return!1;var h=a.split(":"),j="";2==h.length&&(j=h[1],a=h[0]);this.el=a;this.nameDisplayed=j;this.ruleName=c;this.comparisonValue=d;this.ruleType=f;this.alertMsg=e==UNDEF||null==e?this.getDefaultMessage(a,j,c,d)+"__inline__"+this.el:e+"__inline__"+this.el},checkArguments:function(a){if(4>a.length)return this.debug("DEBUG: rule requires four arguments at least"),!1;return null==a[0]||null==a[1]?(this.debug("DEBUG: el and ruleName are required"),
!1):!0},getDefaultMessage:function(a,c,d,e){0==c.length&&(c=a);a=VALIDATE_CFG.DEFAULT_MSG;"required"==d?a=VALIDATE_CFG.REQUIRED_MSG.replace("{1}",c):"minlength"==d?a=VALIDATE_CFG.MINLENGTH_MSG.replace("{1}",c).replace("{2}",e):"maxlength"==d?a=VALIDATE_CFG.MAXLENGTH_MSG.replace("{1}",c).replace("{2}",e):"numrange"==d?a=VALIDATE_CFG.NUMRANGE_MSG.replace("{1}",c).replace("{2}",e):"date"==d?a=VALIDATE_CFG.DATE_MSG.replace("{1}",c).replace("{2}",VALIDATE_CFG.DATE_FORMAT):"time"==d?a=VALIDATE_CFG.TIME_MSG.replace("{1}",
c).replace("{2}",VALIDATE_CFG.TIME_FORMAT):"numeric"==d?a=VALIDATE_CFG.NUMERIC_MSG.replace("{1}",c):"integer"==d?a=VALIDATE_CFG.INTEGER_MSG.replace("{1}",c):"double"==d?a=VALIDATE_CFG.DOUBLE_MSG.replace("{1}",c):"equal"==d?a=VALIDATE_CFG.EQUAL_MSG.replace("{1}",c).replace("{2}",this.getComparisonDisplayed(e)):"notequal"==d?a=VALIDATE_CFG.NOTEQUAL_MSG.replace("{1}",c).replace("{2}",this.getComparisonDisplayed(e)):"alphabetic"==d?a=VALIDATE_CFG.ALPHABETIC_MSG.replace("{1}",c):"alphanumeric"==d?a=VALIDATE_CFG.ALPHANUMERIC_MSG.replace("{1}",
c):"alnumhyphen"==d?a=VALIDATE_CFG.ALNUMHYPHEN_MSG.replace("{1}",c):"alnumhyphenat"==d?a=VALIDATE_CFG.ALNUMHYPHENAT_MSG.replace("{1}",c):"alphaspace"==d?a=VALIDATE_CFG.ALPHASPACE_MSG.replace("{1}",c):"email"==d?a=VALIDATE_CFG.EMAIL_MSG.replace("{1}",c):"regexp"==d?a=VALIDATE_CFG.REGEXP_MSG.replace("{1}",c).replace("{2}",e):"date_lt"==d?a=VALIDATE_CFG.DATE_LT_MSG.replace("{1}",c).replace("{2}",this.getComparisonDisplayed(e)):"date_le"==d?a=VALIDATE_CFG.DATE_LE_MSG.replace("{1}",c).replace("{2}",this.getComparisonDisplayed(e)):
"empty"==d&&(a=VALIDATE_CFG.EMPTY_MSG.replace("{1}",c));return a},getComparisonDisplayed:function(a){var c=a;"$"==a.substring(0,1)&&(a=a.substring(1,a.length),c=a.split(":"),c=2==c.length?c[1]:a);return c},debug:function(a){VALIDATE_CFG.debugmode&&alert(a)}});
Micsun.UI.Validation=Micsun.Class({initialize:function(){this.isFocusSet=!1;this.internalRules=[];this.val_balloon=this.container=this.f=null;this.alertType="inline"},init:function(a,c,d){this.internalRules=this.makeRules(c);this.f=document.forms[a];if(!this.f&&(this.f=null,this.container=M$(a),null==this.container))return this.debug("DEBUG: could not find container object "+a),!1;if(d)this.alertType=d},performCheck:function(){this.isFocusSet=!1;var a=this.internalRules,c=[],d=0;if(a.length)for(var e=
0;e<a.length;e++){var f=a[e];null!=f&&this.highlight(this.getField(f.el),VALIDATE_CFG.inputclassnormal)}else null!=a&&this.highlight(this.getField(a.el),VALIDATE_CFG.inputclassnormal);if(a.length)for(e=0;e<a.length;e++){var f=a[e],h=null;if(null!=f&&!("pre-condition"==f.ruleType||"post-condition"==f.ruleType||"andor-operator"==f.ruleType))if("implies"==f.ruleName){var j=f.el,k=f.comparisonValue,l=this.getField(a[j].el).className;if(null==this.checkRule(a[j])&&null!=this.checkRule(a[k]))h=this.deleteInline(f.alertMsg)+
"this.__inline__"+a[k].el;else if(null!=this.checkRule(a[j]))this.getField(a[j].el).className=l}else h=this.checkRule(f);null!=h&&(c[d]=h,d++)}else a=this.checkRule(a),null!=a&&(c[0]=a);return this.displayAlert(c,this.alertType)},checkKeyPress:function(a,c){var d=null;if(Micsun.isIE)d=window.event.keyCode;else if(Micsun.isNetscape||Micsun.isFirefox)d=a.which;var e=this.internalRules,f=!0;if(e.length)for(var h=0;h<e.length;h++){var j=e[h];if("keypress"==j.ruleName&&j.el==c.name){f=this.isKeyAllowed(d,
j.comparisonValue);break}}else j=e,"keypress"==j.ruleName&&j.el==c.name&&(f=this.isKeyAllowed(d,j.comparisonValue));if(!f)if(Micsun.isIE)window.event.keyCode=0;else if(Micsun.isNetscape||Micsun.isFirefox)a.preventDefault(),a.stopPropagation(),a.returnValue=!1;return!1},showHelp:function(a,c){if(null==this.val_balloon)this.val_balloon=new BubbleTooltip("val_ballon",M$(this.helpdiv));var d="";if(VALIDATE_CFG.helpenabled){if(this.internalRules.length)for(var e=0;e<this.internalRules.length;e++){var f=
this.internalRules[e];f.el==c.name&&(d+=this.deleteInline(f.alertMsg))}this.val_balloon.showToolTip(a,d)}else d=M$(VALIDATE_CFG.errorsdiv+"_"+c.name).innerHTML,0<this.strTrim(d).length&&this.val_balloon.showToolTip(a,d)},hideHelp:function(){this.val_balloon&&this.val_balloon.hideToolTip()},displayAlert:function(a,c){var d=null;this.clearAllInlineSpans();"inline"==c?d=this.displayInline(a):"balloon"==c?d=this.displayBalloonInline(a):"innerHTML"==c&&(d=this.displayInnerHtml(a));return d},displayBalloonInline:function(a){if(null!=
a&&0<a.length){for(var c=0;c<a.length;c++){var d=a[c].substring(a[c].indexOf("__inline__")+10),e=M$(VALIDATE_CFG.errorsdiv+"_"+d);if(e)e.innerHTML=this.deleteInline(a[c]),e.className=VALIDATE_CFG.innererror,d=this.getField(d),d.onmouseout=function(a){return function(){a.hideHelp()}}(this),d.onmouseover=function(a){return function(c){a.showHelp(c,this)}}(this)}return!1}return!0},displayInline:function(a){if(null!=a&&0<a.length){for(var c=0;c<a.length;c++){var d=a[c].substring(a[c].indexOf("__inline__")+
10);if(M$(VALIDATE_CFG.errorsdiv+"_"+d))M$(VALIDATE_CFG.errorsdiv+"_"+d).innerHTML=this.deleteInline(a[c]),M$(VALIDATE_CFG.errorsdiv+"_"+d).className=VALIDATE_CFG.innererror,M$(VALIDATE_CFG.errorsdiv+"_"+d).style.display=""}return!1}return!0},displayInnerHtml:function(a){if(null!=a&&0<a.length){var c="";0<this.strTrim(VALIDATE_CFG.HEADER_MSG).length&&(c+=VALIDATE_CFG.HEADER_MSG);for(var c=c+"<ul>",d=0;d<a.length;d++)c+="<li>"+this.deleteInline(a[d])+"</li>";c+="</ul>";0<this.strTrim(VALIDATE_CFG.FOOTER_MSG).length&&
(c+=VALIDATE_CFG.FOOTER_MSG);M$(VALIDATE_CFG.errorsdiv).innerHTML=c;M$(VALIDATE_CFG.errorsdiv).className=VALIDATE_CFG.innererror;M$(VALIDATE_CFG.errorsdiv).style.display="block";return!1}M$(VALIDATE_CFG.errorsdiv).innerHTML="";M$(VALIDATE_CFG.errorsdiv).className="";M$(VALIDATE_CFG.errorsdiv).style.display="none";return!0},clearAllInlineSpans:function(){for(var a=document.getElementsByTagName("span"),c=0;c<a.length;c++){var d=a[c].id;if(0==d.indexOf(VALIDATE_CFG.errorsdiv+"_"))M$(d).innerHTML="",
M$(d).className="",M$(d).style.display="none"}},checkRule:function(a){var c=null;if(null!=a)if("custom"==a.ruleName)eval(" retVal = "+a.el);else if("and"==a.ruleName){var d=a.el,e=a.comparisonValue;if(null!=this.checkRule(this.internalRules[d]))c=a.alertMsg;else for(var f=e.split("-"),h=0;h<f.length;h++)if(null!=this.checkRule(this.internalRules[f[h]])){c=a.alertMsg;break}}else if("or"==a.ruleName){var d=a.el,e=a.comparisonValue,j=!1;if(null==this.checkRule(this.internalRules[d]))j=!0;else{f=e.split("-");
for(h=0;h<f.length;h++)if(null==this.checkRule(this.internalRules[f[h]])){j=!0;break}}if(j){this.highlight(this.getField(this.internalRules[d].el),VALIDATE_CFG.inputclassnormal);f=e.split("-");for(h=0;h<f.length;h++)this.highlight(this.getField(this.internalRules[f[h]].el),VALIDATE_CFG.inputclassnormal)}else c=a.alertMsg}else{c=this.getField(a.el);if(null==c)return this.debug("DEBUG: could not find element "+a.el),null;d=null;c.type?"hidden"==c.type||"text"==c.type||"password"==c.type||"textarea"==
c.type?d=this.checkText(c,a):"checkbox"==c.type?d=this.checkCheckbox(c,a):"select-one"==c.type?d=this.checkSelOne(c,a):"select-multiple"==c.type?d=this.checkSelMul(c,a):"radio"==c.type?d=this.checkRadio(c,a):this.debug("DEBUG: type "+c.type+" not supported"):d=this.checkRadio(c,a);c=d}return c},checkRadio:function(a,c){var d=null;if("required"==c.ruleName){var e=a,f=!1;if(isNaN(e.length)&&e.checked)f=!0;else for(var h=0;h<e.length;h++)if(e[h].checked){f=!0;break}if(!f)this.highlight(a,VALIDATE_CFG.inputclasserror),
d=c.alertMsg}else if("equal"==c.ruleName){e=a;f=!1;if(isNaN(e.length)&&e.checked)e.value==c.comparisonValue&&(f=!0);else for(h=0;h<e.length;h++)if(e[h].checked&&e[h].value==c.comparisonValue){f=!0;break}if(!f)d=c.alertMsg}else if("notequal"==c.ruleName){e=a;f=!1;if(isNaN(e.length)&&e.checked)e.value!=c.comparisonValue&&(f=!0);else for(h=0;h<e.length;h++)if(e[h].checked&&e[h].value!=c.comparisonValue){f=!0;break}if(!f)d=c.alertMsg}else this.debug("DEBUG: rule "+c.ruleName+" not supported for radio");
return d},checkText:function(a,c){var d=null,e=null;if(VALIDATE_CFG.trimenabled)a.value=this.strTrim(a.value);if("required"==c.ruleName){if(null==a.value||""==a.value)this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else if("equal"==c.ruleName)d=this.checkEqual(a,c);else if("notequal"==c.ruleName)d=this.checkNotEqual(a,c);else if("numeric"==c.ruleName){if(e=/^[0-9]*$/,!e.test(a.value))this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else if("alphabetic"==c.ruleName){if(e=RegExp(VALIDATE_CFG.alphabetic_regex),
!e.test(a.value))this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else if("alphanumeric"==c.ruleName){if(e=RegExp(VALIDATE_CFG.alphanumeric_regex),!e.test(a.value))this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else if("alnumhyphen"==c.ruleName){if(e=RegExp(VALIDATE_CFG.alnumhyphen_regex),!e.test(a.value))this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else if("alnumhyphenat"==c.ruleName){if(e=RegExp(VALIDATE_CFG.alnumhyphenat_regex),!e.test(a.value))this.highlight(a,
VALIDATE_CFG.inputclasserror),d=c.alertMsg}else if("alphaspace"==c.ruleName){if(e=RegExp(VALIDATE_CFG.alphaspace_regex),!e.test(a.value))this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else if("email"==c.ruleName){if(e=RegExp(VALIDATE_CFG.email_regex),!e.test(a.value))this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else if("maxlength"==c.ruleName)if(isNaN(c.comparisonValue))this.debug("DEBUG: comparisonValue for rule "+c.ruleName+" not a number");else{if(a.value.length>c.comparisonValue)this.highlight(a,
VALIDATE_CFG.inputclasserror),d=c.alertMsg}else if("minlength"==c.ruleName)if(isNaN(c.comparisonValue))this.debug("DEBUG: comparisonValue for rule "+c.ruleName+" not a number");else{if(a.value.length<c.comparisonValue)this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else if("numrange"==c.ruleName)if(e=/^[-+]{0,1}[0-9]*[.]{0,1}[0-9]*$/,e.test(this.unformatNumber(a.value)))if(/^[0-9]+-[0-9]+$/.test(c.comparisonValue)){if(e=c.comparisonValue.split("-"),eval(this.unformatNumber(a.value))<eval(e[0])||
eval(this.unformatNumber(a.value))>eval(e[1]))this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else this.debug("DEBUG: comparisonValue for rule "+c.ruleName+" not in format number1-number2");else this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg;else if("regexp"==c.ruleName){if(e=RegExp(c.comparisonValue),!e.test(a.value))this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else if("integer"==c.ruleName)d=this.checkInteger(a,c);else if("double"==c.ruleName)d=this.checkDouble(a,
c);else if("date"==c.ruleName)d=this.checkDate(a,c);else if("time"==c.ruleName)d=this.checkTime(a,c);else if("date_lt"==c.ruleName)d=this.checkDateLessThan(a,c,!1);else if("date_le"==c.ruleName)d=this.checkDateLessThan(a,c,!0);else if("keypress"!=c.ruleName)if("empty"==c.ruleName){if(null!=a.value&&""!=a.value)this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else this.debug("DEBUG: rule "+c.ruleName+" not supported for "+a.type);return d},checkInteger:function(a,c){if(!/^[-+]{0,1}[0-9]*$/.test(a.value))return this.highlight(a,
VALIDATE_CFG.inputclasserror),c.alertMsg},checkDouble:function(a,c){if(!RegExp("^[-+]{0,1}[0-9]*["+VALIDATE_CFG.DECIMAL_SEP+"]{0,1}[0-9]*$").test(a.value))return this.highlight(a,VALIDATE_CFG.inputclasserror),c.alertMsg},checkDate:function(a,c){var d=null;if(""!=a.value){var e=VALIDATE_CFG.DATE_FORMAT,f=/MM/,h=/yyyy/,j,k,l;!/dd/.test(e)||!f.test(e)||!h.test(e)?this.debug("DEBUG: locale format "+e+" not supported"):(j=e.indexOf("dd"),k=e.indexOf("MM"),l=e.indexOf("yyyy"));e=e.replace("dd","[0-9]{2}").replace("MM",
"[0-9]{2}").replace("yyyy","[0-9]{4}");if(RegExp("^"+e+"$").test(a.value)){if(j=a.value.substring(j,j+2),k=a.value.substring(k,k+2),l=a.value.substring(l,l+4),!this.checkddMMyyyy(j,k,l))this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}return d},checkDateLessThan:function(a,c,d){var e=null;if(null==this.checkDate(a,c)&&""!=a.value){var f=VALIDATE_CFG.DATE_FORMAT,h=f.indexOf("dd"),j=f.indexOf("MM"),k=f.indexOf("yyyy"),l=a.value.substring(h,
h+2),m=a.value.substring(j,j+2),l=""+a.value.substring(k,k+4)+m+l,f=f.replace("dd","[0-9]{2}").replace("MM","[0-9]{2}").replace("yyyy","[0-9]{4}"),m=RegExp("^"+f+"$"),f="";0==c.comparisonValue.indexOf("$")?(f=c.comparisonValue.substr(1).split(":"),f=2==f.length?this.getField(f[0]).value:this.getField(c.comparisonValue.substr(1)).value):f=c.comparisonValue;if(m.test(f))if(h=f.substring(h,h+2),j=f.substring(j,j+2),k=f.substring(k,k+4),f=""+k+j+h,d){if(!this.checkddMMyyyy(h,j,k)||l>f)this.highlight(a,
VALIDATE_CFG.inputclasserror),e=c.alertMsg}else{if(!this.checkddMMyyyy(h,j,k)||l>=f)this.highlight(a,VALIDATE_CFG.inputclasserror),e=c.alertMsg}else this.highlight(a,VALIDATE_CFG.inputclasserror),e=c.alertMsg}else if(""!=a.value)this.highlight(a,VALIDATE_CFG.inputclasserror),e=c.alertMsg;return e},checkTime:function(a,c){var d=null;if(""!=a.value){var e=VALIDATE_CFG.TIME_FORMAT,f=/mm/,h=/ss/,j,k,l;!/hh/.test(e)||!f.test(e)||!h.test(e)?this.debug("DEBUG: locale format "+e+" not supported"):(j=e.indexOf("hh"),
k=e.indexOf("mm"),l=e.indexOf("ss"));e=e.replace("hh","[0-9]{2}").replace("mm","[0-9]{2}").replace("ss","[0-9]{2}");if(RegExp("^"+e+"$").test(a.value)){if(j=a.value.substring(j,j+2),k=a.value.substring(k,k+2),l=a.value.substring(l,l+2),!this.checkHHMMSS(j,k,l))this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}else this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg}return d},checkEqual:function(a,c){var d=null,e="";0==c.comparisonValue.indexOf("$")?(e=c.comparisonValue.substr(1).split(":"),
e=2==e.length?this.getField(e[0]).value:this.getField(c.comparisonValue.substr(1)).value):e=c.comparisonValue;if(a.value!=e)this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg;return d},checkNotEqual:function(a,c){var d=null,e="";0==c.comparisonValue.indexOf("$")?(e=c.comparisonValue.substr(1).split(":"),e=2==e.length?this.getField(e[0]).value:this.getField(c.comparisonValue.substr(1)).value):e=c.comparisonValue;if(a.value==e)this.highlight(a,VALIDATE_CFG.inputclasserror),d=c.alertMsg;return d},
checkHHMMSS:function(a,c,d){var e=!0;if(0>a||23<a||0>c||59<c||0>d||59<d)e=!1;return e},checkddMMyyyy:function(a,c,d){var e=!0;if(1>a||31<a||1>c||12<c||31==a&&(2==c||4==c||6==c||9==c||11==c)||29<a&&2==c||29==a&&2==c&&(0<d%4||0==d%4&&0==d%100&&0<d%400))e=!1;return e},checkCheckbox:function(a,c){if("required"==c.ruleName){if(!a.checked)return this.highlight(a,VALIDATE_CFG.inputclasserror),c.alertMsg}else if("equal"==c.ruleName){if(!a.checked||a.value!=c.comparisonValue)return this.highlight(a,VALIDATE_CFG.inputclasserror),
c.alertMsg}else if("notequal"==c.ruleName){if(a.checked&&a.value==c.comparisonValue)return this.highlight(a,VALIDATE_CFG.inputclasserror),c.alertMsg}else this.debug("DEBUG: rule "+c.ruleName+" not supported for "+a.type)},checkSelOne:function(a,c){if("required"==c.ruleName){var d=!1,e=a.selectedIndex;0<=e&&a.options[e].value&&(d=!0);if(!d)return this.highlight(a,VALIDATE_CFG.inputclasserror),c.alertMsg}else if("equal"==c.ruleName){if(d=!1,e=a.selectedIndex,0<=e&&a.options[e].value==c.comparisonValue&&
(d=!0),!d)return this.highlight(a,VALIDATE_CFG.inputclasserror),c.alertMsg}else if("notequal"==c.ruleName){if(d=!1,e=a.selectedIndex,0<=e&&a.options[e].value!=c.comparisonValue&&(d=!0),!d)return this.highlight(a,VALIDATE_CFG.inputclasserror),c.alertMsg}else this.debug("DEBUG: rule "+c.ruleName+" not supported for "+a.type)},checkSelMul:function(a,c){var d,e;if("required"==c.ruleName){e=!1;d=a.options;for(var f=0;f<d.length;f++)if(d[f].selected&&d[f].value){e=!0;break}if(!e)return this.highlight(a,
VALIDATE_CFG.inputclasserror),c.alertMsg}else if("equal"==c.ruleName){e=!1;d=a.options;for(f=0;f<d.length;f++)if(d[f].selected&&d[f].value==c.comparisonValue){e=!0;break}if(!e)return this.highlight(a,VALIDATE_CFG.inputclasserror),c.alertMsg}else if("notequal"==c.ruleName){e=!1;d=a.options;for(f=0;f<d.length;f++)if(d[f].selected&&d[f].value!=c.comparisonValue){e=!0;break}if(!e)return this.highlight(a,VALIDATE_CFG.inputclasserror),c.alertMsg}else this.debug("DEBUG: rule "+c.ruleName+" not supported for "+
a.type)},debug:function(a){VALIDATE_CFG.debugmode&&alert(a)},strTrim:function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},makeRules:function(a){var c=[];if(Micsun.isUndefined(a.length))c[0]=this.splitRule(a);else for(var d=0;d<a.length;d++)c[d]=this.splitRule(a[d]);return c},splitRule:function(a){var c=null;if(a!=UNDEF)switch(a=a.split(VALIDATE_CFG.RULE_SEP),a.length){case 2:c=new Micsun.UI.Rule(a[0],a[1],null,null,null);break;case 3:c=this.threeParamRule(a[1])?new Micsun.UI.Rule(a[0],a[1],
a[2],null,null):"pre-condition"==a[2]||"post-condition"==a[2]||"andor-operator"==a[2]?new Micsun.UI.Rule(a[0],a[1],null,"foo",a[2]):new Micsun.UI.Rule(a[0],a[1],null,a[2],null);break;case 4:c=this.threeParamRule(a[1])&&("pre-condition"==a[3]||"post-condition"==a[3]||"andor-operator"==a[3])?new Micsun.UI.Rule(a[0],a[1],a[2],"foo",a[3]):new Micsun.UI.Rule(a[0],a[1],a[2],a[3],null);break;default:this.debug("DEBUG: wrong definition of rule")}return c},threeParamRule:function(a){return"equal"==a||"notequal"==
a||"minlength"==a||"maxlength"==a||"date_lt"==a||"date_le"==a||"implies"==a||"regexp"==a||"numrange"==a||"keypress"==a||"and"==a||"or"==a?!0:!1},highlight:function(a,c){if(!this.isFocusSet&&c==VALIDATE_CFG.inputclasserror)!a.type&&0<a.length&&"radio"==a.item(0).type?a.item(0).focus():a.focus(),this.isFocusSet=!0;if(a!=UNDEF&&VALIDATE_CFG.inputhighlight)VALIDATE_CFG.multipleclassname?this.highlightMultipleClassName(a,c):a.className=c},highlightMultipleClassName:function(a,c){var d=RegExp("(^|\\s)("+
VALIDATE_CFG.inputclassnormal+"|"+VALIDATE_CFG.inputclasserror+")($|\\s)");a.className=this.strTrim(("undefined"!=typeof a.className?a.className.replace(d,""):"")+" "+c)},isKeyAllowed:function(a,c){var d=!1,e;if(8==a)d=!0;else for(var f=0;f<c.length;f++)if(e=c.charCodeAt(f),e==a){d=!0;break}return d},getField:function(a){var c=null;this.f&&this.f.elements[a]?c=this.f.elements[a]:M$(a)&&(c=M$(a));return c},unformatNumber:function(a){a=a.replace(VALIDATE_CFG.THOUSAND_SEP,"");return a=a.replace(VALIDATE_CFG.DECIMAL_SEP,
".")},deleteInline:function(a){return-1==a.indexOf("__inline__")?a:a.substring(0,a.indexOf("__inline__"))}});var Validation=Micsun.UI.Validation;Micsun||alert("The following script will work with micsun.base.js!");if(!Micsun.UI)Micsun.UI={};Micsun.UI.Effect={};Micsun.UI.Effect.Opacity=Micsun.Class({initialize:function(a,c,d,e,f){var f=f||5,e=Math.round(e/100*f),h=0;if(c>d)for(;c>=d;c-=f)setTimeout(function(a,c){return function(){Micsun.UTILS.changeOpac(a,c)}}(a,c),h*e),h++;else if(c<d)for(;c<=d;c+=f)setTimeout(function(a,c){return function(){Micsun.UTILS.changeOpac(a,c)}}(a,c),h*e),h++}});
Micsun.UI.Effect.Example=Micsun.Class({initialize:function(a,c,d,e,f,h){this.addEffectShow(a,c,d,e,f,h)},addEffectShow:function(a,c,d,e,f,h){if(!f)f=AnimateEffect.linear;if(1==c){var c=new AnimateManager,j=c.createAnimObject(a);1==e?(Micsun.UTILS.changeOpac(a,0),j.add({property:AnimateProperty.opacity,from:0,to:1,duration:d,effect:f,onComplete:h})):(Micsun.UTILS.changeOpac(a,1),j.add({property:AnimateProperty.opacity,from:1,to:0,duration:d,effect:f,onComplete:h}));c.play()}else if(2==c){var c=new AnimateManager,
j=c.createAnimObject(a),k=c.createAnimObject(a),l=M$(a).offsetWidth,m=parseInt(l/2);1==e?(M$(a).style.left=m+"px",M$(a).style.width="0px",j.add({property:AnimateProperty.left,to:0,duration:d,effect:f,onComplete:h}),k.add({property:AnimateProperty.width,to:l,duration:d,effect:f,onComplete:h})):(M$(a).style.left="0px",M$(a).style.width=l+"px",j.add({property:AnimateProperty.left,to:m,duration:d,effect:f,onComplete:h}),k.add({property:AnimateProperty.width,to:0,duration:d,effect:f,onComplete:h}));c.play()}else if(3==
c)c=new AnimateManager,j=c.createAnimObject(a),k=c.createAnimObject(a),l=M$(a).offsetHeight,m=parseInt(l/2),1==e?(M$(a).style.top=m+"px",M$(a).style.height="0px",j.add({property:AnimateProperty.top,to:0,duration:d,effect:f,onComplete:h}),k.add({property:AnimateProperty.height,to:l,duration:d,effect:f,onComplete:h})):(M$(a).style.top="0px",M$(a).style.height=l+"px",j.add({property:AnimateProperty.top,to:m,duration:d,effect:f,onComplete:h}),k.add({property:AnimateProperty.height,to:0,duration:d,effect:f,
onComplete:h})),c.play();else if(4==c)c=new AnimateManager,j=c.createAnimObject(a),l=M$(a).offsetWidth,1==e?(M$(a).style.left=l+"px",j.add({property:AnimateProperty.left,to:0,duration:d,effect:f,onComplete:h})):(M$(a).style.left="0px",j.add({property:AnimateProperty.left,to:0-l,duration:d,effect:f,onComplete:h})),c.play();else if(5==c)c=new AnimateManager,j=c.createAnimObject(a),l=M$(a).offsetWidth,1==e?(M$(a).style.left="-"+l+"px",j.add({property:AnimateProperty.left,to:0,duration:d,effect:f,onComplete:h})):
(M$(a).style.left="0px",j.add({property:AnimateProperty.left,to:l,duration:d,effect:f,onComplete:h})),c.play();else if(6==c)c=new AnimateManager,j=c.createAnimObject(a),l=M$(a).offsetHeight,1==e?(M$(a).style.top=l+"px",j.add({property:AnimateProperty.top,to:0,duration:d,effect:f,onComplete:h})):(M$(a).style.top="0px",j.add({property:AnimateProperty.top,to:0-l,duration:d,effect:f,onComplete:h})),c.play();else if(7==c)c=new AnimateManager,j=c.createAnimObject(a),l=M$(a).offsetHeight,1==e?(M$(a).style.top=
"-"+l+"px",j.add({property:AnimateProperty.top,to:0,duration:d,effect:f,onComplete:h})):(M$(a).style.top="0px",j.add({property:AnimateProperty.top,to:l,duration:d,effect:f,onComplete:h})),c.play()}});
Micsun.UI.Effect.MoveBox=Micsun.Class({initialize:function(a,c,d,e,f,h,j,k,l,m,o,n){this.currentPos=0;this.name=a;this.targetPos=0;this.step=l||10;this.containerId=c;this.timeOut=m||5;this.direction=k||"horizon";this.enableAutoLoop=o||!1;this.loopInverval=n||1E3;this.stopLoopInverval=!1;this.checkTimeout=null;"horizon"==this.direction?(this._scrollLength=(d||1)*f,this.displayLength=(e||1)*f):(this._scrollLength=(d||1)*h,this.displayLength=(e||1)*h);this.blockWidth=f;this.blockHeight=h;this.currentIndex=
1;this.contentArray=j;this.scrollTimes=parseInt((j.length-e)/d);0<(j.length-e)%d&&(this.scrollTimes+=1);Micsun.DOM.loaded?this.init():(a=function(a){return function(){a.init()}}(this),Micsun.DOM.addDOMReadyFunctions(a))},init:function(){if(!this.isInit){var a=this.contentArray.length*this._scrollLength;if(this.container=M$(this.containerId+"")){var c;"horizon"==this.direction?(c='<div id="'+this.name+'_moveframe" style="width:'+this.displayLength+"px;height:"+this.blockHeight+'px;float:left;overflow:hidden;position:relative;z-index:auto;">',
c+='<div id="'+this.name+'_displayBlock" style="top:0px;left:0px;width:'+a+"px;position:absolute;height:"+this.blockHeight+'px">'):(c='<div id="'+this.name+'_moveframe" style="width:'+this.blockWidth+"px;height:"+this.displayLength+'px;float:left;overflow:hidden;position:relative;z-index:auto;">',c+='<div id="'+this.name+'_displayBlock" style="top:0px;left:0px;width:'+this.blockWidth+"px;position:absolute;height:"+a+'px">');for(a=0;a<this.contentArray.length;a++)c+='<div id="'+this.contentArray[a].id+
'" style="width:'+this.blockWidth+"px;height:"+this.blockHeight+'px;float:left">',c+=this.contentArray[a].content,c+="</div>";this.container.innerHTML=c+"</div></div>";this.displayBlock=M$(this.name+"_displayBlock")}else alert("\u5bb9\u5668ID\u4e0d\u80fd\u4e3a\u7a7a");this.isInit=!0;!0==this.enableAutoLoop&&this.autoLoop()}},movePrevous:function(){this.stopLoopInverval=!0;this.prev();this.resetAutoCheck()},moveNext:function(){this.stopLoopInverval=!0;this.next();this.resetAutoCheck()},goTo:function(a){this.stopLoopInverval=
!0;this.go(a);this.resetAutoCheck()},loopCheck:function(){if(!0==this.enableAutoLoop&&!0==this.stopLoopInverval&&(this.stopLoopInverval=!1,this.loopFunc(),null!=this.checkTimeout))clearTimeout(this.checkTimeout),this.checkTimeout=null},resetAutoCheck:function(){if(!0==this.enableAutoLoop){if(null!=this.checkTimeout)clearTimeout(this.checkTimeout),this.checkTimeout=null;var a=function(a){return function(){a.loopCheck()}}(this);this.checkTimeout=setTimeout(a,5*this.loopInverval)}},loopFunc:function(){if(this.currentIndex==
this.scrollTimes+1){"horizon"==this.direction?this.displayBlock.style.left="0px":this.displayBlock.style.top="0px";this.currentIndex=1;var a=function(a){return function(){a.next()}}(this);setTimeout(a,this.loopInverval)}else this.next()},autoLoop:function(){var a=function(a){return function(){a.loopFunc()}}(this);setTimeout(a,this.loopInverval)},go:function(a,c){if(this.isInit&&!(1>a||a>this.scrollTimes+1)){var d="";this.currentIndex>a?d="prev":this.currentIndex<a&&(d="next");this.currentPos=(1-this.currentIndex)*
this._scrollLength;this.currentIndex=a;this.targetPos=(1-this.currentIndex)*this._scrollLength;!0==c?setTimeout(function(a,c){return function(){a.startMove(c,!0)}}(this,d),-1):setTimeout(function(a,c){return function(){a.startMove(c)}}(this,d),this.timeOut)}},prev:function(){if(this.isInit&&!(1>=this.currentIndex))this.currentPos=(1-this.currentIndex)*this._scrollLength,this.currentIndex--,this.targetPos=(1-this.currentIndex)*this._scrollLength,setTimeout(function(a,c){return function(){a.startMove(c)}}(this,
"prev"),this.timeOut)},next:function(){if(this.isInit&&!(this.currentIndex>this.scrollTimes))this.currentPos=(1-this.currentIndex)*this._scrollLength,this.currentIndex++,this.targetPos=(1-this.currentIndex)*this._scrollLength,setTimeout(function(a,c){return function(){a.startMove(c)}}(this,"next"),this.timeOut)},startMove:function(a,c){if("prev"==a){if(this.currentPos+=this.step,this.currentPos>this.targetPos)this.currentPos=this.targetPos}else if(this.currentPos-=this.step,this.currentPos<this.targetPos)this.currentPos=
this.targetPos;"horizon"==this.direction?this.displayBlock.style.left=this.currentPos+"px":this.displayBlock.style.top=this.currentPos+"px";this.currentPos==this.targetPos?!0==this.enableAutoLoop&&!1==this.stopLoopInverval&&this.autoLoop():!0==c?setTimeout(function(a,c){return function(){a.startMove(c)}}(this,a),-1):setTimeout(function(a,c){return function(){a.startMove(c)}}(this,a),this.timeOut)}});
Micsun.UI.Effect.OpacityBox=Micsun.Class({initialize:function(a,c,d,e,f,h,j){this.name=a;this.parent=M$(c);this.slideData=d;this.autoPlay=e;this.delay=f;this.currentSlide=0;this.count=d.length;if(null!=this.parent)this.parent.innerHTML="";for(i=0;i<this.count;i++){_title=d[i][0];_imageURL=d[i][1];_copy=d[i][2];_link=d[i][3];slide=document.createElement("DIV");slide.id=""+this.name+i;slide.className="highlights";if(0!=i)slide.style.display="none";linkOpen=_link?'<a href="'+_link+'">':"";linkClose=
_link?"</a>":"";moreLink=_link?" "+linkOpen+"&gt;more"+linkClose:"";_imageURL&&(slide.innerHTML+=linkOpen+'<img src="'+_imageURL+'" width="'+h+'px" height="'+j+'px" class="highlightImg">'+linkClose);_title&&(slide.innerHTML+="<h3>"+linkOpen+_title+linkClose+"</h3>");this.parent.appendChild(slide)}nav=document.createElement("div");nav.id=""+this.name+"Nav";nav.innerHTML+='<a id="'+this.name+'Back" class="back">&nbsp;&nbsp;&nbsp;&nbsp;</a>';nav.style.top=""+(j-24)+"px";nav.style.width=""+(h-20)+"px";
for(i=0;i<this.count;i++)nav.innerHTML+='<a id="'+this.name+"Nav"+i+'" class="number">'+(i+1)+"</a>";nav.innerHTML+='<a id="'+this.name+'Next" class="next" >&nbsp;&nbsp;&nbsp;&nbsp;</a>';nav.innerHTML+='<a id="'+this.name+'Play" class="play" >&nbsp;&nbsp;&nbsp;&nbsp;</a>';nav.innerHTML+='<a id="'+this.name+'Pause" class="pause" style="display:none;">&nbsp;&nbsp;&nbsp;&nbsp;</a>';this.parent.appendChild(nav);M$(this.name+"Back").onclick=function(a){return function(){a.back()}}(this);M$(this.name+"Next").onclick=
function(a){return function(){a.next()}}(this);M$(this.name+"Play").onclick=function(a){return function(){a.play()}}(this);M$(this.name+"Pause").onclick=function(a){return function(){a.pause()}}(this);for(i=0;i<this.count;i++)M$(this.name+"Nav"+i).onmouseover=function(a,c){return function(){a.show1(c)}}(this,i);Micsun.DOM.addClass(nav,"slideshowNav");Micsun.DOM.addClass(M$(this.name+"Nav0"),"on");Micsun.DOM.loaded?this.init():(a=function(a){return function(){a.init()}}(this),Micsun.DOM.addDOMReadyFunctions(a))},
init:function(){this.isInit||(this.autoPlay?this.play():this.show(Math.floor(Math.random()*this.count)))},show:function(a){if(a!=this.currentSlide){var c=""+this.name+this.currentSlide,d=""+this.name+a;new Micsun.UI.Effect.Opacity(c,100,20,400);c=function(a,c){return function(){M$(a).style.display="none";M$(c).style.display="block";new Micsun.UI.Effect.Opacity(c,20,100,400)}}(c,d);setTimeout(c,400);Micsun.DOM.removeClass(M$(this.name+"Nav"+this.currentSlide),"on");Micsun.DOM.addClass(M$(this.name+
"Nav"+a),"on");this.currentSlide=a}return!1},show1:function(a){this.show(a);this.pause();return!1},back:function(){var a=this.currentSlide-1;0>a&&(a=this.count-1);this.show(a);return!1},next:function(){var a=this.currentSlide+1;a>=this.count&&(a=0);this.show(a);return!1},play:function(){var a=function(a){return function(){a.next()}}(this);this.timer=setInterval(a,this.delay);M$(this.name+"Play").style.display="none";M$(this.name+"Pause").style.display="inline";return!1},pause:function(){clearInterval(this.timer);
M$(this.name+"Play").style.display="inline";M$(this.name+"Pause").style.display="none";return!1}});
Micsun.UI.Effect.AnimateManager=Micsun.Class({initialize:function(a){this.timestep=a||30;this.paused=!1;this.animObjects=[];this.index=0},play:function(){if(!this.paused){for(var a=0;a<this.animObjects.length;a++)this.animObjects[a].step();a=function(a){return function(){a.play()}}(this);setTimeout(a,this.timestep)}},kill:function(a){a<this.animObjects.length&&0<a&&this.animObjects.slice(0,a).concat(this.animObjects.slice(a+1,this.animObjects.length))},pause:function(){this.paused=!0},resume:function(){this.paused=
!1;this.step()},createAnimObject:function(a,c,d){c&&this.registerPosition(a,d);a=M$(a);c=this.index;this.animObjects[c]=new AnimateObject(a,c,this);this.index++;return this.animObjects[c]},registerPosition:function(a,c){var d=M$(a),e=d.offsetWidth,f=d.offsetHeight;d.style.position=c?"fixed":"absolute";d.style.top="0px";d.style.left="50%";d.halfWidth=Math.floor(e/2);d.halfHeight=Math.floor(f/2);d.style.marginLeft=-d.halfWidth+"px";d.style.marginTop=-d.halfHeight+"px";d.positionRegistered=!0;d.setPosition=
function(a,c){this.style.marginLeft=a-this.halfWidth+"px";this.style.marginTop=c-this.halfHeight+"px"}}});var AnimateManager=Micsun.UI.Effect.AnimateManager;
Micsun.UI.Effect.AnimateObject=Micsun.Class({initialize:function(a,c,d){this.id=c;this.obj=a;this.paused=!1;this.animEntries=[];this.animLoops=[];this.current=0;this.manager=d},step:function(){if(!this.paused)for(var a=0;a<this.animEntries.length;a++){var c=!0;if(this.animEntries[a])c=this.animEntries[a].step();else break;if(c)this.animLoops[a]--,this.animEntries[a].current=0,this.animEntries[a].onLoop();0==this.animLoops[a]&&(this.animEntries[a].onComplete(),delete this.animEntries[a]);if(this.paused)break}},
add:function(a){var c=a.loop?a.loop:1;this.animEntries[this.current]=new AnimateFrame(this.obj,a.property,a.from,a.to,a.duration,this.manager.timestep,a.effect?a.effect:AnimateEffect.linear,a.onLoop?a.onLoop:function(){},a.onComplete?a.onComplete:function(){});this.animLoops[this.current]=c;this.current++},kill:function(){this.manager.kill(this.id)},pause:function(){this.paused=!0},resume:function(){this.paused=!1}});var AnimateObject=Micsun.UI.Effect.AnimateObject;
Micsun.UI.Effect.AnimateFrame=Micsun.Class({initialize:function(a,c,d,e,f,h,j,k,l){this.obj=a;this.property=c;this.from=d;this.to=e;this.duration=f;this.timestep=h;this.effect=j;this.current=0;this.onLoop=k;this.onComplete=l},step:function(){if(!this.from)this.from=this.property.current(this.obj);if(this.current>=this.duration){var a=this.effect.transform(1);this.property.update(this.obj,this.from,this.to,a);return!0}a=this.effect.transform(this.current/this.duration);this.property.update(this.obj,
this.from,this.to,a);this.current+=this.timestep;return!1}});var AnimateFrame=Micsun.UI.Effect.AnimateFrame;
Micsun.UI.Effect.AnimateEffect={linear:{transform:function(a){return a}},parabolicPos:{transform:function(a){return a*a}},parabolicNeg:{transform:function(a){return 1-(a-1)*(a-1)}},backout:function(a){return{transform:function(c){return-1*c*(c+a-2)/(1-a)}}},backin:function(a){return{transform:function(c){return 1+(c+1-a)*(c+1-a+a-2)/(1-a)}}},bounceLinear:{transform:function(a){return 0.5>a?2*a:1-2*(a-0.5)}},bounceParabolic:{transform:function(a){return-4*a*(a-1)}},bounceSmooth:{transform:function(a){return 0.5-
0.5*Math.cos(2*Math.PI*a)}}};var AnimateEffect=Micsun.UI.Effect.AnimateEffect;
Micsun.UI.Effect.AnimateProperty={wait:{update:function(){},current:function(){return 0}},position:{update:function(a,c,d,e){var f=Micsun.interp(c.x,d.x,e),c=Micsun.interp(c.y,d.y,e);a.setPosition(f,c)},current:function(a){var c=parseInt(a.style.marginLeft),d=parseInt(a.style.marginTop);return new Micsun.DOM.Point(c+a.halfWidth,d+a.halfHeight)}},positionSemicircle:function(a){return{update:function(c,d,e,f){var h=(d.x+e.x)/2,e=(d.y+e.y)/2,j=e-d.y,k=d.x-h,d=Math.sqrt(j*j+k*k);0==k?j=0<j?-Math.PI/2:
Math.PI/2:(j=Math.atan(j/Math.abs(k)),j=0<k?j:Math.PI-j);f=j+(a?-f*Math.PI:f*Math.PI);h=Math.floor(h+d*Math.cos(f));e=Math.floor(e-d*Math.sin(f));c.setPosition(h,e)},current:function(a){var d=parseInt(a.style.marginLeft),e=parseInt(a.style.marginTop);return new Micsun.DOM.Point(d+a.halfWidth,e+a.halfHeight)}}},positionCircle:function(a){return{update:function(c,d,e,f){var h=(d.x+e.x)/2,e=(d.y+e.y)/2,j=e-d.y,k=d.x-h,d=Math.sqrt(j*j+k*k);0==k?j=0<j?-Math.PI/2:Math.PI/2:(j=Math.atan(j/Math.abs(k)),j=
0<k?j:Math.PI-j);f=j+(a?2*f*Math.PI:-2*f*Math.PI);h=Math.floor(h+d*Math.cos(f));e=Math.floor(e+d*Math.sin(f));c.setPosition(h,e)},current:function(a){var d=parseInt(a.style.marginLeft),e=parseInt(a.style.marginTop);return new Micsun.DOM.Point(d+a.halfWidth,e+a.halfHeight)}}},top:{update:function(a,c,d,e){a.style.top=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"top"))}},right:{update:function(a,c,d,e){a.style.right=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,
"right"))}},bottom:{update:function(a,c,d,e){a.style.bottom=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"bottom"))}},left:{update:function(a,c,d,e){a.style.left=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"left"))}},margin:{update:function(a,c,d,e){a.style.margin=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"margin"))}},marginTop:{update:function(a,c,d,e){a.style.marginTop=
Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"marginTop"))}},marginRight:{update:function(a,c,d,e){a.style.marginRight=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"marginRight"))}},marginBottom:{update:function(a,c,d,e){a.style.marginBottom=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"marginBottom"))}},marginLeft:{update:function(a,c,d,e){a.style.marginLeft=Micsun.interp(c,
d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"marginLeft"))}},padding:{update:function(a,c,d,e){a.style.padding=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"padding"))}},paddingTop:{update:function(a,c,d,e){a.style.paddingTop=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"paddingTop"))}},paddingRight:{update:function(a,c,d,e){a.style.paddingRight=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,
"paddingRight"))}},paddingBottom:{update:function(a,c,d,e){a.style.paddingBottom=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"paddingBottom"))}},paddingLeft:{update:function(a,c,d,e){a.style.paddingLeft=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"paddingLeft"))}},borderWidth:{update:function(a,c,d,e){a.style.borderWidth=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"borderWidth"))}},
borderTopWidth:{update:function(a,c,d,e){a.style.borderTopWidth=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"borderTopWidth"))}},borderRightWidth:{update:function(a,c,d,e){a.style.borderRightWidth=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"borderRightWidth"))}},borderBottomWidth:{update:function(a,c,d,e){a.style.borderBottomWidth=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,
"borderBottomWidth"))}},borderLeftWidth:{update:function(a,c,d,e){a.style.borderLeftWidth=Micsun.interp(c,d,e)+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"borderLeftWidth"))}},fontSize:{update:function(a,c,d,e){a.style.fontSize=Micsun.interp(c,d,e)+"pt"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"fontSize"))}},height:{update:function(a,c,d,e){c=Micsun.interp(c,d,e);a.style.height=c+"px";if(a.positionRegistered)c=parseInt(a.style.marginTop)+a.halfHeight,a.halfHeight=
Math.floor(a.offsetHeight/2),a.style.marginTop=c-a.halfHeight+"px"},current:function(a){var c=Micsun.DOM.getObjStyle(a,"height");return null==c?a.offsetHeight:parseInt(c)}},width:{update:function(a,c,d,e){c=Micsun.interp(c,d,e);a.style.width=c+"px";if(a.positionRegistered)c=parseInt(a.style.marginLeft)+a.halfWidth,a.halfWidth=Math.floor(a.offsetWidth/2),a.style.marginLeft=c-a.halfWidth+"px"},current:function(a){return parseInt(Micsun.DOM.getObjStyle(a,"width"))}},dimension:{update:function(a,c,d,
e){var f=Micsun.interp(c.h,d.h,e),c=Micsun.interp(c.w,d.w,e);a.style.height=f+"px";a.style.width=c+"px";if(a.positionRegistered)f=parseInt(a.style.marginTop)+a.halfHeight,a.halfHeight=Math.floor(a.offsetHeight/2),a.style.marginTop=f-a.halfHeight+"px",f=parseInt(a.style.marginLeft)+a.halfWidth,a.halfWidth=Math.floor(a.offsetWidth/2),a.style.marginLeft=f-a.halfWidth+"px"},current:function(a){var c=Micsun.DOM.getObjStyle(a,"height"),c=null==c?a.offsetHeight:parseInt(c),a=parseInt(Micsun.DOM.getObjStyle(a,
"width"));return new Micsun.DOM.Block(a,c)}},color:{update:function(a,c,d,e){r=Micsun.interp(c.r,d.r,e);g=Micsun.interp(c.g,d.g,e);b=Micsun.interp(c.b,d.b,e);a.style.color="rgb("+r+","+g+","+b+")"},current:function(a){a=Micsun.DOM.getObjStyle(a,"color");a=a.substring(4,a.length-1);a=Micsun.explode(",",a);return new Micsun.DOM.Color(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]))}},backgroundColor:{update:function(a,c,d,e){r=Micsun.interp(c.r,d.r,e);g=Micsun.interp(c.g,d.g,e);b=Micsun.interp(c.b,d.b,
e);a.style.backgroundColor="rgb("+r+","+g+","+b+")"},current:function(a){a=Micsun.DOM.getObjStyle(a,"backgroundColor");a=a.substring(4,a.length-1);a=Micsun.explode(",",a);return new Micsun.DOM.Color(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]))}},borderColor:{update:function(a,c,d,e){r=Micsun.interp(c.r,d.r,e);g=Micsun.interp(c.g,d.g,e);b=Micsun.interp(c.b,d.b,e);a.style.borderColor="rgb("+r+","+g+","+b+")"},current:function(a){a=Micsun.DOM.getObjStyle(a,"borderColor");a=a.substring(4,a.length-1);
a=Micsun.explode(",",a);return new Micsun.DOM.Color(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]))}},opacity:{update:function(a,c,d,e){v=Micsun.interp(100*c,100*d,e);Micsun.UTILS.changeObjOpac(a,v)},current:function(a){return Micsun.DOM.getObjStyle(a,"opacity")}}};var AnimateProperty=Micsun.UI.Effect.AnimateProperty;Micsun||alert("The following script will work with micsun.base.js!");Micsun.Codec={};Micsun.Codec.Base64={};
Micsun.extend(Micsun.Codec.Base64,{base64EncodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64DecodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,
-1,-1,-1,-1],utf16to8:function(a){var c,d,e,f;c="";a=a.replace(/\r\n/g,"\n");e=a.length;for(d=0;d<e;d++)f=a.charCodeAt(d),1<=f&&127>=f?c+=a.charAt(d):(2047<f?(c+=String.fromCharCode(224|f>>12&15),c+=String.fromCharCode(128|f>>6&63)):c+=String.fromCharCode(192|f>>6&31),c+=String.fromCharCode(128|f>>0&63));return c},utf8to16:function(a){var c,d,e,f,h,j;c="";e=a.length;for(d=0;d<e;)switch(f=a.charCodeAt(d++),f>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=a.charAt(d-1);break;case 12:case 13:h=
a.charCodeAt(d++);c+=String.fromCharCode((f&31)<<6|h&63);break;case 14:h=a.charCodeAt(d++),j=a.charCodeAt(d++),c+=String.fromCharCode((f&15)<<12|(h&63)<<6|(j&63)<<0)}return c},base64encode:function(a){var c,d,e,f,h,j,a=this.utf16to8(a);e=a.length;d=0;for(c="";d<e;){f=a.charCodeAt(d++)&255;if(d==e){c+=this.base64EncodeChars.charAt(f>>2);c+=this.base64EncodeChars.charAt((f&3)<<4);c+="==";break}h=a.charCodeAt(d++);if(d==e){c+=this.base64EncodeChars.charAt(f>>2);c+=this.base64EncodeChars.charAt((f&3)<<
4|(h&240)>>4);c+=this.base64EncodeChars.charAt((h&15)<<2);c+="=";break}j=a.charCodeAt(d++);c+=this.base64EncodeChars.charAt(f>>2);c+=this.base64EncodeChars.charAt((f&3)<<4|(h&240)>>4);c+=this.base64EncodeChars.charAt((h&15)<<2|(j&192)>>6);c+=this.base64EncodeChars.charAt(j&63)}return c},base64decode:function(a){var c,d,e,f,h,a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");f=a.length;e=0;for(h="";e<f;){do c=this.base64DecodeChars[a.charCodeAt(e++)&255];while(e<f&&-1==c);if(-1==c)break;do d=this.base64DecodeChars[a.charCodeAt(e++)&
255];while(e<f&&-1==d);if(-1==d)break;h+=String.fromCharCode(c<<2|(d&48)>>4);do{c=a.charCodeAt(e++)&255;if(61==c){c=-1;break}c=this.base64DecodeChars[c]}while(e<f&&-1==c);if(-1==c)break;h+=String.fromCharCode((d&15)<<4|(c&60)>>2);do{d=a.charCodeAt(e++)&255;if(61==d){d=-1;break}d=this.base64DecodeChars[d]}while(e<f&&-1==d);if(-1==d)break;h+=String.fromCharCode((c&3)<<6|d)}return h=this.utf8to16(h)}});Micsun||alert("The following script will work with micsun.base.js!");Micsun.Application={};_app_pop_win=new Micsun.UI.Windows("_micsun_system_win","micsun");portal_web_root="";function initWebRoot(a){portal_web_root=a};Micsun||alert("The following script will work with micsun.base.js!");Micsun.Logger={};
Micsun.extend(Micsun.Logger,{loggerWin:null,loggerUL:null,loggerDIV:null,isInit:!1,enable:function(a){a=function(a,d){return function(){return a.initWin(d)}}(this,a);Micsun.DOM.addDOMReadyFunctions(a)},initWin:function(a){this.loggerWin=new Micsun.UI.Windows("loggerWin","micsun");this.loggerWin.open("inline","<div style='width:100%;height:100%;overflow:scroll;overflow-y:yes' id='__loggerDIV'><ul  id='__loggerUL' style='margin:0px;padding:0px;'></ul></div>","\u8c03\u8bd5\u7a97\u53e3","width=480px,height=240px,resize=1,scrolling=1,min=1,move=1",
"recal");this.loggerUL=M$("__loggerUL");this.loggerDIV=M$("__loggerDIV");this.setPosition(a);this.isInit=!0},setPosition:function(a){switch(a){case 0:loggerWin.moveTo("left","top");break;case 1:loggerWin.moveTo("left","bottom");break;case 2:loggerWin.moveTo("right","top");break;case 3:loggerWin.moveTo("right","bottom");break;default:loggerWin.moveTo("right","bottom")}},log:function(a,c,d){if(this.isInit){"object"==Micsun.type(d)&&(d=Micsun.toJSON(d));var e=mydatetools.formatDate(new Date,"HH:mm:ss"),
f="";switch(a){case 0:f="<span style='color:#000000'>"+e+" [D]["+c+"]"+d+"</span>";break;case 1:f="<span style='color:#336600'>"+e+" [I]["+c+"]"+d+"</span>";break;case 2:f="<span style='color:#ff9900'>"+e+" [W]["+c+"]"+d+"</span>";break;case 3:f="<span style='color:#ff0000'>"+e+" [E]["+c+"]"+d+"</span>";break;case 4:f="<span style='color:#ff00ff'>"+e+" [F]["+c+"]"+d+"</span>";break;default:f="<span style='color:#000000'>"+e+" [D]["+c+"]"+d+"</span>"}try{var h=document.createElement("li");h.style.paddingLeft=
"0px";h.innerHTML=f;this.loggerUL.appendChild(h);this.loggerDIV.scrollTop=this.loggerDIV.scrollHeight}catch(j){}}},debug:function(a,c){this.log(0,a,c)},info:function(a,c){this.log(1,a,c)},warn:function(a,c){this.log(2,a,c)},error:function(a,c){this.log(3,a,c)},fatal:function(a,c){this.log(4,a,c)}});Micsun||alert("The following script will work with micsun.base.js!");Micsun.HtmlTemplate={};Micsun.HtmlTemplate.Event=Micsun.Class({initialize:function(a,c,d){this.type=a;this.item=c;this.element=d}});Micsun.HtmlTemplate.EventTypes={RENDER_STARTING:"render_starting",ITEM_RENDER_STARTING:"item_render_starting",ITEM_RENDER_COMPLETE:"item_render_complete",RENDER_COMPLETE:"render_complete",BEFORE_CLEAR:"before_clear",AFTER_CLEAR:"after_clear"};
Micsun.HtmlTemplate.Utils={memberRegex:function(a){var c="(",d;for(d in a)a.hasOwnProperty(d)&&(1<c.length&&(c+="|"),c+=d);return c+")[\\.]?(?!\\w)"},pad:function(a,c,d){for(;a.length<d;)a=c+a;return a},trim:function(a){return a.replace(/^\s*([\S\s]*?)\s*$/,"$1")},startsWith:function(a,c){return 0===a.indexOf(c)},getContainer:function(a,c){var d=null;"string"===Micsun.type(c)?d="*"===c?a.document.getElementsByTagName("html")[0]:a.document.getElementById(c):"jquery"===Micsun.type(c)&&0<c.length&&(d=
c[0]);return d},clearContainer:function(a){if(null!==a&&void 0!==a&&void 0!==a.childNodes)for(var c=a.childNodes.length-1;0<=c;c--)void 0!==a.childNodes[c]&&void 0!==a.childNodes[c].getAttribute&&(null!==a.childNodes[c].getAttribute("data-template")||null!==a.childNodes[c].getAttribute("data-template-for"))&&a.childNodes[c].parentNode.removeChild(a.childNodes[c])},isNested:function(a){for(a=a.parentNode;a;){if(Micsun.DOM.hasAttr(a,"data-template")||Micsun.DOM.hasAttr(a,"data-template-for"))return!0;
a=a.parentNode}return!1},equalsIgnoreCase:function(a,c){return a.toLowerCase()===c.toLowerCase()},merge:function(a,c){var d={},e;for(e in a)a.hasOwnProperty(e)&&(d[e]=a[e]);for(var f in c)c.hasOwnProperty(f)&&(d[f]=c[f]);return d},notify:function(a,c){if(void 0!==a&&0<a.length)for(var d=0;d<a.length;d++)c.type===a[d].type&&a[d].listener(c)},arrayContains:function(a,c){if(Array.prototype.indexOf)return-1<a.indexOf(c);for(var d=0;d<this.length;d++)if(this[d]===c)return!0;return!1}};
Micsun.HtmlTemplate.TempDefine=Micsun.Class({initialize:function(a,c,d){this._window=a;this.params=c;this.defaultTemplate=null;this.namedTemplates={};this.container=null;this.nestedItem=void 0!==d?d:null;this.escape=!0;this.var_brace_left="\\{\\{";this.var_brace_right="\\}\\}";this.tag_brace_left="\\{%";this.tag_brace_right="%\\}";this.dataIsMap=!1;this.attributes={};if("undefined"!==typeof c)for(var e in c)"var_braces"===e?(this.var_brace_left=c[e].substring(0,c[e].length/2),this.var_brace_right=
c[e].substring(c[e].length/2)):"tag_braces"===e?(this.tag_brace_left=c[e].substring(0,c[e].length/2),this.tag_brace_right=c[e].substring(c[e].length/2)):"undefined"!==typeof this[e]&&(this[e]=c[e])},load:function(a,c){function d(a){return a.contentWindow?a.contentWindow.document.documentElement.innerHTML:a.contentDocument?a.contentDocument.body.innerHTML:a.document.body.innerHTML}if(null!==this._window.document.getElementById(a))c(d(this._window.document.getElementById(a)));else{var e=this._window.document.createElement("iframe");
e.id=a;e.name=a;e.style.height=0;e.style.width=0;e.src=a;e.attachEvent?e.attachEvent("onload",function(){c(d(e))}):e.onload=function(){c(d(e))};this._window.document.body.appendChild(e)}},_insertTemplate:function(a,c,d,e){return function(f){Micsun.DOM.removeAttr(a,"data-template-file");a.innerHTML=f;c.parse(d,e)}},parse:function(a,c){this.container=a;for(var d=a.getElementsByTagName("*"),e=!0,f=0;f<d.length;f++)if(!0===e&&void 0!==c&&Micsun.DOM.hasAttr(d[f],"data-template-file")){var h=d[f];0<h.getAttribute("data-template-file").length&&
(e=!1,this.load(h.getAttribute("data-template-file"),this._insertTemplate(h,this,a,c)))}else if(Micsun.DOM.hasAttr(d[f],"data-template-fallback"))d[f].style.display="none";if(e){e={};for(f=0;f<d.length;f++)void 0!==d[f].getAttribute&&(Micsun.DOM.hasAttr(d[f],"data-template-for")&&0<d[f].getAttribute("data-template-for").length&&this.nestedItem===d[f].getAttribute("data-template-for")&&!e[this.nestedItem]?(this.createTemplate(d[f]),e[this.nestedItem]=!0):Micsun.DOM.hasAttr(d[f],"data-template")&&!Micsun.HtmlTemplate.Utils.isNested(d[f])&&
this.createTemplate(d[f]));Micsun.HtmlTemplate.Utils.clearContainer(this.container);void 0!==c&&c(this)}},getWindow:function(){return this._window},createTemplate:function(a){var c=a.cloneNode(!0);c.style.removeAttribute?c.style.removeAttribute("display"):c.style.removeProperty?c.style.removeProperty("display"):c.style.display="block";this.container=a.parentNode;for(var d=!1,a=0;a<c.attributes.length;a++){var e=c.attributes[a];if(Micsun.HtmlTemplate.Utils.startsWith(e.name,"data-if-"))d=""===e.value?
!0:"null"===e.value?null:"'"+e.value+"'",this.namedTemplates[e.name.substring(8,e.name.length)+"=="+d]=c,Micsun.DOM.removeAttr(c,e.name),d=!0;else if("data-has"===e.name)this.namedTemplates[e.value+"!==undefined"]=c,Micsun.DOM.removeAttr(c,e.name),d=!0;else if("data-from-map"===e.name)this.dataIsMap=!0;else if(!Micsun.HtmlTemplate.Utils.startsWith(e.name,"data-template")&&Micsun.HtmlTemplate.Utils.startsWith(e.name,"data-"))this.attributes[e.name.substring(5,e.name.length)]=e.value}if(!d)this.defaultTemplate=
c},templateFor:function(a){var c=Micsun.getParamNames(arguments.callee),d;for(d in this.namedTemplates)if(eval(c[0]+"."+d))return this.namedTemplates[d].cloneNode(!0);if(this.defaultTemplate)return this.defaultTemplate.cloneNode(!0)}});
Micsun.HtmlTemplate.Renderer=Micsun.Class({initialize:function(a){this.tempDefine=a;this.listener=[];this.started=!1;this.varRegex=RegExp(this.tempDefine.var_brace_left+"[ ]?([A-Za-z0-9$\\._\\[\\]]*?)([ ]?\\|[ ]?.*?)?[ ]?"+this.tempDefine.var_brace_right,"g");this.tagRegex=RegExp(this.tempDefine.tag_brace_left+"[ ]?([\\s\\S]*?)( [\\s\\S]*?)?[ ]?"+this.tempDefine.tag_brace_right+"(([\\s\\S]*?)(?="+this.tempDefine.tag_brace_left+"[ ]?end\\1[ ]?"+this.tempDefine.tag_brace_right+"))?","g");this.filterSplitter=
RegExp("\\|[ ]?(?="+Micsun.HtmlTemplate.Utils.memberRegex(this.filters)+")","g");this.errorHandler=null},when:function(a,c){this.listener.push({type:a,listener:c});return this},_getValue:function(a,c,d){var e=null,e=Micsun.getParamNames(arguments.callee);return Micsun.HtmlTemplate.Utils.startsWith(a,"_tempo.")?eval(e[2]+"."+a.substring(7,a.length)):e="."===a?eval(e[1]):"this"===a||null!==a.match(/this[\\[\\.]/)?eval(e[1]+a.substring(4,a.length)):"array"===Micsun.type(c)?eval(e[1]+a):eval(e[1]+"."+
a)},_replaceVariables:function(a,c,d){var e=this;return d.replace(this.varRegex,function(d,h,j){try{var k=e._getValue(h,c,a);if(void 0!==j&&""!==j)for(var l=Micsun.HtmlTemplate.Utils.trim(Micsun.HtmlTemplate.Utils.trim(j).substring(1)).split(e.filterSplitter),d=0;d<l.length;d++){var m=Micsun.HtmlTemplate.Utils.trim(l[d]),o,n=m.indexOf(" ");~n?(o=m.substr(n).replace(/(^ *['"])|(['"] *$)/g,"").split(/['"] *, *['"]/),m=m.substr(0,n)):o=[];k=e.filters[m](k,o)}if(void 0!==k)return e.tempDefine.escape&&
(k=e.filters.escape(k,{})),k}catch(p){e._onError.call(e,p)}return""})},_replaceObjects:function(a,c,d,e){var f=this;return d.replace(e,function(d,e){try{var k=f._getValue(e,c,a);if(void 0!==k)return"string"===Micsun.type(k)?"'"+k+"'":k}catch(l){self._onError.call(self,l)}})},_applyAttributeSetters:function(a,c){return c.replace(/(\b[A-z0-9]+?)(?:="[^"']*?"[^>]*?)data-\1="(.*?)"/g,function(a,c,f){return""!==f?c+'="'+f+'"':a})},_applyTags:function(a,c){var d=this;return c.replace(this.tagRegex,function(c,
f,h,j){return d.tags.hasOwnProperty(f)?(h=h.substring(h.indexOf(" ")).replace(/^[ ]*|[ ]*$/g,""),h=h.split(/(?:['"])[ ]?,[ ]?(?:['"])/),d.tags[f](d,a,c,h,j)):""})},starting:function(a){this.started=!0;void 0===a&&(a=new Micsun.HtmlTemplate.Event(Micsun.HtmlTemplate.EventTypes.RENDER_STARTING,void 0,void 0));Micsun.HtmlTemplate.Utils.notify(this.listener,a);return this},_renderNestedItem:function(a,c){var d=Micsun.getParamNames(arguments.callee),e=this;return function(f){var f=new Micsun.HtmlTemplate.Renderer(f),
h=null;if("*"===c||a.hasOwnProperty(c.split(".")[0]))if(h="*"===c?a:eval(d[0]+"."+c))try{if("array"===Micsun.type(h))for(var j=0;j<h.length;j++){if("object"===Micsun.type(h[j]))h[j]._parent=a}else h._parent=a}catch(k){e._onError.call(e,k)}f.render(h)}},renderItem:function(a,c,d,e){var f=RegExp("(?:__[\\.]?)((_tempo|\\[|"+Micsun.HtmlTemplate.Utils.memberRegex(d)+"|this)([A-Za-z0-9$\\._\\[\\]]+)?)","g"),h=a.tempDefine.templateFor(d),c=Micsun.HtmlTemplate.Utils.merge(c,a.tempDefine.attributes);Micsun.DOM.hasAttr(h,
"data-template-for")&&Micsun.DOM.removeAttr(h,"data-template-for");Micsun.DOM.hasAttr(h,"data-template-file")&&Micsun.DOM.removeAttr(h,"data-template-file");if(h&&d){Micsun.HtmlTemplate.Utils.notify(this.listener,new Micsun.HtmlTemplate.Event(Micsun.HtmlTemplate.EventTypes.ITEM_RENDER_STARTING,d,h));var j=h.innerHTML.match(/data-template-for="([^"]+?)"/g);if(j)for(var k=0;k<j.length;k++){var l=j[k].match(/data-template-for="([^"]+?)"/);if(l&&l[1]){var m=new Micsun.HtmlTemplate.TempDefine(this.tempDefine.getWindow(),
a.tempDefine.params,l[1]);try{m.parse(h,this._renderNestedItem(d,l[1]))}catch(o){this._onError.call(this,o)}}}for(a=0;a<h.attributes.length;a++)if(j=h.attributes[a],null!==j&&j.specified&&null!==j.value&&0<j.value.length&&null===j.name.match(/style|data-template.*/))j.value=this._applyTags(d,j.value),j.value=this._replaceVariables(c,d,j.value);a=h.innerHTML.replace(/%7B%7B/g,"{{").replace(/%7D%7D/g,"}}");a=this._applyTags(d,a);a=this._replaceVariables(c,d,a);a=this._replaceObjects(c,d,a,f);a=this._applyAttributeSetters(d,
a);e.appendChild(this.getElement(h,a));Micsun.HtmlTemplate.Utils.notify(this.listener,new Micsun.HtmlTemplate.Event(Micsun.HtmlTemplate.EventTypes.ITEM_RENDER_COMPLETE,d,h))}},getElement:function(a,c){if(-1<navigator.appVersion.indexOf("MSIE")&&Micsun.HtmlTemplate.Utils.equalsIgnoreCase(a.tagName,"tr")){var d=this.tempDefine.getWindow().document.createElement("div");d.innerHTML="<table><tbody>"+c+"</tbody></table>";for(var e=3;e--;)d=d.lastChild;d.setAttribute("data-template","");return d}a.innerHTML=
c;return a},_createFragment:function(a){if(a){var c={},d=this.tempDefine.getWindow().document.createDocumentFragment();if("object"===Micsun.type(a))if(this.tempDefine.dataIsMap){var e=[],f;for(f in a)if(a.hasOwnProperty(f)&&"_parent"!==f){var h={};h.key=f;h.value=a[f];e.push(h)}a=e}else a=[a];for(e=0;e<a.length;e++)c.index=e,c.first=1>e,c.last=e==a.length-1,this.renderItem(this,c,a[e],d);return d}return null},into:function(a){if(void 0!==a)this.tempDefine.container=Micsun.HtmlTemplate.Utils.getContainer(this.tempDefine.getWindow(),
a);return this},render:function(a){this.started||this.starting(new Micsun.HtmlTemplate.Event(Micsun.HtmlTemplate.EventTypes.RENDER_STARTING,a,this.tempDefine.container));this.clear();this.append(a);return this},append:function(a){this.started||this.starting(new Micsun.HtmlTemplate.Event(Micsun.HtmlTemplate.EventTypes.RENDER_STARTING,a,this.tempDefine.container));var c=this._createFragment(a);if(null!==c&&null!==this.tempDefine.container&&null!==c){for(var d=null,e=this.tempDefine.container.childNodes.length;0<=
e;e--)void 0!==this.tempDefine.container.childNodes[e]&&void 0!==this.tempDefine.container.childNodes[e].getAttribute&&null!==this.tempDefine.container.childNodes[e].getAttribute("data-after-template")&&(d=this.tempDefine.container.childNodes[e]);if(null===d)d=this.tempDefine.container.lastChild;null!==d?this.tempDefine.container.insertBefore(c,d):this.tempDefine.container.appendChild(c)}Micsun.HtmlTemplate.Utils.notify(this.listener,new Micsun.HtmlTemplate.Event(Micsun.HtmlTemplate.EventTypes.RENDER_COMPLETE,
a,this.tempDefine.container));return this},prepend:function(a){this.started||this.starting(new Micsun.HtmlTemplate.Event(Micsun.HtmlTemplate.EventTypes.RENDER_STARTING,a,this.tempDefine.container));var c=this._createFragment(a);if(null!==c){for(var d=null,e=0;e<this.tempDefine.container.childNodes.length;e++)void 0!==this.tempDefine.container.childNodes[e]&&void 0!==this.tempDefine.container.childNodes[e].getAttribute&&null!==this.tempDefine.container.childNodes[e].getAttribute("data-before-template")&&
(d=this.tempDefine.container.childNodes[e]);if(null===d)d=this.tempDefine.container.firstChild;if(null!==d){if(null!==d.nextSibling&&d.getAttribute&&null!==d.getAttribute("data-before-template"))d=d.nextSibling;this.tempDefine.container.insertBefore(c,d)}else this.tempDefine.container.appendChild(c)}Micsun.HtmlTemplate.Utils.notify(this.listener,new Micsun.HtmlTemplate.Event(Micsun.HtmlTemplate.EventTypes.RENDER_COMPLETE,a,this.tempDefine.container));return this},errors:function(a){this.errorHandler=
a;return this},_onError:function(a){null!==this.errorHandler&&this.errorHandler.call(this,a)},clear:function(){Micsun.HtmlTemplate.Utils.notify(this.listener,new Micsun.HtmlTemplate.Event(Micsun.HtmlTemplate.EventTypes.BEFORE_CLEAR,{},this.tempDefine.container));Micsun.HtmlTemplate.Utils.clearContainer(this.tempDefine.container);Micsun.HtmlTemplate.Utils.notify(this.listener,new Micsun.HtmlTemplate.Event(Micsun.HtmlTemplate.EventTypes.AFTER_CLEAR,{},this.tempDefine.container))},tags:{"if":function(a,
c,d,e,f){var h=Micsun.getParamNames(arguments.callee),j=Micsun.HtmlTemplate.Utils.memberRegex(c),k=e[0].replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<"),k=k.replace(RegExp(j,"gi"),function(a){return h[1]+"."+a}),j=f.split(RegExp(a.tempDefine.tag_brace_left+"[ ]?else[ ]?"+a.tempDefine.tag_brace_right,"g"));return eval(k)?j[0]:1<j.length?j[1]:""}},filters:{escape:function(a){return a.toString().replace(/[&<>]/g,function(a){return{"&":"&amp;","<":"&lt;",">":"&gt;"}[a]||a})},encodeURI:function(a){return encodeURI(a.toString())},
decodeURI:function(a){return decodeURI(a.toString())},truncate:function(a,c){if(void 0!==a){var d=0,e="...";0<c.length&&(d=parseInt(c[0],10));1<c.length&&(e=c[1]);return a.length>d-3?a.substr(0,d-3)+e:a}},format:function(a,c){if(void 0!==a){1===c.length&&(a=parseFloat(a+"").toFixed(parseInt(c[0],10)));for(var d=(a+"").split("."),e=d[0],d=1<d.length?"."+d[1]:"",f=/(\d+)(\d{3})/;f.test(e);)e=e.replace(f,"$1,$2");return e+d}},upper:function(a){return a.toUpperCase()},lower:function(a){return a.toLowerCase()},
titlecase:function(a,c){var d=[];void 0!==c&&1===c.length&&(d=c[0].split(" "));return a.replace(/\w[a-z]\S*/g,function(a,c){return 0===d.length||!(Micsun.HtmlTemplate.Utils.arrayContains(d,a)&&0<c)?a.charAt(0).toUpperCase()+a.substr(1).toLowerCase():a})},trim:function(a){return Micsun.HtmlTemplate.Utils.trim(a)},replace:function(a,c){return void 0!==a&&2===c.length?a.replace(RegExp(c[0],"g"),c[1]):a},append:function(a,c){return void 0!==a&&1===c.length?a+""+c[0]:a},prepend:function(a,c){return void 0!==
a&&1===c.length?c[0]+""+a:a},join:function(a,c){return 1===c.length&&void 0!==a&&"array"===Micsun.type(a)?a.join(c[0]):a},"default":function(a,c){return void 0!==a&&null!==a?a:1===c.length?c[0]:a},date:function(a,c){if(void 0!==a&&1<=c.length&&2>=c.length){var d=new Date(a),e=c[0],f=2===c.length&&"UTC"===c[1];if("localedate"===e)return d.toLocaleDateString();if("localetime"===e)return d.toLocaleTimeString();if("date"===e)return d.toDateString();if("time"===e)return d.toTimeString();var h="January,February,March,April,May,June,July,August,September,October,November,December".split(","),
j="Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),k={YYYY:function(a){return f?a.getUTCFullYear():a.getFullYear()},YY:function(a){return(f?a.getUTCFullYear():a.getFullYear()).toFixed().substring(2)},MMMM:function(a){return h[f?a.getUTCMonth():a.getMonth()]},MMM:function(a){return h[f?a.getUTCMonth():a.getMonth()].substring(0,3)},MM:function(a){return Micsun.HtmlTemplate.Utils.pad(((f?a.getUTCMonth():a.getMonth())+1).toFixed(),"0",2)},M:function(a){return(f?a.getUTCMonth():a.getMonth())+
1},DD:function(a){return Micsun.HtmlTemplate.Utils.pad((f?a.getUTCDate():a.getDate()).toFixed(),"0",2)},D:function(a){return f?a.getUTCDate():a.getDate()},EEEE:function(a){return j[f?a.getUTCDay():a.getDay()]},EEE:function(a){return j[f?a.getUTCDay():a.getDay()].substring(0,3)},E:function(a){return f?a.getUTCDay():a.getDay()},HH:function(a){return Micsun.HtmlTemplate.Utils.pad((f?a.getUTCHours():a.getHours()).toFixed(),"0",2)},H:function(a){return f?a.getUTCHours():a.getHours()},h:function(a){a=f?
a.getUTCHours():a.getHours();return 13>a?0===a?12:a:a-12},mm:function(a){return Micsun.HtmlTemplate.Utils.pad((f?a.getUTCMinutes():a.getMinutes()).toFixed(),"0",2)},m:function(a){return f?a.getUTCMinutes():a.getMinutes()},ss:function(a){return Micsun.HtmlTemplate.Utils.pad((f?a.getUTCSeconds():a.getSeconds()).toFixed(),"0",2)},s:function(a){return f?a.getUTCSeconds():a.getSeconds()},SSS:function(a){return Micsun.HtmlTemplate.Utils.pad((f?a.getUTCMilliseconds():a.getMilliseconds()).toFixed(),"0",3)},
S:function(a){return f?a.getUTCMilliseconds():a.getMilliseconds()},a:function(a){return 12>(f?a.getUTCHours():a.getHours())?"AM":"PM"}};return e=e.replace(/(\\)?(Y{2,4}|M{1,4}|D{1,2}|E{1,4}|H{1,2}|h|m{1,2}|s{1,2}|S{1,3}|a)/g,function(a,c,e){return!c&&k.hasOwnProperty(e)?k[e](d):e})}return""}}});
Micsun.HtmlTemplate.Engine=Micsun.Class({initialize:function(a){this._window=a||window},createRender:function(a,c){var d=Micsun.HtmlTemplate.Utils.getContainer(this._window,a),e=new Micsun.HtmlTemplate.TempDefine(this._window,c);e.parse(d);return new Micsun.HtmlTemplate.Renderer(e)},createAsynchRender:function(a,c,d){a=Micsun.HtmlTemplate.Utils.getContainer(this._window,a);(new Micsun.HtmlTemplate.TempDefine(this._window,c)).parse(a,function(a){d(new Micsun.HtmlTemplate.Renderer(a))})}});Micsun||alert("The following script will work with micsun.base.js!");if(!Micsun.Frame)Micsun.Frame={};Micsun.extend(Micsun.Frame,{returnData:"",getParam:function(a){a=window.location.search.substr(1).match(RegExp("(^|&)"+a+"=([^&]*)(&|$)"));return null!=a?unescape(a[2]):null},setReturnData:function(a){this.returnData=a},getReturnData:function(){return this.returnData}});
Micsun.Frame.AppBridge=Micsun.Class({initialize:function(a){this.bridgeSchema=a},execNativeByUrl:function(a,c,d,e,f,h){var j=document.createElement("iframe"),a=this.bridgeSchema+"://"+a+"/",a=a+this.buildDataParam(c,d,e,f,h);j.src=a;j.style.display="none";document.body.appendChild(j);j.parentNode.removeChild(j)},execNativeByContext:function(a,c,d,e,f,h){c=this.buildDataParam(c,d,e,f,h);eval("window."+this.bridgeSchema+"."+a+'("'+c+'")')},buildDataParam:function(a,c,d,e,f){dataParam=Micsun.toQueryString(e);
dataParam=Micsun.Codec.Base64.base64encode(dataParam);return c+"/"+d+"/"+dataParam+"/"+f+"?"+a},callFunction:function(a,c){var d={};"string"==Micsun.type(c)+""?(c=c.replace("%2B","+"),c=c.replace("%3D","="),c=Micsun.Codec.Base64.base64decode(c),d=Micsun.JSON.decode(c)):d=c;eval("(function(){ return function(data){"+a+"(data);}})()")(d)}});
var micsunBridge=new Micsun.Frame.AppBridge("appBridge"),commandConst={DOING:"doing",CLOSE:"close",PAUSE:"pause"},systemConst={EXIT:"exit",SELECT_PHOTO:"selectPhoto",TAKE_PHOTO:"takePhoto"};
Micsun.Frame.DataLayer=Micsun.Class({initialize:function(a){this.baseUrl=a||Micsun.Conf.defaultUrl},requestData:function(a,c,d,e){0<Micsun.Conf.deviceType?window.appBridge?micsunBridge.execNativeByContext("requestData",this.baseUrl,a+"MsgHdr",c,d,e):micsunBridge.execNativeByUrl("requestData",this.baseUrl,a+"MsgHdr",c,d,e):(e=eval(e),(new MsgHandler(this.baseUrl,a+"MsgHdr",c,d,null,e,!0)).sendMsg())},execCmd:function(a,c,d,e){0<Micsun.Conf.deviceType?window.appBridge?micsunBridge.execNativeByContext("command",
this.baseUrl,a,c,d,e):micsunBridge.execNativeByUrl("command",this.baseUrl,a,c,d,e):eval(a+"."+c+'("'+d+'","'+e+'")')},execSystem:function(a,c,d){this.execCmd("system",a,c,d)}});